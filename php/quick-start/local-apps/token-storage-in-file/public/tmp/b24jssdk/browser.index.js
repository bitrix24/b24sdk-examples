(function(exports){"use strict";var LoggerType=(_=>(_.desktop="desktop",_.log="log",_.info="info",_.warn="warn",_.error="error",_.trace="trace",_))(LoggerType||{});const o=new Map;o.set("title",["%c#title#","color: #959ca4; font-style: italic; padding: 0 6px; border-top: 1px solid #ccc; border-left: 1px solid #ccc; border-bottom: 1px solid #ccc"]),o.set("desktop",["%cDESKTOP","color: white; font-style: italic; background-color: #29619b; padding: 0 6px; border: 1px solid #29619b"]),o.set("log",["%cLOG","color: #2a323b; font-style: italic; background-color: #ccc; padding: 0 6px; border: 1px solid #ccc"]),o.set("info",["%cINFO","color: #fff; font-style: italic; background-color: #6b7f96; padding: 0 6px; border: 1px solid #6b7f96"]),o.set("warn",["%cWARNING","color: #f0a74f; font-style: italic; padding: 0 6px; border: 1px solid #f0a74f"]),o.set("error",["%cERROR","color: white; font-style: italic; background-color: #8a3232; padding: 0 6px; border: 1px solid #8a3232"]),o.set("trace",["%cTRACE","color: #2a323b; font-style: italic; background-color: #ccc; padding: 0 6px; border: 1px solid #ccc"]);class LoggerBrowser{#e;#t={desktop:!0,log:!1,info:!1,warn:!1,error:!0,trace:!0};static build(m,S=!1){const T=new LoggerBrowser(m);return S&&(T.enable("log"),T.enable("info"),T.enable("warn")),T}constructor(m){this.#e=m}#r(m){const S=[],T=[];if(o.has("title")){const v=o.get("title");v[0]&&(S.push(v[0].replace("#title#",this.#e)),T.push(v[1]||""))}if(o.has(m)){const v=o.get(m);v[0]&&(S.push(v[0]),T.push(v[1]||""))}return[S.join(""),...T]}setConfig(m){for(const S in m)this.#t[S]=m[S]}enable(m){return typeof this.#t[m]>"u"?!1:(this.#t[m]=!0,!0)}disable(m){return typeof this.#t[m]>"u"?!1:(this.#t[m]=!1,!0)}isEnabled(m){return this.#t[m]}desktop(...m){this.isEnabled("desktop")&&console.log(...this.#r("desktop"),...m)}log(...m){this.isEnabled("log")&&console.log(...this.#r("log"),...m)}info(...m){this.isEnabled("info")&&console.info(...this.#r("info"),...m)}warn(...m){this.isEnabled("warn")&&console.warn(...this.#r("warn"),...m)}error(...m){this.isEnabled("error")&&console.error(...this.#r("error"),...m)}trace(...m){this.isEnabled("trace")&&console.trace(...this.#r("trace"),...m)}}var DataType=(_=>(_.undefined="undefined",_.any="any",_.integer="integer",_.boolean="boolean",_.double="double",_.date="date",_.datetime="datetime",_.string="string",_.text="text",_.file="file",_.array="array",_.object="object",_.user="user",_.location="location",_.crmCategory="crm_category",_.crmStatus="crm_status",_.crmCurrency="crm_currency",_))(DataType||{});const r$2=Function.prototype.toString.call(Object);let s$2=class{getTag(m){return Object.prototype.toString.call(m)}isString(m){return m===""?!0:m?typeof m=="string"||m instanceof String:!1}isStringFilled(m){return this.isString(m)&&m!==""}isFunction(m){return m===null?!1:typeof m=="function"||m instanceof Function}isObject(m){return!!m&&(typeof m=="object"||typeof m=="function")}isObjectLike(m){return!!m&&typeof m=="object"}isPlainObject(m){if(!this.isObjectLike(m)||this.getTag(m)!=="[object Object]")return!1;const S=Object.getPrototypeOf(m);if(S===null)return!0;const T=S.hasOwnProperty("constructor")&&S.constructor;return typeof T=="function"&&Function.prototype.toString.call(T)===r$2}isJsonRpcRequest(m){return typeof m=="object"&&m&&"jsonrpc"in m&&this.isStringFilled(m.jsonrpc)&&"method"in m&&this.isStringFilled(m.method)}isJsonRpcResponse(m){return typeof m=="object"&&m&&"jsonrpc"in m&&this.isStringFilled(m.jsonrpc)&&"id"in m&&("result"in m||"error"in m)}isBoolean(m){return m===!0||m===!1}isNumber(m){return!Number.isNaN(m)&&typeof m=="number"}isInteger(m){return this.isNumber(m)&&m%1===0}isFloat(m){return this.isNumber(m)&&!this.isInteger(m)}isNil(m){return m==null}isArray(m){return!this.isNil(m)&&Array.isArray(m)}isArrayFilled(m){return this.isArray(m)&&m.length>0}isArrayLike(m){return!this.isNil(m)&&!this.isFunction(m)&&m.length>-1&&m.length<=Number.MAX_SAFE_INTEGER}isDate(m){return this.isObjectLike(m)&&this.getTag(m)==="[object Date]"}isDomNode(m){return this.isObjectLike(m)&&!this.isPlainObject(m)&&"nodeType"in m}isElementNode(m){return this.isDomNode(m)&&m.nodeType===Node.ELEMENT_NODE}isTextNode(m){return this.isDomNode(m)&&m.nodeType===Node.TEXT_NODE}isMap(m){return this.isObjectLike(m)&&this.getTag(m)==="[object Map]"}isSet(m){return this.isObjectLike(m)&&this.getTag(m)==="[object Set]"}isWeakMap(m){return this.isObjectLike(m)&&this.getTag(m)==="[object WeakMap]"}isWeakSet(m){return this.isObjectLike(m)&&this.getTag(m)==="[object WeakSet]"}isPrototype(m){return(typeof(m&&m.constructor)=="function"&&m.constructor.prototype||Object.prototype)===m}isRegExp(m){return this.isObjectLike(m)&&this.getTag(m)==="[object RegExp]"}isNull(m){return m===null}isUndefined(m){return typeof m>"u"}isArrayBuffer(m){return this.isObjectLike(m)&&this.getTag(m)==="[object ArrayBuffer]"}isTypedArray(m){const S=/^\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)]$/;return this.isObjectLike(m)&&S.test(this.getTag(m))}isBlob(m){return this.isObjectLike(m)&&this.isNumber(m.size)&&this.isString(m.type)&&this.isFunction(m.slice)}isFile(m){return this.isBlob(m)&&this.isString(m.name)&&(this.isNumber(m.lastModified)||this.isObjectLike(m.lastModifiedDate))}isFormData(m){return m instanceof FormData}clone(m,S=!0){let T,v,O;if(m===null)return null;if(this.isDomNode(m))T=m.cloneNode(S);else if(typeof m=="object")if(this.isArray(m))for(T=[],v=0,O=m.length;v<O;v++)typeof m[v]=="object"&&S?T[v]=this.clone(m[v],S):T[v]=m[v];else{T={},m.constructor&&(this.isDate(m)?T=new Date(m):T=new m.constructor);for(v in m)m.hasOwnProperty(v)&&(typeof m[v]=="object"&&S?T[v]=this.clone(m[v],S):T[v]=m[v])}else T=m;return T}};const c$1=new s$2;class LuxonError extends Error{}class InvalidDateTimeError extends LuxonError{constructor(m){super(`Invalid DateTime: ${m.toMessage()}`)}}class InvalidIntervalError extends LuxonError{constructor(m){super(`Invalid Interval: ${m.toMessage()}`)}}class InvalidDurationError extends LuxonError{constructor(m){super(`Invalid Duration: ${m.toMessage()}`)}}class ConflictingSpecificationError extends LuxonError{}class InvalidUnitError extends LuxonError{constructor(m){super(`Invalid unit ${m}`)}}class InvalidArgumentError extends LuxonError{}class ZoneIsAbstractError extends LuxonError{constructor(){super("Zone is an abstract class")}}const n$2="numeric",s$1="short",l$3="long",DATE_SHORT={year:n$2,month:n$2,day:n$2},DATE_MED={year:n$2,month:s$1,day:n$2},DATE_MED_WITH_WEEKDAY={year:n$2,month:s$1,day:n$2,weekday:s$1},DATE_FULL={year:n$2,month:l$3,day:n$2},DATE_HUGE={year:n$2,month:l$3,day:n$2,weekday:l$3},TIME_SIMPLE={hour:n$2,minute:n$2},TIME_WITH_SECONDS={hour:n$2,minute:n$2,second:n$2},TIME_WITH_SHORT_OFFSET={hour:n$2,minute:n$2,second:n$2,timeZoneName:s$1},TIME_WITH_LONG_OFFSET={hour:n$2,minute:n$2,second:n$2,timeZoneName:l$3},TIME_24_SIMPLE={hour:n$2,minute:n$2,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:n$2,minute:n$2,second:n$2,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:n$2,minute:n$2,second:n$2,hourCycle:"h23",timeZoneName:s$1},TIME_24_WITH_LONG_OFFSET={hour:n$2,minute:n$2,second:n$2,hourCycle:"h23",timeZoneName:l$3},DATETIME_SHORT={year:n$2,month:n$2,day:n$2,hour:n$2,minute:n$2},DATETIME_SHORT_WITH_SECONDS={year:n$2,month:n$2,day:n$2,hour:n$2,minute:n$2,second:n$2},DATETIME_MED={year:n$2,month:s$1,day:n$2,hour:n$2,minute:n$2},DATETIME_MED_WITH_SECONDS={year:n$2,month:s$1,day:n$2,hour:n$2,minute:n$2,second:n$2},DATETIME_MED_WITH_WEEKDAY={year:n$2,month:s$1,day:n$2,weekday:s$1,hour:n$2,minute:n$2},DATETIME_FULL={year:n$2,month:l$3,day:n$2,hour:n$2,minute:n$2,timeZoneName:s$1},DATETIME_FULL_WITH_SECONDS={year:n$2,month:l$3,day:n$2,hour:n$2,minute:n$2,second:n$2,timeZoneName:s$1},DATETIME_HUGE={year:n$2,month:l$3,day:n$2,weekday:l$3,hour:n$2,minute:n$2,timeZoneName:l$3},DATETIME_HUGE_WITH_SECONDS={year:n$2,month:l$3,day:n$2,weekday:l$3,hour:n$2,minute:n$2,second:n$2,timeZoneName:l$3};class Zone{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get ianaName(){return this.name}get isUniversal(){throw new ZoneIsAbstractError}offsetName(m,S){throw new ZoneIsAbstractError}formatOffset(m,S){throw new ZoneIsAbstractError}offset(m){throw new ZoneIsAbstractError}equals(m){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}}let singleton$1=null;class SystemZone extends Zone{static get instance(){return singleton$1===null&&(singleton$1=new SystemZone),singleton$1}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(m,{format:S,locale:T}){return parseZoneInfo(m,S,T)}formatOffset(m,S){return formatOffset(this.offset(m),S)}offset(m){return-new Date(m).getTimezoneOffset()}equals(m){return m.type==="system"}get isValid(){return!0}}let dtfCache={};function makeDTF(_){return dtfCache[_]||(dtfCache[_]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:_,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),dtfCache[_]}const typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function hackyOffset(_,m){const S=_.format(m).replace(/\u200E/g,""),T=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(S),[,v,O,A,C,k,$,M]=T;return[A,v,O,C,k,$,M]}function partsOffset(_,m){const S=_.formatToParts(m),T=[];for(let v=0;v<S.length;v++){const{type:O,value:A}=S[v],C=typeToPos[O];O==="era"?T[C]=A:isUndefined$1(C)||(T[C]=parseInt(A,10))}return T}let ianaZoneCache={};class IANAZone extends Zone{static create(m){return ianaZoneCache[m]||(ianaZoneCache[m]=new IANAZone(m)),ianaZoneCache[m]}static resetCache(){ianaZoneCache={},dtfCache={}}static isValidSpecifier(m){return this.isValidZone(m)}static isValidZone(m){if(!m)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:m}).format(),!0}catch{return!1}}constructor(m){super(),this.zoneName=m,this.valid=IANAZone.isValidZone(m)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(m,{format:S,locale:T}){return parseZoneInfo(m,S,T,this.name)}formatOffset(m,S){return formatOffset(this.offset(m),S)}offset(m){const S=new Date(m);if(isNaN(S))return NaN;const T=makeDTF(this.name);let[v,O,A,C,k,$,M]=T.formatToParts?partsOffset(T,S):hackyOffset(T,S);C==="BC"&&(v=-Math.abs(v)+1);const U=objToLocalTS({year:v,month:O,day:A,hour:k===24?0:k,minute:$,second:M,millisecond:0});let N=+S;const B=N%1e3;return N-=B>=0?B:1e3+B,(U-N)/(60*1e3)}equals(m){return m.type==="iana"&&m.name===this.name}get isValid(){return this.valid}}let intlLFCache={};function getCachedLF(_,m={}){const S=JSON.stringify([_,m]);let T=intlLFCache[S];return T||(T=new Intl.ListFormat(_,m),intlLFCache[S]=T),T}let intlDTCache={};function getCachedDTF(_,m={}){const S=JSON.stringify([_,m]);let T=intlDTCache[S];return T||(T=new Intl.DateTimeFormat(_,m),intlDTCache[S]=T),T}let intlNumCache={};function getCachedINF(_,m={}){const S=JSON.stringify([_,m]);let T=intlNumCache[S];return T||(T=new Intl.NumberFormat(_,m),intlNumCache[S]=T),T}let intlRelCache={};function getCachedRTF(_,m={}){const{base:S,...T}=m,v=JSON.stringify([_,T]);let O=intlRelCache[v];return O||(O=new Intl.RelativeTimeFormat(_,m),intlRelCache[v]=O),O}let sysLocaleCache=null;function systemLocale(){return sysLocaleCache||(sysLocaleCache=new Intl.DateTimeFormat().resolvedOptions().locale,sysLocaleCache)}let weekInfoCache={};function getCachedWeekInfo(_){let m=weekInfoCache[_];if(!m){const S=new Intl.Locale(_);m="getWeekInfo"in S?S.getWeekInfo():S.weekInfo,weekInfoCache[_]=m}return m}function parseLocaleString(_){const m=_.indexOf("-x-");m!==-1&&(_=_.substring(0,m));const S=_.indexOf("-u-");if(S===-1)return[_];{let T,v;try{T=getCachedDTF(_).resolvedOptions(),v=_}catch{const k=_.substring(0,S);T=getCachedDTF(k).resolvedOptions(),v=k}const{numberingSystem:O,calendar:A}=T;return[v,O,A]}}function intlConfigString(_,m,S){return(S||m)&&(_.includes("-u-")||(_+="-u"),S&&(_+=`-ca-${S}`),m&&(_+=`-nu-${m}`)),_}function mapMonths(_){const m=[];for(let S=1;S<=12;S++){const T=DateTime.utc(2009,S,1);m.push(_(T))}return m}function mapWeekdays(_){const m=[];for(let S=1;S<=7;S++){const T=DateTime.utc(2016,11,13+S);m.push(_(T))}return m}function listStuff(_,m,S,T){const v=_.listingMode();return v==="error"?null:v==="en"?S(m):T(m)}function supportsFastNumbers(_){return _.numberingSystem&&_.numberingSystem!=="latn"?!1:_.numberingSystem==="latn"||!_.locale||_.locale.startsWith("en")||new Intl.DateTimeFormat(_.intl).resolvedOptions().numberingSystem==="latn"}class PolyNumberFormatter{constructor(m,S,T){this.padTo=T.padTo||0,this.floor=T.floor||!1;const{padTo:v,floor:O,...A}=T;if(!S||Object.keys(A).length>0){const C={useGrouping:!1,...T};T.padTo>0&&(C.minimumIntegerDigits=T.padTo),this.inf=getCachedINF(m,C)}}format(m){if(this.inf){const S=this.floor?Math.floor(m):m;return this.inf.format(S)}else{const S=this.floor?Math.floor(m):roundTo(m,3);return padStart(S,this.padTo)}}}class PolyDateFormatter{constructor(m,S,T){this.opts=T,this.originalZone=void 0;let v;if(this.opts.timeZone)this.dt=m;else if(m.zone.type==="fixed"){const A=-1*(m.offset/60),C=A>=0?`Etc/GMT+${A}`:`Etc/GMT${A}`;m.offset!==0&&IANAZone.create(C).valid?(v=C,this.dt=m):(v="UTC",this.dt=m.offset===0?m:m.setZone("UTC").plus({minutes:m.offset}),this.originalZone=m.zone)}else m.zone.type==="system"?this.dt=m:m.zone.type==="iana"?(this.dt=m,v=m.zone.name):(v="UTC",this.dt=m.setZone("UTC").plus({minutes:m.offset}),this.originalZone=m.zone);const O={...this.opts};O.timeZone=O.timeZone||v,this.dtf=getCachedDTF(S,O)}format(){return this.originalZone?this.formatToParts().map(({value:m})=>m).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const m=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?m.map(S=>{if(S.type==="timeZoneName"){const T=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...S,value:T}}else return S}):m}resolvedOptions(){return this.dtf.resolvedOptions()}}class PolyRelFormatter{constructor(m,S,T){this.opts={style:"long",...T},!S&&hasRelative()&&(this.rtf=getCachedRTF(m,T))}format(m,S){return this.rtf?this.rtf.format(m,S):formatRelativeTime(S,m,this.opts.numeric,this.opts.style!=="long")}formatToParts(m,S){return this.rtf?this.rtf.formatToParts(m,S):[]}}const fallbackWeekSettings={firstDay:1,minimalDays:4,weekend:[6,7]};class Locale{static fromOpts(m){return Locale.create(m.locale,m.numberingSystem,m.outputCalendar,m.weekSettings,m.defaultToEN)}static create(m,S,T,v,O=!1){const A=m||Settings.defaultLocale,C=A||(O?"en-US":systemLocale()),k=S||Settings.defaultNumberingSystem,$=T||Settings.defaultOutputCalendar,M=validateWeekSettings(v)||Settings.defaultWeekSettings;return new Locale(C,k,$,M,A)}static resetCache(){sysLocaleCache=null,intlDTCache={},intlNumCache={},intlRelCache={}}static fromObject({locale:m,numberingSystem:S,outputCalendar:T,weekSettings:v}={}){return Locale.create(m,S,T,v)}constructor(m,S,T,v,O){const[A,C,k]=parseLocaleString(m);this.locale=A,this.numberingSystem=S||C||null,this.outputCalendar=T||k||null,this.weekSettings=v,this.intl=intlConfigString(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=O,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=supportsFastNumbers(this)),this.fastNumbersCached}listingMode(){const m=this.isEnglish(),S=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return m&&S?"en":"intl"}clone(m){return!m||Object.getOwnPropertyNames(m).length===0?this:Locale.create(m.locale||this.specifiedLocale,m.numberingSystem||this.numberingSystem,m.outputCalendar||this.outputCalendar,validateWeekSettings(m.weekSettings)||this.weekSettings,m.defaultToEN||!1)}redefaultToEN(m={}){return this.clone({...m,defaultToEN:!0})}redefaultToSystem(m={}){return this.clone({...m,defaultToEN:!1})}months(m,S=!1){return listStuff(this,m,months,()=>{const T=S?{month:m,day:"numeric"}:{month:m},v=S?"format":"standalone";return this.monthsCache[v][m]||(this.monthsCache[v][m]=mapMonths(O=>this.extract(O,T,"month"))),this.monthsCache[v][m]})}weekdays(m,S=!1){return listStuff(this,m,weekdays,()=>{const T=S?{weekday:m,year:"numeric",month:"long",day:"numeric"}:{weekday:m},v=S?"format":"standalone";return this.weekdaysCache[v][m]||(this.weekdaysCache[v][m]=mapWeekdays(O=>this.extract(O,T,"weekday"))),this.weekdaysCache[v][m]})}meridiems(){return listStuff(this,void 0,()=>meridiems,()=>{if(!this.meridiemCache){const m={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime.utc(2016,11,13,9),DateTime.utc(2016,11,13,19)].map(S=>this.extract(S,m,"dayperiod"))}return this.meridiemCache})}eras(m){return listStuff(this,m,eras,()=>{const S={era:m};return this.eraCache[m]||(this.eraCache[m]=[DateTime.utc(-40,1,1),DateTime.utc(2017,1,1)].map(T=>this.extract(T,S,"era"))),this.eraCache[m]})}extract(m,S,T){const v=this.dtFormatter(m,S),O=v.formatToParts(),A=O.find(C=>C.type.toLowerCase()===T);return A?A.value:null}numberFormatter(m={}){return new PolyNumberFormatter(this.intl,m.forceSimple||this.fastNumbers,m)}dtFormatter(m,S={}){return new PolyDateFormatter(m,this.intl,S)}relFormatter(m={}){return new PolyRelFormatter(this.intl,this.isEnglish(),m)}listFormatter(m={}){return getCachedLF(this.intl,m)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:hasLocaleWeekInfo()?getCachedWeekInfo(this.locale):fallbackWeekSettings}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(m){return this.locale===m.locale&&this.numberingSystem===m.numberingSystem&&this.outputCalendar===m.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let singleton=null;class FixedOffsetZone extends Zone{static get utcInstance(){return singleton===null&&(singleton=new FixedOffsetZone(0)),singleton}static instance(m){return m===0?FixedOffsetZone.utcInstance:new FixedOffsetZone(m)}static parseSpecifier(m){if(m){const S=m.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(S)return new FixedOffsetZone(signedOffset(S[1],S[2]))}return null}constructor(m){super(),this.fixed=m}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${formatOffset(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(m,S){return formatOffset(this.fixed,S)}get isUniversal(){return!0}offset(){return this.fixed}equals(m){return m.type==="fixed"&&m.fixed===this.fixed}get isValid(){return!0}}class InvalidZone extends Zone{constructor(m){super(),this.zoneName=m}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function normalizeZone(_,m){if(isUndefined$1(_)||_===null)return m;if(_ instanceof Zone)return _;if(isString$1(_)){const S=_.toLowerCase();return S==="default"?m:S==="local"||S==="system"?SystemZone.instance:S==="utc"||S==="gmt"?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(S)||IANAZone.create(_)}else return isNumber$1(_)?FixedOffsetZone.instance(_):typeof _=="object"&&"offset"in _&&typeof _.offset=="function"?_:new InvalidZone(_)}const numberingSystems={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");function parseDigits(_){let m=parseInt(_,10);if(isNaN(m)){m="";for(let S=0;S<_.length;S++){const T=_.charCodeAt(S);if(_[S].search(numberingSystems.hanidec)!==-1)m+=hanidecChars.indexOf(_[S]);else for(const v in numberingSystemsUTF16){const[O,A]=numberingSystemsUTF16[v];T>=O&&T<=A&&(m+=T-O)}}return parseInt(m,10)}else return m}let digitRegexCache={};function resetDigitRegexCache(){digitRegexCache={}}function digitRegex({numberingSystem:_},m=""){const S=_||"latn";return digitRegexCache[S]||(digitRegexCache[S]={}),digitRegexCache[S][m]||(digitRegexCache[S][m]=new RegExp(`${numberingSystems[S]}${m}`)),digitRegexCache[S][m]}let now=()=>Date.now(),defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,throwOnInvalid,defaultWeekSettings=null;class Settings{static get now(){return now}static set now(m){now=m}static set defaultZone(m){defaultZone=m}static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance)}static get defaultLocale(){return defaultLocale}static set defaultLocale(m){defaultLocale=m}static get defaultNumberingSystem(){return defaultNumberingSystem}static set defaultNumberingSystem(m){defaultNumberingSystem=m}static get defaultOutputCalendar(){return defaultOutputCalendar}static set defaultOutputCalendar(m){defaultOutputCalendar=m}static get defaultWeekSettings(){return defaultWeekSettings}static set defaultWeekSettings(m){defaultWeekSettings=validateWeekSettings(m)}static get twoDigitCutoffYear(){return twoDigitCutoffYear}static set twoDigitCutoffYear(m){twoDigitCutoffYear=m%100}static get throwOnInvalid(){return throwOnInvalid}static set throwOnInvalid(m){throwOnInvalid=m}static resetCaches(){Locale.resetCache(),IANAZone.resetCache(),DateTime.resetCache(),resetDigitRegexCache()}}class Invalid{constructor(m,S){this.reason=m,this.explanation=S}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(_,m){return new Invalid("unit out of range",`you specified ${m} (of type ${typeof m}) as a ${_}, which is invalid`)}function dayOfWeek(_,m,S){const T=new Date(Date.UTC(_,m-1,S));_<100&&_>=0&&T.setUTCFullYear(T.getUTCFullYear()-1900);const v=T.getUTCDay();return v===0?7:v}function computeOrdinal(_,m,S){return S+(isLeapYear(_)?leapLadder:nonLeapLadder)[m-1]}function uncomputeOrdinal(_,m){const S=isLeapYear(_)?leapLadder:nonLeapLadder,T=S.findIndex(O=>O<m),v=m-S[T];return{month:T+1,day:v}}function isoWeekdayToLocal(_,m){return(_-m+7)%7+1}function gregorianToWeek(_,m=4,S=1){const{year:T,month:v,day:O}=_,A=computeOrdinal(T,v,O),C=isoWeekdayToLocal(dayOfWeek(T,v,O),S);let k=Math.floor((A-C+14-m)/7),$;return k<1?($=T-1,k=weeksInWeekYear($,m,S)):k>weeksInWeekYear(T,m,S)?($=T+1,k=1):$=T,{weekYear:$,weekNumber:k,weekday:C,...timeObject(_)}}function weekToGregorian(_,m=4,S=1){const{weekYear:T,weekNumber:v,weekday:O}=_,A=isoWeekdayToLocal(dayOfWeek(T,1,m),S),C=daysInYear(T);let k=v*7+O-A-7+m,$;k<1?($=T-1,k+=daysInYear($)):k>C?($=T+1,k-=daysInYear(T)):$=T;const{month:M,day:P}=uncomputeOrdinal($,k);return{year:$,month:M,day:P,...timeObject(_)}}function gregorianToOrdinal(_){const{year:m,month:S,day:T}=_,v=computeOrdinal(m,S,T);return{year:m,ordinal:v,...timeObject(_)}}function ordinalToGregorian(_){const{year:m,ordinal:S}=_,{month:T,day:v}=uncomputeOrdinal(m,S);return{year:m,month:T,day:v,...timeObject(_)}}function usesLocalWeekValues(_,m){if(!isUndefined$1(_.localWeekday)||!isUndefined$1(_.localWeekNumber)||!isUndefined$1(_.localWeekYear)){if(!isUndefined$1(_.weekday)||!isUndefined$1(_.weekNumber)||!isUndefined$1(_.weekYear))throw new ConflictingSpecificationError("Cannot mix locale-based week fields with ISO-based week fields");return isUndefined$1(_.localWeekday)||(_.weekday=_.localWeekday),isUndefined$1(_.localWeekNumber)||(_.weekNumber=_.localWeekNumber),isUndefined$1(_.localWeekYear)||(_.weekYear=_.localWeekYear),delete _.localWeekday,delete _.localWeekNumber,delete _.localWeekYear,{minDaysInFirstWeek:m.getMinDaysInFirstWeek(),startOfWeek:m.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function hasInvalidWeekData(_,m=4,S=1){const T=isInteger(_.weekYear),v=integerBetween(_.weekNumber,1,weeksInWeekYear(_.weekYear,m,S)),O=integerBetween(_.weekday,1,7);return T?v?O?!1:unitOutOfRange("weekday",_.weekday):unitOutOfRange("week",_.weekNumber):unitOutOfRange("weekYear",_.weekYear)}function hasInvalidOrdinalData(_){const m=isInteger(_.year),S=integerBetween(_.ordinal,1,daysInYear(_.year));return m?S?!1:unitOutOfRange("ordinal",_.ordinal):unitOutOfRange("year",_.year)}function hasInvalidGregorianData(_){const m=isInteger(_.year),S=integerBetween(_.month,1,12),T=integerBetween(_.day,1,daysInMonth(_.year,_.month));return m?S?T?!1:unitOutOfRange("day",_.day):unitOutOfRange("month",_.month):unitOutOfRange("year",_.year)}function hasInvalidTimeData(_){const{hour:m,minute:S,second:T,millisecond:v}=_,O=integerBetween(m,0,23)||m===24&&S===0&&T===0&&v===0,A=integerBetween(S,0,59),C=integerBetween(T,0,59),k=integerBetween(v,0,999);return O?A?C?k?!1:unitOutOfRange("millisecond",v):unitOutOfRange("second",T):unitOutOfRange("minute",S):unitOutOfRange("hour",m)}function isUndefined$1(_){return typeof _>"u"}function isNumber$1(_){return typeof _=="number"}function isInteger(_){return typeof _=="number"&&_%1===0}function isString$1(_){return typeof _=="string"}function isDate$1(_){return Object.prototype.toString.call(_)==="[object Date]"}function hasRelative(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function hasLocaleWeekInfo(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function maybeArray(_){return Array.isArray(_)?_:[_]}function bestBy(_,m,S){if(_.length!==0)return _.reduce((T,v)=>{const O=[m(v),v];return T&&S(T[0],O[0])===T[0]?T:O},null)[1]}function pick(_,m){return m.reduce((S,T)=>(S[T]=_[T],S),{})}function hasOwnProperty$1(_,m){return Object.prototype.hasOwnProperty.call(_,m)}function validateWeekSettings(_){if(_==null)return null;if(typeof _!="object")throw new InvalidArgumentError("Week settings must be an object");if(!integerBetween(_.firstDay,1,7)||!integerBetween(_.minimalDays,1,7)||!Array.isArray(_.weekend)||_.weekend.some(m=>!integerBetween(m,1,7)))throw new InvalidArgumentError("Invalid week settings");return{firstDay:_.firstDay,minimalDays:_.minimalDays,weekend:Array.from(_.weekend)}}function integerBetween(_,m,S){return isInteger(_)&&_>=m&&_<=S}function floorMod(_,m){return _-m*Math.floor(_/m)}function padStart(_,m=2){const S=_<0;let T;return S?T="-"+(""+-_).padStart(m,"0"):T=(""+_).padStart(m,"0"),T}function parseInteger(_){if(!(isUndefined$1(_)||_===null||_===""))return parseInt(_,10)}function parseFloating(_){if(!(isUndefined$1(_)||_===null||_===""))return parseFloat(_)}function parseMillis(_){if(!(isUndefined$1(_)||_===null||_==="")){const m=parseFloat("0."+_)*1e3;return Math.floor(m)}}function roundTo(_,m,S=!1){const T=10**m;return(S?Math.trunc:Math.round)(_*T)/T}function isLeapYear(_){return _%4===0&&(_%100!==0||_%400===0)}function daysInYear(_){return isLeapYear(_)?366:365}function daysInMonth(_,m){const S=floorMod(m-1,12)+1,T=_+(m-S)/12;return S===2?isLeapYear(T)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][S-1]}function objToLocalTS(_){let m=Date.UTC(_.year,_.month-1,_.day,_.hour,_.minute,_.second,_.millisecond);return _.year<100&&_.year>=0&&(m=new Date(m),m.setUTCFullYear(_.year,_.month-1,_.day)),+m}function firstWeekOffset(_,m,S){return-isoWeekdayToLocal(dayOfWeek(_,1,m),S)+m-1}function weeksInWeekYear(_,m=4,S=1){const T=firstWeekOffset(_,m,S),v=firstWeekOffset(_+1,m,S);return(daysInYear(_)-T+v)/7}function untruncateYear(_){return _>99?_:_>Settings.twoDigitCutoffYear?1900+_:2e3+_}function parseZoneInfo(_,m,S,T=null){const v=new Date(_),O={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};T&&(O.timeZone=T);const A={timeZoneName:m,...O},C=new Intl.DateTimeFormat(S,A).formatToParts(v).find(k=>k.type.toLowerCase()==="timezonename");return C?C.value:null}function signedOffset(_,m){let S=parseInt(_,10);Number.isNaN(S)&&(S=0);const T=parseInt(m,10)||0,v=S<0||Object.is(S,-0)?-T:T;return S*60+v}function asNumber(_){const m=Number(_);if(typeof _=="boolean"||_===""||Number.isNaN(m))throw new InvalidArgumentError(`Invalid unit value ${_}`);return m}function normalizeObject(_,m){const S={};for(const T in _)if(hasOwnProperty$1(_,T)){const v=_[T];if(v==null)continue;S[m(T)]=asNumber(v)}return S}function formatOffset(_,m){const S=Math.trunc(Math.abs(_/60)),T=Math.trunc(Math.abs(_%60)),v=_>=0?"+":"-";switch(m){case"short":return`${v}${padStart(S,2)}:${padStart(T,2)}`;case"narrow":return`${v}${S}${T>0?`:${T}`:""}`;case"techie":return`${v}${padStart(S,2)}${padStart(T,2)}`;default:throw new RangeError(`Value format ${m} is out of range for property format`)}}function timeObject(_){return pick(_,["hour","minute","second","millisecond"])}const monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(_){switch(_){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(_){switch(_){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(_){switch(_){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null}}function meridiemForDateTime(_){return meridiems[_.hour<12?0:1]}function weekdayForDateTime(_,m){return weekdays(m)[_.weekday-1]}function monthForDateTime(_,m){return months(m)[_.month-1]}function eraForDateTime(_,m){return eras(m)[_.year<0?0:1]}function formatRelativeTime(_,m,S="always",T=!1){const v={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},O=["hours","minutes","seconds"].indexOf(_)===-1;if(S==="auto"&&O){const P=_==="days";switch(m){case 1:return P?"tomorrow":`next ${v[_][0]}`;case-1:return P?"yesterday":`last ${v[_][0]}`;case 0:return P?"today":`this ${v[_][0]}`}}const A=Object.is(m,-0)||m<0,C=Math.abs(m),k=C===1,$=v[_],M=T?k?$[1]:$[2]||$[1]:k?v[_][0]:_;return A?`${C} ${M} ago`:`in ${C} ${M}`}function stringifyTokens(_,m){let S="";for(const T of _)T.literal?S+=T.val:S+=m(T.val);return S}const macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS};class Formatter{static create(m,S={}){return new Formatter(m,S)}static parseFormat(m){let S=null,T="",v=!1;const O=[];for(let A=0;A<m.length;A++){const C=m.charAt(A);C==="'"?(T.length>0&&O.push({literal:v||/^\s+$/.test(T),val:T}),S=null,T="",v=!v):v||C===S?T+=C:(T.length>0&&O.push({literal:/^\s+$/.test(T),val:T}),T=C,S=C)}return T.length>0&&O.push({literal:v||/^\s+$/.test(T),val:T}),O}static macroTokenToFormatOpts(m){return macroTokenToFormatOpts[m]}constructor(m,S){this.opts=S,this.loc=m,this.systemLoc=null}formatWithSystemDefault(m,S){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(m,{...this.opts,...S}).format()}dtFormatter(m,S={}){return this.loc.dtFormatter(m,{...this.opts,...S})}formatDateTime(m,S){return this.dtFormatter(m,S).format()}formatDateTimeParts(m,S){return this.dtFormatter(m,S).formatToParts()}formatInterval(m,S){return this.dtFormatter(m.start,S).dtf.formatRange(m.start.toJSDate(),m.end.toJSDate())}resolvedOptions(m,S){return this.dtFormatter(m,S).resolvedOptions()}num(m,S=0){if(this.opts.forceSimple)return padStart(m,S);const T={...this.opts};return S>0&&(T.padTo=S),this.loc.numberFormatter(T).format(m)}formatDateTimeFromString(m,S){const T=this.loc.listingMode()==="en",v=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",O=(N,B)=>this.loc.extract(m,N,B),A=N=>m.isOffsetFixed&&m.offset===0&&N.allowZ?"Z":m.isValid?m.zone.formatOffset(m.ts,N.format):"",C=()=>T?meridiemForDateTime(m):O({hour:"numeric",hourCycle:"h12"},"dayperiod"),k=(N,B)=>T?monthForDateTime(m,N):O(B?{month:N}:{month:N,day:"numeric"},"month"),$=(N,B)=>T?weekdayForDateTime(m,N):O(B?{weekday:N}:{weekday:N,month:"long",day:"numeric"},"weekday"),M=N=>{const B=Formatter.macroTokenToFormatOpts(N);return B?this.formatWithSystemDefault(m,B):N},P=N=>T?eraForDateTime(m,N):O({era:N},"era"),U=N=>{switch(N){case"S":return this.num(m.millisecond);case"u":case"SSS":return this.num(m.millisecond,3);case"s":return this.num(m.second);case"ss":return this.num(m.second,2);case"uu":return this.num(Math.floor(m.millisecond/10),2);case"uuu":return this.num(Math.floor(m.millisecond/100));case"m":return this.num(m.minute);case"mm":return this.num(m.minute,2);case"h":return this.num(m.hour%12===0?12:m.hour%12);case"hh":return this.num(m.hour%12===0?12:m.hour%12,2);case"H":return this.num(m.hour);case"HH":return this.num(m.hour,2);case"Z":return A({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return A({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return A({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return m.zone.offsetName(m.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return m.zone.offsetName(m.ts,{format:"long",locale:this.loc.locale});case"z":return m.zoneName;case"a":return C();case"d":return v?O({day:"numeric"},"day"):this.num(m.day);case"dd":return v?O({day:"2-digit"},"day"):this.num(m.day,2);case"c":return this.num(m.weekday);case"ccc":return $("short",!0);case"cccc":return $("long",!0);case"ccccc":return $("narrow",!0);case"E":return this.num(m.weekday);case"EEE":return $("short",!1);case"EEEE":return $("long",!1);case"EEEEE":return $("narrow",!1);case"L":return v?O({month:"numeric",day:"numeric"},"month"):this.num(m.month);case"LL":return v?O({month:"2-digit",day:"numeric"},"month"):this.num(m.month,2);case"LLL":return k("short",!0);case"LLLL":return k("long",!0);case"LLLLL":return k("narrow",!0);case"M":return v?O({month:"numeric"},"month"):this.num(m.month);case"MM":return v?O({month:"2-digit"},"month"):this.num(m.month,2);case"MMM":return k("short",!1);case"MMMM":return k("long",!1);case"MMMMM":return k("narrow",!1);case"y":return v?O({year:"numeric"},"year"):this.num(m.year);case"yy":return v?O({year:"2-digit"},"year"):this.num(m.year.toString().slice(-2),2);case"yyyy":return v?O({year:"numeric"},"year"):this.num(m.year,4);case"yyyyyy":return v?O({year:"numeric"},"year"):this.num(m.year,6);case"G":return P("short");case"GG":return P("long");case"GGGGG":return P("narrow");case"kk":return this.num(m.weekYear.toString().slice(-2),2);case"kkkk":return this.num(m.weekYear,4);case"W":return this.num(m.weekNumber);case"WW":return this.num(m.weekNumber,2);case"n":return this.num(m.localWeekNumber);case"nn":return this.num(m.localWeekNumber,2);case"ii":return this.num(m.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(m.localWeekYear,4);case"o":return this.num(m.ordinal);case"ooo":return this.num(m.ordinal,3);case"q":return this.num(m.quarter);case"qq":return this.num(m.quarter,2);case"X":return this.num(Math.floor(m.ts/1e3));case"x":return this.num(m.ts);default:return M(N)}};return stringifyTokens(Formatter.parseFormat(S),U)}formatDurationFromString(m,S){const T=k=>{switch(k[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},v=k=>$=>{const M=T($);return M?this.num(k.get(M),$.length):$},O=Formatter.parseFormat(S),A=O.reduce((k,{literal:$,val:M})=>$?k:k.concat(M),[]),C=m.shiftTo(...A.map(T).filter(k=>k));return stringifyTokens(O,v(C))}}const ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(..._){const m=_.reduce((S,T)=>S+T.source,"");return RegExp(`^${m}$`)}function combineExtractors(..._){return m=>_.reduce(([S,T,v],O)=>{const[A,C,k]=O(m,v);return[{...S,...A},C||T,k]},[{},null,1]).slice(0,2)}function parse$1(_,...m){if(_==null)return[null,null];for(const[S,T]of m){const v=S.exec(_);if(v)return T(v)}return[null,null]}function simpleParse(..._){return(m,S)=>{const T={};let v;for(v=0;v<_.length;v++)T[_[v]]=parseInteger(m[S+v]);return[T,null,S+v]}}const offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,isoExtendedZone=`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`,isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${isoExtendedZone}`),isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`),isoYmdRegex=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoWeekRegex=/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoOrdinalRegex=/(\d{4})-?(\d{3})/,extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),sqlYmdRegex=/(\d{4})-(\d\d)-(\d\d)/,sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`),sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int(_,m,S){const T=_[m];return isUndefined$1(T)?S:parseInteger(T)}function extractISOYmd(_,m){return[{year:int(_,m),month:int(_,m+1,1),day:int(_,m+2,1)},null,m+3]}function extractISOTime(_,m){return[{hours:int(_,m,0),minutes:int(_,m+1,0),seconds:int(_,m+2,0),milliseconds:parseMillis(_[m+3])},null,m+4]}function extractISOOffset(_,m){const S=!_[m]&&!_[m+1],T=signedOffset(_[m+1],_[m+2]),v=S?null:FixedOffsetZone.instance(T);return[{},v,m+3]}function extractIANAZone(_,m){const S=_[m]?IANAZone.create(_[m]):null;return[{},S,m+1]}const isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(_){const[m,S,T,v,O,A,C,k,$]=_,M=m[0]==="-",P=k&&k[0]==="-",U=(N,B=!1)=>N!==void 0&&(B||N&&M)?-N:N;return[{years:U(parseFloating(S)),months:U(parseFloating(T)),weeks:U(parseFloating(v)),days:U(parseFloating(O)),hours:U(parseFloating(A)),minutes:U(parseFloating(C)),seconds:U(parseFloating(k),k==="-0"),milliseconds:U(parseMillis($),P)}]}const obsOffsets={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function fromStrings(_,m,S,T,v,O,A){const C={year:m.length===2?untruncateYear(parseInteger(m)):parseInteger(m),month:monthsShort.indexOf(S)+1,day:parseInteger(T),hour:parseInteger(v),minute:parseInteger(O)};return A&&(C.second=parseInteger(A)),_&&(C.weekday=_.length>3?weekdaysLong.indexOf(_)+1:weekdaysShort.indexOf(_)+1),C}const rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(_){const[,m,S,T,v,O,A,C,k,$,M,P]=_,U=fromStrings(m,v,T,S,O,A,C);let N;return k?N=obsOffsets[k]:$?N=0:N=signedOffset(M,P),[U,new FixedOffsetZone(N)]}function preprocessRFC2822(_){return _.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(_){const[,m,S,T,v,O,A,C]=_;return[fromStrings(m,v,T,S,O,A,C),FixedOffsetZone.utcInstance]}function extractASCII(_){const[,m,S,T,v,O,A,C]=_;return[fromStrings(m,C,S,T,v,O,A),FixedOffsetZone.utcInstance]}const isoYmdWithTimeExtensionRegex=combineRegexes(isoYmdRegex,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(isoWeekRegex,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(isoOrdinalRegex,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(extractISOYmd,extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseISODate(_){return parse$1(_,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset])}function parseRFC2822Date(_){return parse$1(preprocessRFC2822(_),[rfc2822,extractRFC2822])}function parseHTTPDate(_){return parse$1(_,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII])}function parseISODuration(_){return parse$1(_,[isoDuration,extractISODuration])}const extractISOTimeOnly=combineExtractors(extractISOTime);function parseISOTimeOnly(_){return parse$1(_,[isoTimeOnly,extractISOTimeOnly])}const sqlYmdWithTimeExtensionRegex=combineRegexes(sqlYmdRegex,sqlTimeExtensionRegex),sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);function parseSQL(_){return parse$1(_,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone])}const INVALID$2="Invalid Duration",lowOrderMatrix={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},casualMatrix={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...lowOrderMatrix},daysInYearAccurate=146097/400,daysInMonthAccurate=146097/4800,accurateMatrix={years:{quarters:4,months:12,weeks:daysInYearAccurate/7,days:daysInYearAccurate,hours:daysInYearAccurate*24,minutes:daysInYearAccurate*24*60,seconds:daysInYearAccurate*24*60*60,milliseconds:daysInYearAccurate*24*60*60*1e3},quarters:{months:3,weeks:daysInYearAccurate/28,days:daysInYearAccurate/4,hours:daysInYearAccurate*24/4,minutes:daysInYearAccurate*24*60/4,seconds:daysInYearAccurate*24*60*60/4,milliseconds:daysInYearAccurate*24*60*60*1e3/4},months:{weeks:daysInMonthAccurate/7,days:daysInMonthAccurate,hours:daysInMonthAccurate*24,minutes:daysInMonthAccurate*24*60,seconds:daysInMonthAccurate*24*60*60,milliseconds:daysInMonthAccurate*24*60*60*1e3},...lowOrderMatrix},orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$1(_,m,S=!1){const T={values:S?m.values:{..._.values,...m.values||{}},loc:_.loc.clone(m.loc),conversionAccuracy:m.conversionAccuracy||_.conversionAccuracy,matrix:m.matrix||_.matrix};return new Duration(T)}function durationToMillis(_,m){let S=m.milliseconds??0;for(const T of reverseUnits.slice(1))m[T]&&(S+=m[T]*_[T].milliseconds);return S}function normalizeValues(_,m){const S=durationToMillis(_,m)<0?-1:1;orderedUnits$1.reduceRight((T,v)=>{if(isUndefined$1(m[v]))return T;if(T){const O=m[T]*S,A=_[v][T],C=Math.floor(O/A);m[v]+=C*S,m[T]-=C*A*S}return v},null),orderedUnits$1.reduce((T,v)=>{if(isUndefined$1(m[v]))return T;if(T){const O=m[T]%1;m[T]-=O,m[v]+=O*_[T][v]}return v},null)}function removeZeroes(_){const m={};for(const[S,T]of Object.entries(_))T!==0&&(m[S]=T);return m}class Duration{constructor(m){const S=m.conversionAccuracy==="longterm"||!1;let T=S?accurateMatrix:casualMatrix;m.matrix&&(T=m.matrix),this.values=m.values,this.loc=m.loc||Locale.create(),this.conversionAccuracy=S?"longterm":"casual",this.invalid=m.invalid||null,this.matrix=T,this.isLuxonDuration=!0}static fromMillis(m,S){return Duration.fromObject({milliseconds:m},S)}static fromObject(m,S={}){if(m==null||typeof m!="object")throw new InvalidArgumentError(`Duration.fromObject: argument expected to be an object, got ${m===null?"null":typeof m}`);return new Duration({values:normalizeObject(m,Duration.normalizeUnit),loc:Locale.fromObject(S),conversionAccuracy:S.conversionAccuracy,matrix:S.matrix})}static fromDurationLike(m){if(isNumber$1(m))return Duration.fromMillis(m);if(Duration.isDuration(m))return m;if(typeof m=="object")return Duration.fromObject(m);throw new InvalidArgumentError(`Unknown duration argument ${m} of type ${typeof m}`)}static fromISO(m,S){const[T]=parseISODuration(m);return T?Duration.fromObject(T,S):Duration.invalid("unparsable",`the input "${m}" can't be parsed as ISO 8601`)}static fromISOTime(m,S){const[T]=parseISOTimeOnly(m);return T?Duration.fromObject(T,S):Duration.invalid("unparsable",`the input "${m}" can't be parsed as ISO 8601`)}static invalid(m,S=null){if(!m)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const T=m instanceof Invalid?m:new Invalid(m,S);if(Settings.throwOnInvalid)throw new InvalidDurationError(T);return new Duration({invalid:T})}static normalizeUnit(m){const S={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[m&&m.toLowerCase()];if(!S)throw new InvalidUnitError(m);return S}static isDuration(m){return m&&m.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(m,S={}){const T={...S,floor:S.round!==!1&&S.floor!==!1};return this.isValid?Formatter.create(this.loc,T).formatDurationFromString(this,m):INVALID$2}toHuman(m={}){if(!this.isValid)return INVALID$2;const S=orderedUnits$1.map(T=>{const v=this.values[T];return isUndefined$1(v)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...m,unit:T.slice(0,-1)}).format(v)}).filter(T=>T);return this.loc.listFormatter({type:"conjunction",style:m.listStyle||"narrow",...m}).format(S)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let m="P";return this.years!==0&&(m+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(m+=this.months+this.quarters*3+"M"),this.weeks!==0&&(m+=this.weeks+"W"),this.days!==0&&(m+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(m+="T"),this.hours!==0&&(m+=this.hours+"H"),this.minutes!==0&&(m+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(m+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),m==="P"&&(m+="T0S"),m}toISOTime(m={}){if(!this.isValid)return null;const S=this.toMillis();return S<0||S>=864e5?null:(m={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...m,includeOffset:!1},DateTime.fromMillis(S,{zone:"UTC"}).toISOTime(m))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?durationToMillis(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(m){if(!this.isValid)return this;const S=Duration.fromDurationLike(m),T={};for(const v of orderedUnits$1)(hasOwnProperty$1(S.values,v)||hasOwnProperty$1(this.values,v))&&(T[v]=S.get(v)+this.get(v));return clone$1(this,{values:T},!0)}minus(m){if(!this.isValid)return this;const S=Duration.fromDurationLike(m);return this.plus(S.negate())}mapUnits(m){if(!this.isValid)return this;const S={};for(const T of Object.keys(this.values))S[T]=asNumber(m(this.values[T],T));return clone$1(this,{values:S},!0)}get(m){return this[Duration.normalizeUnit(m)]}set(m){if(!this.isValid)return this;const S={...this.values,...normalizeObject(m,Duration.normalizeUnit)};return clone$1(this,{values:S})}reconfigure({locale:m,numberingSystem:S,conversionAccuracy:T,matrix:v}={}){const A={loc:this.loc.clone({locale:m,numberingSystem:S}),matrix:v,conversionAccuracy:T};return clone$1(this,A)}as(m){return this.isValid?this.shiftTo(m).get(m):NaN}normalize(){if(!this.isValid)return this;const m=this.toObject();return normalizeValues(this.matrix,m),clone$1(this,{values:m},!0)}rescale(){if(!this.isValid)return this;const m=removeZeroes(this.normalize().shiftToAll().toObject());return clone$1(this,{values:m},!0)}shiftTo(...m){if(!this.isValid)return this;if(m.length===0)return this;m=m.map(A=>Duration.normalizeUnit(A));const S={},T={},v=this.toObject();let O;for(const A of orderedUnits$1)if(m.indexOf(A)>=0){O=A;let C=0;for(const $ in T)C+=this.matrix[$][A]*T[$],T[$]=0;isNumber$1(v[A])&&(C+=v[A]);const k=Math.trunc(C);S[A]=k,T[A]=(C*1e3-k*1e3)/1e3}else isNumber$1(v[A])&&(T[A]=v[A]);for(const A in T)T[A]!==0&&(S[O]+=A===O?T[A]:T[A]/this.matrix[O][A]);return normalizeValues(this.matrix,S),clone$1(this,{values:S},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const m={};for(const S of Object.keys(this.values))m[S]=this.values[S]===0?0:-this.values[S];return clone$1(this,{values:m},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(m){if(!this.isValid||!m.isValid||!this.loc.equals(m.loc))return!1;function S(T,v){return T===void 0||T===0?v===void 0||v===0:T===v}for(const T of orderedUnits$1)if(!S(this.values[T],m.values[T]))return!1;return!0}}const INVALID$1="Invalid Interval";function validateStartEnd(_,m){return!_||!_.isValid?Interval.invalid("missing or invalid start"):!m||!m.isValid?Interval.invalid("missing or invalid end"):m<_?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${_.toISO()} and end=${m.toISO()}`):null}class Interval{constructor(m){this.s=m.start,this.e=m.end,this.invalid=m.invalid||null,this.isLuxonInterval=!0}static invalid(m,S=null){if(!m)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const T=m instanceof Invalid?m:new Invalid(m,S);if(Settings.throwOnInvalid)throw new InvalidIntervalError(T);return new Interval({invalid:T})}static fromDateTimes(m,S){const T=friendlyDateTime(m),v=friendlyDateTime(S),O=validateStartEnd(T,v);return O??new Interval({start:T,end:v})}static after(m,S){const T=Duration.fromDurationLike(S),v=friendlyDateTime(m);return Interval.fromDateTimes(v,v.plus(T))}static before(m,S){const T=Duration.fromDurationLike(S),v=friendlyDateTime(m);return Interval.fromDateTimes(v.minus(T),v)}static fromISO(m,S){const[T,v]=(m||"").split("/",2);if(T&&v){let O,A;try{O=DateTime.fromISO(T,S),A=O.isValid}catch{A=!1}let C,k;try{C=DateTime.fromISO(v,S),k=C.isValid}catch{k=!1}if(A&&k)return Interval.fromDateTimes(O,C);if(A){const $=Duration.fromISO(v,S);if($.isValid)return Interval.after(O,$)}else if(k){const $=Duration.fromISO(T,S);if($.isValid)return Interval.before(C,$)}}return Interval.invalid("unparsable",`the input "${m}" can't be parsed as ISO 8601`)}static isInterval(m){return m&&m.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(m="milliseconds"){return this.isValid?this.toDuration(m).get(m):NaN}count(m="milliseconds",S){if(!this.isValid)return NaN;const T=this.start.startOf(m,S);let v;return S?.useLocaleWeeks?v=this.end.reconfigure({locale:T.locale}):v=this.end,v=v.startOf(m,S),Math.floor(v.diff(T,m).get(m))+(v.valueOf()!==this.end.valueOf())}hasSame(m){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,m):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(m){return this.isValid?this.s>m:!1}isBefore(m){return this.isValid?this.e<=m:!1}contains(m){return this.isValid?this.s<=m&&this.e>m:!1}set({start:m,end:S}={}){return this.isValid?Interval.fromDateTimes(m||this.s,S||this.e):this}splitAt(...m){if(!this.isValid)return[];const S=m.map(friendlyDateTime).filter(A=>this.contains(A)).sort((A,C)=>A.toMillis()-C.toMillis()),T=[];let{s:v}=this,O=0;for(;v<this.e;){const A=S[O]||this.e,C=+A>+this.e?this.e:A;T.push(Interval.fromDateTimes(v,C)),v=C,O+=1}return T}splitBy(m){const S=Duration.fromDurationLike(m);if(!this.isValid||!S.isValid||S.as("milliseconds")===0)return[];let{s:T}=this,v=1,O;const A=[];for(;T<this.e;){const C=this.start.plus(S.mapUnits(k=>k*v));O=+C>+this.e?this.e:C,A.push(Interval.fromDateTimes(T,O)),T=O,v+=1}return A}divideEqually(m){return this.isValid?this.splitBy(this.length()/m).slice(0,m):[]}overlaps(m){return this.e>m.s&&this.s<m.e}abutsStart(m){return this.isValid?+this.e==+m.s:!1}abutsEnd(m){return this.isValid?+m.e==+this.s:!1}engulfs(m){return this.isValid?this.s<=m.s&&this.e>=m.e:!1}equals(m){return!this.isValid||!m.isValid?!1:this.s.equals(m.s)&&this.e.equals(m.e)}intersection(m){if(!this.isValid)return this;const S=this.s>m.s?this.s:m.s,T=this.e<m.e?this.e:m.e;return S>=T?null:Interval.fromDateTimes(S,T)}union(m){if(!this.isValid)return this;const S=this.s<m.s?this.s:m.s,T=this.e>m.e?this.e:m.e;return Interval.fromDateTimes(S,T)}static merge(m){const[S,T]=m.sort((v,O)=>v.s-O.s).reduce(([v,O],A)=>O?O.overlaps(A)||O.abutsStart(A)?[v,O.union(A)]:[v.concat([O]),A]:[v,A],[[],null]);return T&&S.push(T),S}static xor(m){let S=null,T=0;const v=[],O=m.map(k=>[{time:k.s,type:"s"},{time:k.e,type:"e"}]),A=Array.prototype.concat(...O),C=A.sort((k,$)=>k.time-$.time);for(const k of C)T+=k.type==="s"?1:-1,T===1?S=k.time:(S&&+S!=+k.time&&v.push(Interval.fromDateTimes(S,k.time)),S=null);return Interval.merge(v)}difference(...m){return Interval.xor([this].concat(m)).map(S=>this.intersection(S)).filter(S=>S&&!S.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:INVALID$1}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(m=DATE_SHORT,S={}){return this.isValid?Formatter.create(this.s.loc.clone(S),m).formatInterval(this):INVALID$1}toISO(m){return this.isValid?`${this.s.toISO(m)}/${this.e.toISO(m)}`:INVALID$1}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:INVALID$1}toISOTime(m){return this.isValid?`${this.s.toISOTime(m)}/${this.e.toISOTime(m)}`:INVALID$1}toFormat(m,{separator:S=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(m)}${S}${this.e.toFormat(m)}`:INVALID$1}toDuration(m,S){return this.isValid?this.e.diff(this.s,m,S):Duration.invalid(this.invalidReason)}mapEndpoints(m){return Interval.fromDateTimes(m(this.s),m(this.e))}}class Info{static hasDST(m=Settings.defaultZone){const S=DateTime.now().setZone(m).set({month:12});return!m.isUniversal&&S.offset!==S.set({month:6}).offset}static isValidIANAZone(m){return IANAZone.isValidZone(m)}static normalizeZone(m){return normalizeZone(m,Settings.defaultZone)}static getStartOfWeek({locale:m=null,locObj:S=null}={}){return(S||Locale.create(m)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:m=null,locObj:S=null}={}){return(S||Locale.create(m)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:m=null,locObj:S=null}={}){return(S||Locale.create(m)).getWeekendDays().slice()}static months(m="long",{locale:S=null,numberingSystem:T=null,locObj:v=null,outputCalendar:O="gregory"}={}){return(v||Locale.create(S,T,O)).months(m)}static monthsFormat(m="long",{locale:S=null,numberingSystem:T=null,locObj:v=null,outputCalendar:O="gregory"}={}){return(v||Locale.create(S,T,O)).months(m,!0)}static weekdays(m="long",{locale:S=null,numberingSystem:T=null,locObj:v=null}={}){return(v||Locale.create(S,T,null)).weekdays(m)}static weekdaysFormat(m="long",{locale:S=null,numberingSystem:T=null,locObj:v=null}={}){return(v||Locale.create(S,T,null)).weekdays(m,!0)}static meridiems({locale:m=null}={}){return Locale.create(m).meridiems()}static eras(m="short",{locale:S=null}={}){return Locale.create(S,null,"gregory").eras(m)}static features(){return{relative:hasRelative(),localeWeek:hasLocaleWeekInfo()}}}function dayDiff(_,m){const S=v=>v.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),T=S(m)-S(_);return Math.floor(Duration.fromMillis(T).as("days"))}function highOrderDiffs(_,m,S){const T=[["years",(k,$)=>$.year-k.year],["quarters",(k,$)=>$.quarter-k.quarter+($.year-k.year)*4],["months",(k,$)=>$.month-k.month+($.year-k.year)*12],["weeks",(k,$)=>{const M=dayDiff(k,$);return(M-M%7)/7}],["days",dayDiff]],v={},O=_;let A,C;for(const[k,$]of T)S.indexOf(k)>=0&&(A=k,v[k]=$(_,m),C=O.plus(v),C>m?(v[k]--,_=O.plus(v),_>m&&(C=_,v[k]--,_=O.plus(v))):_=C);return[_,v,C,A]}function diff(_,m,S,T){let[v,O,A,C]=highOrderDiffs(_,m,S);const k=m-v,$=S.filter(P=>["hours","minutes","seconds","milliseconds"].indexOf(P)>=0);$.length===0&&(A<m&&(A=v.plus({[C]:1})),A!==v&&(O[C]=(O[C]||0)+k/(A-v)));const M=Duration.fromObject(O,T);return $.length>0?Duration.fromMillis(k,T).shiftTo(...$).plus(M):M}const MISSING_FTP="missing Intl.DateTimeFormat.formatToParts support";function intUnit(_,m=S=>S){return{regex:_,deser:([S])=>m(parseDigits(S))}}const NBSP="\xA0",spaceOrNBSP=`[ ${NBSP}]`,spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(_){return _.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(_){return _.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(_,m){return _===null?null:{regex:RegExp(_.map(fixListRegex).join("|")),deser:([S])=>_.findIndex(T=>stripInsensitivities(S)===stripInsensitivities(T))+m}}function offset(_,m){return{regex:_,deser:([,S,T])=>signedOffset(S,T),groups:m}}function simple(_){return{regex:_,deser:([m])=>m}}function escapeToken(_){return _.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function unitForToken(_,m){const S=digitRegex(m),T=digitRegex(m,"{2}"),v=digitRegex(m,"{3}"),O=digitRegex(m,"{4}"),A=digitRegex(m,"{6}"),C=digitRegex(m,"{1,2}"),k=digitRegex(m,"{1,3}"),$=digitRegex(m,"{1,6}"),M=digitRegex(m,"{1,9}"),P=digitRegex(m,"{2,4}"),U=digitRegex(m,"{4,6}"),N=D=>({regex:RegExp(escapeToken(D.val)),deser:([q])=>q,literal:!0}),j=(D=>{if(_.literal)return N(D);switch(D.val){case"G":return oneOf(m.eras("short"),0);case"GG":return oneOf(m.eras("long"),0);case"y":return intUnit($);case"yy":return intUnit(P,untruncateYear);case"yyyy":return intUnit(O);case"yyyyy":return intUnit(U);case"yyyyyy":return intUnit(A);case"M":return intUnit(C);case"MM":return intUnit(T);case"MMM":return oneOf(m.months("short",!0),1);case"MMMM":return oneOf(m.months("long",!0),1);case"L":return intUnit(C);case"LL":return intUnit(T);case"LLL":return oneOf(m.months("short",!1),1);case"LLLL":return oneOf(m.months("long",!1),1);case"d":return intUnit(C);case"dd":return intUnit(T);case"o":return intUnit(k);case"ooo":return intUnit(v);case"HH":return intUnit(T);case"H":return intUnit(C);case"hh":return intUnit(T);case"h":return intUnit(C);case"mm":return intUnit(T);case"m":return intUnit(C);case"q":return intUnit(C);case"qq":return intUnit(T);case"s":return intUnit(C);case"ss":return intUnit(T);case"S":return intUnit(k);case"SSS":return intUnit(v);case"u":return simple(M);case"uu":return simple(C);case"uuu":return intUnit(S);case"a":return oneOf(m.meridiems(),0);case"kkkk":return intUnit(O);case"kk":return intUnit(P,untruncateYear);case"W":return intUnit(C);case"WW":return intUnit(T);case"E":case"c":return intUnit(S);case"EEE":return oneOf(m.weekdays("short",!1),1);case"EEEE":return oneOf(m.weekdays("long",!1),1);case"ccc":return oneOf(m.weekdays("short",!0),1);case"cccc":return oneOf(m.weekdays("long",!0),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${C.source})(?::(${T.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${C.source})(${T.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return N(D)}})(_)||{invalidReason:MISSING_FTP};return j.token=_,j}const partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function tokenForPart(_,m,S){const{type:T,value:v}=_;if(T==="literal"){const k=/^\s+$/.test(v);return{literal:!k,val:k?" ":v}}const O=m[T];let A=T;T==="hour"&&(m.hour12!=null?A=m.hour12?"hour12":"hour24":m.hourCycle!=null?m.hourCycle==="h11"||m.hourCycle==="h12"?A="hour12":A="hour24":A=S.hour12?"hour12":"hour24");let C=partTypeStyleToTokenVal[A];if(typeof C=="object"&&(C=C[O]),C)return{literal:!1,val:C}}function buildRegex(_){return[`^${_.map(S=>S.regex).reduce((S,T)=>`${S}(${T.source})`,"")}$`,_]}function match(_,m,S){const T=_.match(m);if(T){const v={};let O=1;for(const A in S)if(hasOwnProperty$1(S,A)){const C=S[A],k=C.groups?C.groups+1:1;!C.literal&&C.token&&(v[C.token.val[0]]=C.deser(T.slice(O,O+k))),O+=k}return[T,v]}else return[T,{}]}function dateTimeFromMatches(_){const m=O=>{switch(O){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let S=null,T;return isUndefined$1(_.z)||(S=IANAZone.create(_.z)),isUndefined$1(_.Z)||(S||(S=new FixedOffsetZone(_.Z)),T=_.Z),isUndefined$1(_.q)||(_.M=(_.q-1)*3+1),isUndefined$1(_.h)||(_.h<12&&_.a===1?_.h+=12:_.h===12&&_.a===0&&(_.h=0)),_.G===0&&_.y&&(_.y=-_.y),isUndefined$1(_.u)||(_.S=parseMillis(_.u)),[Object.keys(_).reduce((O,A)=>{const C=m(A);return C&&(O[C]=_[A]),O},{}),S,T]}let dummyDateTimeCache=null;function getDummyDateTime(){return dummyDateTimeCache||(dummyDateTimeCache=DateTime.fromMillis(1555555555555)),dummyDateTimeCache}function maybeExpandMacroToken(_,m){if(_.literal)return _;const S=Formatter.macroTokenToFormatOpts(_.val),T=formatOptsToTokens(S,m);return T==null||T.includes(void 0)?_:T}function expandMacroTokens(_,m){return Array.prototype.concat(..._.map(S=>maybeExpandMacroToken(S,m)))}class TokenParser{constructor(m,S){if(this.locale=m,this.format=S,this.tokens=expandMacroTokens(Formatter.parseFormat(S),m),this.units=this.tokens.map(T=>unitForToken(T,m)),this.disqualifyingUnit=this.units.find(T=>T.invalidReason),!this.disqualifyingUnit){const[T,v]=buildRegex(this.units);this.regex=RegExp(T,"i"),this.handlers=v}}explainFromTokens(m){if(this.isValid){const[S,T]=match(m,this.regex,this.handlers),[v,O,A]=T?dateTimeFromMatches(T):[null,null,void 0];if(hasOwnProperty$1(T,"a")&&hasOwnProperty$1(T,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:m,tokens:this.tokens,regex:this.regex,rawMatches:S,matches:T,result:v,zone:O,specificOffset:A}}else return{input:m,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function explainFromTokens(_,m,S){return new TokenParser(_,S).explainFromTokens(m)}function parseFromTokens(_,m,S){const{result:T,zone:v,specificOffset:O,invalidReason:A}=explainFromTokens(_,m,S);return[T,v,O,A]}function formatOptsToTokens(_,m){if(!_)return null;const T=Formatter.create(m,_).dtFormatter(getDummyDateTime()),v=T.formatToParts(),O=T.resolvedOptions();return v.map(A=>tokenForPart(A,_,O))}const INVALID="Invalid DateTime",MAX_DATE=864e13;function unsupportedZone(_){return new Invalid("unsupported zone",`the zone "${_.name}" is not supported`)}function possiblyCachedWeekData(_){return _.weekData===null&&(_.weekData=gregorianToWeek(_.c)),_.weekData}function possiblyCachedLocalWeekData(_){return _.localWeekData===null&&(_.localWeekData=gregorianToWeek(_.c,_.loc.getMinDaysInFirstWeek(),_.loc.getStartOfWeek())),_.localWeekData}function clone(_,m){const S={ts:_.ts,zone:_.zone,c:_.c,o:_.o,loc:_.loc,invalid:_.invalid};return new DateTime({...S,...m,old:S})}function fixOffset(_,m,S){let T=_-m*60*1e3;const v=S.offset(T);if(m===v)return[T,m];T-=(v-m)*60*1e3;const O=S.offset(T);return v===O?[T,v]:[_-Math.min(v,O)*60*1e3,Math.max(v,O)]}function tsToObj(_,m){_+=m*60*1e3;const S=new Date(_);return{year:S.getUTCFullYear(),month:S.getUTCMonth()+1,day:S.getUTCDate(),hour:S.getUTCHours(),minute:S.getUTCMinutes(),second:S.getUTCSeconds(),millisecond:S.getUTCMilliseconds()}}function objToTS(_,m,S){return fixOffset(objToLocalTS(_),m,S)}function adjustTime(_,m){const S=_.o,T=_.c.year+Math.trunc(m.years),v=_.c.month+Math.trunc(m.months)+Math.trunc(m.quarters)*3,O={..._.c,year:T,month:v,day:Math.min(_.c.day,daysInMonth(T,v))+Math.trunc(m.days)+Math.trunc(m.weeks)*7},A=Duration.fromObject({years:m.years-Math.trunc(m.years),quarters:m.quarters-Math.trunc(m.quarters),months:m.months-Math.trunc(m.months),weeks:m.weeks-Math.trunc(m.weeks),days:m.days-Math.trunc(m.days),hours:m.hours,minutes:m.minutes,seconds:m.seconds,milliseconds:m.milliseconds}).as("milliseconds"),C=objToLocalTS(O);let[k,$]=fixOffset(C,S,_.zone);return A!==0&&(k+=A,$=_.zone.offset(k)),{ts:k,o:$}}function parseDataToDateTime(_,m,S,T,v,O){const{setZone:A,zone:C}=S;if(_&&Object.keys(_).length!==0||m){const k=m||C,$=DateTime.fromObject(_,{...S,zone:k,specificOffset:O});return A?$:$.setZone(C)}else return DateTime.invalid(new Invalid("unparsable",`the input "${v}" can't be parsed as ${T}`))}function toTechFormat(_,m,S=!0){return _.isValid?Formatter.create(Locale.create("en-US"),{allowZ:S,forceSimple:!0}).formatDateTimeFromString(_,m):null}function toISODate(_,m){const S=_.c.year>9999||_.c.year<0;let T="";return S&&_.c.year>=0&&(T+="+"),T+=padStart(_.c.year,S?6:4),m?(T+="-",T+=padStart(_.c.month),T+="-",T+=padStart(_.c.day)):(T+=padStart(_.c.month),T+=padStart(_.c.day)),T}function toISOTime(_,m,S,T,v,O){let A=padStart(_.c.hour);return m?(A+=":",A+=padStart(_.c.minute),(_.c.millisecond!==0||_.c.second!==0||!S)&&(A+=":")):A+=padStart(_.c.minute),(_.c.millisecond!==0||_.c.second!==0||!S)&&(A+=padStart(_.c.second),(_.c.millisecond!==0||!T)&&(A+=".",A+=padStart(_.c.millisecond,3))),v&&(_.isOffsetFixed&&_.offset===0&&!O?A+="Z":_.o<0?(A+="-",A+=padStart(Math.trunc(-_.o/60)),A+=":",A+=padStart(Math.trunc(-_.o%60))):(A+="+",A+=padStart(Math.trunc(_.o/60)),A+=":",A+=padStart(Math.trunc(_.o%60)))),O&&(A+="["+_.zone.ianaName+"]"),A}const defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnit(_){const m={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[_.toLowerCase()];if(!m)throw new InvalidUnitError(_);return m}function normalizeUnitWithLocalWeeks(_){switch(_.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return normalizeUnit(_)}}function guessOffsetForZone(_){return zoneOffsetGuessCache[_]||(zoneOffsetTs===void 0&&(zoneOffsetTs=Settings.now()),zoneOffsetGuessCache[_]=_.offset(zoneOffsetTs)),zoneOffsetGuessCache[_]}function quickDT(_,m){const S=normalizeZone(m.zone,Settings.defaultZone);if(!S.isValid)return DateTime.invalid(unsupportedZone(S));const T=Locale.fromObject(m);let v,O;if(isUndefined$1(_.year))v=Settings.now();else{for(const k of orderedUnits)isUndefined$1(_[k])&&(_[k]=defaultUnitValues[k]);const A=hasInvalidGregorianData(_)||hasInvalidTimeData(_);if(A)return DateTime.invalid(A);const C=guessOffsetForZone(S);[v,O]=objToTS(_,C,S)}return new DateTime({ts:v,zone:S,loc:T,o:O})}function diffRelative(_,m,S){const T=isUndefined$1(S.round)?!0:S.round,v=(A,C)=>(A=roundTo(A,T||S.calendary?0:2,!0),m.loc.clone(S).relFormatter(S).format(A,C)),O=A=>S.calendary?m.hasSame(_,A)?0:m.startOf(A).diff(_.startOf(A),A).get(A):m.diff(_,A).get(A);if(S.unit)return v(O(S.unit),S.unit);for(const A of S.units){const C=O(A);if(Math.abs(C)>=1)return v(C,A)}return v(_>m?-0:0,S.units[S.units.length-1])}function lastOpts(_){let m={},S;return _.length>0&&typeof _[_.length-1]=="object"?(m=_[_.length-1],S=Array.from(_).slice(0,_.length-1)):S=Array.from(_),[m,S]}let zoneOffsetTs,zoneOffsetGuessCache={};class DateTime{constructor(m){const S=m.zone||Settings.defaultZone;let T=m.invalid||(Number.isNaN(m.ts)?new Invalid("invalid input"):null)||(S.isValid?null:unsupportedZone(S));this.ts=isUndefined$1(m.ts)?Settings.now():m.ts;let v=null,O=null;if(!T)if(m.old&&m.old.ts===this.ts&&m.old.zone.equals(S))[v,O]=[m.old.c,m.old.o];else{const C=isNumber$1(m.o)&&!m.old?m.o:S.offset(this.ts);v=tsToObj(this.ts,C),T=Number.isNaN(v.year)?new Invalid("invalid input"):null,v=T?null:v,O=T?null:C}this._zone=S,this.loc=m.loc||Locale.create(),this.invalid=T,this.weekData=null,this.localWeekData=null,this.c=v,this.o=O,this.isLuxonDateTime=!0}static now(){return new DateTime({})}static local(){const[m,S]=lastOpts(arguments),[T,v,O,A,C,k,$]=S;return quickDT({year:T,month:v,day:O,hour:A,minute:C,second:k,millisecond:$},m)}static utc(){const[m,S]=lastOpts(arguments),[T,v,O,A,C,k,$]=S;return m.zone=FixedOffsetZone.utcInstance,quickDT({year:T,month:v,day:O,hour:A,minute:C,second:k,millisecond:$},m)}static fromJSDate(m,S={}){const T=isDate$1(m)?m.valueOf():NaN;if(Number.isNaN(T))return DateTime.invalid("invalid input");const v=normalizeZone(S.zone,Settings.defaultZone);return v.isValid?new DateTime({ts:T,zone:v,loc:Locale.fromObject(S)}):DateTime.invalid(unsupportedZone(v))}static fromMillis(m,S={}){if(isNumber$1(m))return m<-MAX_DATE||m>MAX_DATE?DateTime.invalid("Timestamp out of range"):new DateTime({ts:m,zone:normalizeZone(S.zone,Settings.defaultZone),loc:Locale.fromObject(S)});throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof m} with value ${m}`)}static fromSeconds(m,S={}){if(isNumber$1(m))return new DateTime({ts:m*1e3,zone:normalizeZone(S.zone,Settings.defaultZone),loc:Locale.fromObject(S)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(m,S={}){m=m||{};const T=normalizeZone(S.zone,Settings.defaultZone);if(!T.isValid)return DateTime.invalid(unsupportedZone(T));const v=Locale.fromObject(S),O=normalizeObject(m,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:A,startOfWeek:C}=usesLocalWeekValues(O,v),k=Settings.now(),$=isUndefined$1(S.specificOffset)?T.offset(k):S.specificOffset,M=!isUndefined$1(O.ordinal),P=!isUndefined$1(O.year),U=!isUndefined$1(O.month)||!isUndefined$1(O.day),N=P||U,B=O.weekYear||O.weekNumber;if((N||M)&&B)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(U&&M)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const j=B||O.weekday&&!N;let D,q,W=tsToObj(k,$);j?(D=orderedWeekUnits,q=defaultWeekUnitValues,W=gregorianToWeek(W,A,C)):M?(D=orderedOrdinalUnits,q=defaultOrdinalUnitValues,W=gregorianToOrdinal(W)):(D=orderedUnits,q=defaultUnitValues);let Y=!1;for(const te of D){const ce=O[te];isUndefined$1(ce)?Y?O[te]=q[te]:O[te]=W[te]:Y=!0}const Q=j?hasInvalidWeekData(O,A,C):M?hasInvalidOrdinalData(O):hasInvalidGregorianData(O),K=Q||hasInvalidTimeData(O);if(K)return DateTime.invalid(K);const X=j?weekToGregorian(O,A,C):M?ordinalToGregorian(O):O,[ie,ne]=objToTS(X,$,T),oe=new DateTime({ts:ie,zone:T,o:ne,loc:v});return O.weekday&&N&&m.weekday!==oe.weekday?DateTime.invalid("mismatched weekday",`you can't specify both a weekday of ${O.weekday} and a date of ${oe.toISO()}`):oe.isValid?oe:DateTime.invalid(oe.invalid)}static fromISO(m,S={}){const[T,v]=parseISODate(m);return parseDataToDateTime(T,v,S,"ISO 8601",m)}static fromRFC2822(m,S={}){const[T,v]=parseRFC2822Date(m);return parseDataToDateTime(T,v,S,"RFC 2822",m)}static fromHTTP(m,S={}){const[T,v]=parseHTTPDate(m);return parseDataToDateTime(T,v,S,"HTTP",S)}static fromFormat(m,S,T={}){if(isUndefined$1(m)||isUndefined$1(S))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:v=null,numberingSystem:O=null}=T,A=Locale.fromOpts({locale:v,numberingSystem:O,defaultToEN:!0}),[C,k,$,M]=parseFromTokens(A,m,S);return M?DateTime.invalid(M):parseDataToDateTime(C,k,T,`format ${S}`,m,$)}static fromString(m,S,T={}){return DateTime.fromFormat(m,S,T)}static fromSQL(m,S={}){const[T,v]=parseSQL(m);return parseDataToDateTime(T,v,S,"SQL",m)}static invalid(m,S=null){if(!m)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const T=m instanceof Invalid?m:new Invalid(m,S);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(T);return new DateTime({invalid:T})}static isDateTime(m){return m&&m.isLuxonDateTime||!1}static parseFormatForOpts(m,S={}){const T=formatOptsToTokens(m,Locale.fromObject(S));return T?T.map(v=>v?v.val:null).join(""):null}static expandFormat(m,S={}){return expandMacroTokens(Formatter.parseFormat(m),Locale.fromObject(S)).map(v=>v.val).join("")}static resetCache(){zoneOffsetTs=void 0,zoneOffsetGuessCache={}}get(m){return this[m]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?possiblyCachedLocalWeekData(this).weekday:NaN}get localWeekNumber(){return this.isValid?possiblyCachedLocalWeekData(this).weekNumber:NaN}get localWeekYear(){return this.isValid?possiblyCachedLocalWeekData(this).weekYear:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const m=864e5,S=6e4,T=objToLocalTS(this.c),v=this.zone.offset(T-m),O=this.zone.offset(T+m),A=this.zone.offset(T-v*S),C=this.zone.offset(T-O*S);if(A===C)return[this];const k=T-A*S,$=T-C*S,M=tsToObj(k,A),P=tsToObj($,C);return M.hour===P.hour&&M.minute===P.minute&&M.second===P.second&&M.millisecond===P.millisecond?[clone(this,{ts:k}),clone(this,{ts:$})]:[this]}get isInLeapYear(){return isLeapYear(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?weeksInWeekYear(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(m={}){const{locale:S,numberingSystem:T,calendar:v}=Formatter.create(this.loc.clone(m),m).resolvedOptions(this);return{locale:S,numberingSystem:T,outputCalendar:v}}toUTC(m=0,S={}){return this.setZone(FixedOffsetZone.instance(m),S)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(m,{keepLocalTime:S=!1,keepCalendarTime:T=!1}={}){if(m=normalizeZone(m,Settings.defaultZone),m.equals(this.zone))return this;if(m.isValid){let v=this.ts;if(S||T){const O=m.offset(this.ts),A=this.toObject();[v]=objToTS(A,O,m)}return clone(this,{ts:v,zone:m})}else return DateTime.invalid(unsupportedZone(m))}reconfigure({locale:m,numberingSystem:S,outputCalendar:T}={}){const v=this.loc.clone({locale:m,numberingSystem:S,outputCalendar:T});return clone(this,{loc:v})}setLocale(m){return this.reconfigure({locale:m})}set(m){if(!this.isValid)return this;const S=normalizeObject(m,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:T,startOfWeek:v}=usesLocalWeekValues(S,this.loc),O=!isUndefined$1(S.weekYear)||!isUndefined$1(S.weekNumber)||!isUndefined$1(S.weekday),A=!isUndefined$1(S.ordinal),C=!isUndefined$1(S.year),k=!isUndefined$1(S.month)||!isUndefined$1(S.day),$=C||k,M=S.weekYear||S.weekNumber;if(($||A)&&M)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(k&&A)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let P;O?P=weekToGregorian({...gregorianToWeek(this.c,T,v),...S},T,v):isUndefined$1(S.ordinal)?(P={...this.toObject(),...S},isUndefined$1(S.day)&&(P.day=Math.min(daysInMonth(P.year,P.month),P.day))):P=ordinalToGregorian({...gregorianToOrdinal(this.c),...S});const[U,N]=objToTS(P,this.o,this.zone);return clone(this,{ts:U,o:N})}plus(m){if(!this.isValid)return this;const S=Duration.fromDurationLike(m);return clone(this,adjustTime(this,S))}minus(m){if(!this.isValid)return this;const S=Duration.fromDurationLike(m).negate();return clone(this,adjustTime(this,S))}startOf(m,{useLocaleWeeks:S=!1}={}){if(!this.isValid)return this;const T={},v=Duration.normalizeUnit(m);switch(v){case"years":T.month=1;case"quarters":case"months":T.day=1;case"weeks":case"days":T.hour=0;case"hours":T.minute=0;case"minutes":T.second=0;case"seconds":T.millisecond=0;break}if(v==="weeks")if(S){const O=this.loc.getStartOfWeek(),{weekday:A}=this;A<O&&(T.weekNumber=this.weekNumber-1),T.weekday=O}else T.weekday=1;if(v==="quarters"){const O=Math.ceil(this.month/3);T.month=(O-1)*3+1}return this.set(T)}endOf(m,S){return this.isValid?this.plus({[m]:1}).startOf(m,S).minus(1):this}toFormat(m,S={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(S)).formatDateTimeFromString(this,m):INVALID}toLocaleString(m=DATE_SHORT,S={}){return this.isValid?Formatter.create(this.loc.clone(S),m).formatDateTime(this):INVALID}toLocaleParts(m={}){return this.isValid?Formatter.create(this.loc.clone(m),m).formatDateTimeParts(this):[]}toISO({format:m="extended",suppressSeconds:S=!1,suppressMilliseconds:T=!1,includeOffset:v=!0,extendedZone:O=!1}={}){if(!this.isValid)return null;const A=m==="extended";let C=toISODate(this,A);return C+="T",C+=toISOTime(this,A,S,T,v,O),C}toISODate({format:m="extended"}={}){return this.isValid?toISODate(this,m==="extended"):null}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:m=!1,suppressSeconds:S=!1,includeOffset:T=!0,includePrefix:v=!1,extendedZone:O=!1,format:A="extended"}={}){return this.isValid?(v?"T":"")+toISOTime(this,A==="extended",S,m,T,O):null}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?toISODate(this,!0):null}toSQLTime({includeOffset:m=!0,includeZone:S=!1,includeOffsetSpace:T=!0}={}){let v="HH:mm:ss.SSS";return(S||m)&&(T&&(v+=" "),S?v+="z":m&&(v+="ZZ")),toTechFormat(this,v,!0)}toSQL(m={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(m)}`:null}toString(){return this.isValid?this.toISO():INVALID}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(m={}){if(!this.isValid)return{};const S={...this.c};return m.includeConfig&&(S.outputCalendar=this.outputCalendar,S.numberingSystem=this.loc.numberingSystem,S.locale=this.loc.locale),S}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(m,S="milliseconds",T={}){if(!this.isValid||!m.isValid)return Duration.invalid("created by diffing an invalid DateTime");const v={locale:this.locale,numberingSystem:this.numberingSystem,...T},O=maybeArray(S).map(Duration.normalizeUnit),A=m.valueOf()>this.valueOf(),C=A?this:m,k=A?m:this,$=diff(C,k,O,v);return A?$.negate():$}diffNow(m="milliseconds",S={}){return this.diff(DateTime.now(),m,S)}until(m){return this.isValid?Interval.fromDateTimes(this,m):this}hasSame(m,S,T){if(!this.isValid)return!1;const v=m.valueOf(),O=this.setZone(m.zone,{keepLocalTime:!0});return O.startOf(S,T)<=v&&v<=O.endOf(S,T)}equals(m){return this.isValid&&m.isValid&&this.valueOf()===m.valueOf()&&this.zone.equals(m.zone)&&this.loc.equals(m.loc)}toRelative(m={}){if(!this.isValid)return null;const S=m.base||DateTime.fromObject({},{zone:this.zone}),T=m.padding?this<S?-m.padding:m.padding:0;let v=["years","months","days","hours","minutes","seconds"],O=m.unit;return Array.isArray(m.unit)&&(v=m.unit,O=void 0),diffRelative(S,this.plus(T),{...m,numeric:"always",units:v,unit:O})}toRelativeCalendar(m={}){return this.isValid?diffRelative(m.base||DateTime.fromObject({},{zone:this.zone}),this,{...m,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...m){if(!m.every(DateTime.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(m,S=>S.valueOf(),Math.min)}static max(...m){if(!m.every(DateTime.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(m,S=>S.valueOf(),Math.max)}static fromFormatExplain(m,S,T={}){const{locale:v=null,numberingSystem:O=null}=T,A=Locale.fromOpts({locale:v,numberingSystem:O,defaultToEN:!0});return explainFromTokens(A,m,S)}static fromStringExplain(m,S,T={}){return DateTime.fromFormatExplain(m,S,T)}static buildFormatParser(m,S={}){const{locale:T=null,numberingSystem:v=null}=S,O=Locale.fromOpts({locale:T,numberingSystem:v,defaultToEN:!0});return new TokenParser(O,m)}static fromFormatParser(m,S,T={}){if(isUndefined$1(m)||isUndefined$1(S))throw new InvalidArgumentError("fromFormatParser requires an input string and a format parser");const{locale:v=null,numberingSystem:O=null}=T,A=Locale.fromOpts({locale:v,numberingSystem:O,defaultToEN:!0});if(!A.equals(S.locale))throw new InvalidArgumentError(`fromFormatParser called with a locale of ${A}, but the format parser was created for ${S.locale}`);const{result:C,zone:k,specificOffset:$,invalidReason:M}=S.explainFromTokens(m);return M?DateTime.invalid(M):parseDataToDateTime(C,k,T,`format ${S.format}`,m,$)}static get DATE_SHORT(){return DATE_SHORT}static get DATE_MED(){return DATE_MED}static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY}static get DATE_FULL(){return DATE_FULL}static get DATE_HUGE(){return DATE_HUGE}static get TIME_SIMPLE(){return TIME_SIMPLE}static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS}static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET}static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET}static get TIME_24_SIMPLE(){return TIME_24_SIMPLE}static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS}static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET}static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET}static get DATETIME_SHORT(){return DATETIME_SHORT}static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS}static get DATETIME_MED(){return DATETIME_MED}static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS}static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY}static get DATETIME_FULL(){return DATETIME_FULL}static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS}static get DATETIME_HUGE(){return DATETIME_HUGE}static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS}}function friendlyDateTime(_){if(DateTime.isDateTime(_))return _;if(_&&_.valueOf&&isNumber$1(_.valueOf()))return DateTime.fromJSDate(_);if(_&&typeof _=="object")return DateTime.fromObject(_);throw new InvalidArgumentError(`Unknown datetime argument: ${_}, of type ${typeof _}`)}const c={};let p$1;const l$2=new Uint8Array(16),t$2=[];for(let _=0;_<256;++_)t$2.push((_+256).toString(16).slice(1));function u$2(_,m,S){return _.msecs??=-1/0,_.seq??=0,m>_.msecs?(_.seq=S[6]<<23|S[7]<<16|S[8]<<8|S[9],_.msecs=m):(_.seq=_.seq+1|0,_.seq===0&&_.msecs++),_}function g(_,m,S,T,v=0){return T||(T=new Uint8Array(16),v=0),m??=Date.now(),S??=_[6]*127<<24|_[7]<<16|_[8]<<8|_[9],T[v++]=m/1099511627776&255,T[v++]=m/4294967296&255,T[v++]=m/16777216&255,T[v++]=m/65536&255,T[v++]=m/256&255,T[v++]=m&255,T[v++]=112|S>>>28&15,T[v++]=S>>>20&255,T[v++]=128|S>>>14&63,T[v++]=S>>>6&255,T[v++]=S<<2&255|_[10]&3,T[v++]=_[11],T[v++]=_[12],T[v++]=_[13],T[v++]=_[14],T[v++]=_[15],T}function V$1(_,m=0){return(t$2[_[m]]+t$2[_[m+1]]+t$2[_[m+2]]+t$2[_[m+3]]+"-"+t$2[_[m+4]]+t$2[_[m+5]]+"-"+t$2[_[m+6]]+t$2[_[m+7]]+"-"+t$2[_[m+8]]+t$2[_[m+9]]+"-"+t$2[_[m+10]]+t$2[_[m+11]]+t$2[_[m+12]]+t$2[_[m+13]]+t$2[_[m+14]]+t$2[_[m+15]]).toLowerCase()}function x(){let _;const m=Date.now();if(!p$1){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported.");p$1=crypto.getRandomValues.bind(crypto)}const S=p$1(l$2);return u$2(c,m,S),_=g(S,c.msecs,c.seq,void 0,void 0),V$1(_)}const l$1=/[&<>'"]/g,p=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34)/g,d$1={"&":"&amp","<":"&lt",">":"&gt","'":"&#39",'"':"&quot"},f$1={"&amp":"&","&#38":"&","&lt":"<","&#60":"<","&gt":">","&#62":">","&apos":"'","&#39":"'","&quot":'"',"&#34":'"'};class b{getRandom(m=8){return[...Array(m)].map(()=>(~~(Math.random()*36)).toString(36)).join("")}getUniqId(){return"xxxxxxxx-xlsx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,m=>{const S=Math.random()*16|0;return(m==="x"?S:S&3|8).toString(16)})}getUuidRfc4122(){return x()}encode(m){return c$1.isString(m)?m.replace(l$1,S=>d$1[S]):m}decode(m){return c$1.isString(m)?m.replace(p,S=>f$1[S]):m}toNumber(m){const S=Number.parseFloat(m);return c$1.isNumber(S)?S:0}toInteger(m){return this.toNumber(Number.parseInt(m,10))}toBoolean(m,S=[]){const T=c$1.isString(m)?m.toLowerCase():m;return["true","y","1",1,!0,...S].includes(T)}toCamelCase(m){if(!c$1.isStringFilled(m))return m;const S=/[-_\s]+(.)?/g;return S.test(m)?(m=m.toLowerCase(),m=m.replace(S,(T,v)=>v?v.toUpperCase():""),m[0].toLowerCase()+m.substring(1)):m.match(/^[A-Z]+$/)?m.toLowerCase():m[0].toLowerCase()+m.slice(1)}toPascalCase(m){return c$1.isStringFilled(m)?this.capitalize(this.toCamelCase(m)):m}toKebabCase(m){if(!c$1.isStringFilled(m))return m;const S=m.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g);return S?S.map(T=>T.toLowerCase()).join("-"):m}capitalize(m){return c$1.isStringFilled(m)?m[0].toUpperCase()+m.substring(1):m}numberFormat(m,S=0,T=".",v=","){const O=Number.isFinite(m)?m:0,A=Number.isFinite(S)?Math.abs(S):0;let C=(A?((k,$)=>{const M=Math.pow(10,$);return Math.round(k*M)/M})(O,A):Math.round(O)).toString().split(".");return C[0].length>3&&(C[0]=C[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,v)),(C[1]||"").length<A&&(C[1]=C[1]||"",C[1]+=new Array(A-C[1].length+1).join("0")),C.join(T)}toDateTime(m,S,T){return!(typeof S>"u")&&c$1.isStringFilled(S)?DateTime.fromFormat(m,S,T):DateTime.fromISO(m,T)}getDateForLog(){return DateTime.now().toFormat("y-MM-dd HH:mm:ss")}buildQueryString(m){let S="";for(let T in m){if(!m.hasOwnProperty(T))continue;const v=m[T];c$1.isArray(v)?v.forEach((O,A)=>{S+=encodeURIComponent(T+"["+A+"]")+"="+encodeURIComponent(O)+"&"}):S+=encodeURIComponent(T)+"="+encodeURIComponent(v)+"&"}return S.length>0&&(S=S.substring(0,S.length-1)),S}}const h$1=new b,i$1=navigator?.userAgent.toLowerCase()||"?";let r$1=class{isOpera(){return i$1.includes("opera")}isIE(){return"attachEvent"in document&&!this.isOpera()}isIE6(){return i$1.includes("msie 6")}isIE7(){return i$1.includes("msie 7")}isIE8(){return i$1.includes("msie 8")}isIE9(){return"documentMode"in document&&document.documentMode>=9}isIE10(){return"documentMode"in document&&document.documentMode>=10}isSafari(){return i$1.includes("safari")&&!i$1.includes("chrome")}isFirefox(){return i$1.includes("firefox")}isChrome(){return i$1.includes("chrome")}detectIEVersion(){if(this.isOpera()||this.isSafari()||this.isFirefox()||this.isChrome())return-1;let m=-1;if(window.MSStream&&!window.ActiveXObject&&"ActiveXObject"in window?m=11:this.isIE10()?m=10:this.isIE9()?m=9:this.isIE()&&(m=8),m===-1||m===8){if(navigator.appName==="Microsoft Internet Explorer"){const S=new RegExp("MSIE ([0-9]+[.0-9]*)"),T=navigator.userAgent.match(S);c$1.isArrayLike(T)&&T.length>0&&(m=parseFloat(T[1]))}if(navigator.appName==="Netscape"){m=11;const S=new RegExp("Trident/.*rv:([0-9]+[.0-9]*)");if(S.exec(navigator.userAgent)!=null){const T=navigator.userAgent.match(S);c$1.isArrayLike(T)&&T.length>0&&(m=parseFloat(T[1]))}}}return m}isIE11(){return this.detectIEVersion()>=11}isMac(){return i$1.includes("macintosh")}isWin(){return i$1.includes("windows")}isLinux(){return i$1.includes("linux")&&!this.isAndroid()}isAndroid(){return i$1.includes("android")}isIPad(){return i$1.includes("ipad;")||this.isMac()&&this.isTouchDevice()}isIPhone(){return i$1.includes("iphone;")}isIOS(){return this.isIPad()||this.isIPhone()}isMobile(){return this.isIPhone()||this.isIPad()||this.isAndroid()||i$1.includes("mobile")||i$1.includes("touch")}isRetina(){return(window.devicePixelRatio&&window.devicePixelRatio>=2)===!0}isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}isDoctype(m){const S=m||document;return S.compatMode?S.compatMode==="CSS1Compat":S.documentElement&&S.documentElement.clientHeight}isLocalStorageSupported(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch{return!1}}detectAndroidVersion(){const m=new RegExp("Android ([0-9]+[.0-9]*)");if(m.exec(navigator.userAgent)!=null){const S=navigator.userAgent.match(m);if(c$1.isArrayLike(S)&&S.length>0)return parseFloat(S[1])}return 0}};const s=new r$1,RestrictionManagerParamsBase={sleep:1e3,speed:.001,amount:30},RestrictionManagerParamsForEnterprise={sleep:600,speed:.01,amount:30*5};var EnumCrmEntityType=(_=>(_.undefined="UNDEFINED",_.lead="CRM_LEAD",_.deal="CRM_DEAL",_.contact="CRM_CONTACT",_.company="CRM_COMPANY",_.oldInvoice="CRM_INVOICE",_.invoice="CRM_SMART_INVOICE",_.quote="CRM_QUOTE",_.requisite="CRM_REQUISITE",_))(EnumCrmEntityType||{}),EnumCrmEntityTypeId=(_=>(_[_.undefined=0]="undefined",_[_.lead=1]="lead",_[_.deal=2]="deal",_[_.contact=3]="contact",_[_.company=4]="company",_[_.oldInvoice=5]="oldInvoice",_[_.invoice=31]="invoice",_[_.quote=7]="quote",_[_.requisite=8]="requisite",_))(EnumCrmEntityTypeId||{}),LoadDataType=(_=>(_.App="app",_.Profile="profile",_.Currency="currency",_.AppOptions="appOptions",_.UserOptions="userOptions",_))(LoadDataType||{});const EnumAppStatus={Free:"F",Demo:"D",Trial:"T",Paid:"P",Local:"L",Subscription:"S"},StatusDescriptions={[EnumAppStatus.Free]:"Free",[EnumAppStatus.Demo]:"Demo",[EnumAppStatus.Trial]:"Trial",[EnumAppStatus.Paid]:"Paid",[EnumAppStatus.Local]:"Local",[EnumAppStatus.Subscription]:"Subscription"},TypeSpecificUrl={MainSettings:"MainSettings",UfList:"UfList",UfPage:"UfPage"};var TypeOption=(_=>(_.NotSet="notSet",_.JsonArray="jsonArray",_.JsonObject="jsonObject",_.FloatVal="float",_.IntegerVal="integer",_.BoolYN="boolYN",_.StringVal="string",_))(TypeOption||{}),ConnectionType=(_=>(_.Undefined="undefined",_.WebSocket="webSocket",_.LongPolling="longPolling",_))(ConnectionType||{}),LsKeys=(_=>(_.PullConfig="bx-pull-config",_.WebsocketBlocked="bx-pull-websocket-blocked",_.LongPollingBlocked="bx-pull-longpolling-blocked",_.LoggingEnabled="bx-pull-logging-enabled",_))(LsKeys||{}),PullStatus=(_=>(_.Online="online",_.Offline="offline",_.Connecting="connect",_))(PullStatus||{}),SenderType=(_=>(_[_.Unknown=0]="Unknown",_[_.Client=1]="Client",_[_.Backend=2]="Backend",_))(SenderType||{}),SubscriptionType=(_=>(_.Server="server",_.Client="client",_.Online="online",_.Status="status",_.Revision="revision",_))(SubscriptionType||{}),CloseReasons=(_=>(_[_.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",_[_.SERVER_DIE=1001]="SERVER_DIE",_[_.CONFIG_REPLACED=3e3]="CONFIG_REPLACED",_[_.CHANNEL_EXPIRED=3001]="CHANNEL_EXPIRED",_[_.SERVER_RESTARTED=3002]="SERVER_RESTARTED",_[_.CONFIG_EXPIRED=3003]="CONFIG_EXPIRED",_[_.MANUAL=3004]="MANUAL",_[_.STUCK=3005]="STUCK",_[_.WRONG_CHANNEL_ID=4010]="WRONG_CHANNEL_ID",_))(CloseReasons||{}),SystemCommands=(_=>(_.CHANNEL_EXPIRE="CHANNEL_EXPIRE",_.CONFIG_EXPIRE="CONFIG_EXPIRE",_.SERVER_RESTART="SERVER_RESTART",_))(SystemCommands||{}),ServerMode=(_=>(_.Shared="shared",_.Personal="personal",_))(ServerMode||{});const ListRpcError={Parse:{code:-32700,message:"Parse error"},InvalidRequest:{code:-32600,message:"Invalid Request"},MethodNotFound:{code:-32601,message:"Method not found"},InvalidParams:{code:-32602,message:"Invalid params"},Internal:{code:-32603,message:"Internal error"}};var RpcMethod=(_=>(_.Publish="publish",_.GetUsersLastSeen="getUsersLastSeen",_.Ping="ping",_.ListChannels="listChannels",_.SubscribeStatusChange="subscribeStatusChange",_.UnsubscribeStatusChange="unsubscribeStatusChange",_))(RpcMethod||{});class Result{_errorCollection;_data;constructor(){this._errorCollection=new Set,this._data=null}get isSuccess(){return this._errorCollection.size<1}setData(m){return this._data=m,this}getData(){return this._data}addError(m){return m instanceof Error?this._errorCollection.add(m):this._errorCollection.add(new Error(m.toString())),this}addErrors(m){return m.forEach(S=>{S instanceof Error?this._errorCollection.add(S):this._errorCollection.add(new Error(S.toString()))}),this}getErrors(){return this._errorCollection.values()}getErrorMessages(){return Array.from(this.getErrors()).map(m=>m.message)}toString(){return this.isSuccess?`Result (success): data: ${JSON.stringify(this._data)}`:`Result (failure): errors: ${this.getErrorMessages().join(", ")}`}}class AjaxError extends Error{cause;_status;_answerError;constructor(m){const S=`${m.answerError.error}${m.answerError.errorDescription?": "+m.answerError.errorDescription:""}`;super(S),this.cause=m.cause||null,this.name=this.constructor.name,this._status=m.status,this._answerError=m.answerError}get answerError(){return this._answerError}get status(){return this._status}set status(m){this._status=m}toString(){return`${this.answerError.error}${this.answerError.errorDescription?": "+this.answerError.errorDescription:""} (${this.status})`}}class AjaxResult extends Result{_status;_query;_data;constructor(m,S,T){if(super(),this._data=m,this._query=structuredClone(S),this._status=T,typeof this._data.error<"u"){let v=typeof this._data.error=="string"?this._data:this._data.error;this.addError(new AjaxError({status:this._status,answerError:{error:v.error||"",errorDescription:v.error_description||""}}))}}setData(m){throw new Error("AjaxResult not support setData()")}getData(){return this._data}isMore(){return c$1.isNumber(this._data?.next)}getTotal(){return h$1.toInteger(this._data?.total)}getStatus(){return this._status}getQuery(){return this._query}async getNext(m){return this.isMore()&&this.isSuccess?(this._query.start=parseInt(this._data?.next),m.call(this._query.method,this._query.params,this._query.start)):Promise.resolve(!1)}}let n$1=class{#e;#t;#r;_logger=null;constructor(){this.#e=RestrictionManagerParamsBase,this.#r=0,this.#t=0}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}get params(){return{...this.#e}}set params(m){this.#e=m,this.getLogger().log("new restriction manager params",m)}check(m=""){return new Promise(S=>{if(this.#i(),this.#s())return this.getLogger().log(`>> no sleep >>> ${m}`,this.#n()),this.#o(),S(null);{const T=O=>{this.getLogger().info(`>> go sleep >>> ${m}`,this.#n()),setTimeout(()=>{O()},this.#e.sleep)},v=()=>{if(this.#i(),!this.#s())T(v);else return this.getLogger().info(`<< stop sleep <<< ${m}`,this.#n()),this.#o(),S(null)};T(v)}})}#n(){return`${this.#r.toFixed(4)} from ${this.#e.amount}`}#i(){this.#t>0&&(this.#r-=(new Date().valueOf()-this.#t)*this.#e.speed,this.#r<0&&(this.#r=0)),this.#t=new Date().valueOf()}#o(){this.#r++}#s(){return this.#r<this.#e.amount}};const t$1="X-Request-ID",r="bx24_request_id",n="bx24_sdk_ver";let u$1=class{getQueryStringParameterName(){return r}getQueryStringSdkParameterName(){return n}generate(){return h$1.getUuidRfc4122()}getRequestId(){return this.generate()}getHeaderFieldName(){return t$1}};function bind(_,m){return function(){return _.apply(m,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(_=>m=>{const S=toString.call(m);return _[S]||(_[S]=S.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=_=>(_=_.toLowerCase(),m=>kindOf(m)===_),typeOfTest=_=>m=>typeof m===_,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(_){return _!==null&&!isUndefined(_)&&_.constructor!==null&&!isUndefined(_.constructor)&&isFunction(_.constructor.isBuffer)&&_.constructor.isBuffer(_)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(_){let m;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?m=ArrayBuffer.isView(_):m=_&&_.buffer&&isArrayBuffer(_.buffer),m}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=_=>_!==null&&typeof _=="object",isBoolean=_=>_===!0||_===!1,isPlainObject=_=>{if(kindOf(_)!=="object")return!1;const m=getPrototypeOf(_);return(m===null||m===Object.prototype||Object.getPrototypeOf(m)===null)&&!(Symbol.toStringTag in _)&&!(Symbol.iterator in _)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=_=>isObject(_)&&isFunction(_.pipe),isFormData=_=>{let m;return _&&(typeof FormData=="function"&&_ instanceof FormData||isFunction(_.append)&&((m=kindOf(_))==="formdata"||m==="object"&&isFunction(_.toString)&&_.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=_=>_.trim?_.trim():_.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(_,m,{allOwnKeys:S=!1}={}){if(_===null||typeof _>"u")return;let T,v;if(typeof _!="object"&&(_=[_]),isArray(_))for(T=0,v=_.length;T<v;T++)m.call(null,_[T],T,_);else{const O=S?Object.getOwnPropertyNames(_):Object.keys(_),A=O.length;let C;for(T=0;T<A;T++)C=O[T],m.call(null,_[C],C,_)}}function findKey(_,m){m=m.toLowerCase();const S=Object.keys(_);let T=S.length,v;for(;T-- >0;)if(v=S[T],m===v.toLowerCase())return v;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=_=>!isUndefined(_)&&_!==_global;function merge(){const{caseless:_}=isContextDefined(this)&&this||{},m={},S=(T,v)=>{const O=_&&findKey(m,v)||v;isPlainObject(m[O])&&isPlainObject(T)?m[O]=merge(m[O],T):isPlainObject(T)?m[O]=merge({},T):isArray(T)?m[O]=T.slice():m[O]=T};for(let T=0,v=arguments.length;T<v;T++)arguments[T]&&forEach(arguments[T],S);return m}const extend=(_,m,S,{allOwnKeys:T}={})=>(forEach(m,(v,O)=>{S&&isFunction(v)?_[O]=bind(v,S):_[O]=v},{allOwnKeys:T}),_),stripBOM=_=>(_.charCodeAt(0)===65279&&(_=_.slice(1)),_),inherits=(_,m,S,T)=>{_.prototype=Object.create(m.prototype,T),_.prototype.constructor=_,Object.defineProperty(_,"super",{value:m.prototype}),S&&Object.assign(_.prototype,S)},toFlatObject=(_,m,S,T)=>{let v,O,A;const C={};if(m=m||{},_==null)return m;do{for(v=Object.getOwnPropertyNames(_),O=v.length;O-- >0;)A=v[O],(!T||T(A,_,m))&&!C[A]&&(m[A]=_[A],C[A]=!0);_=S!==!1&&getPrototypeOf(_)}while(_&&(!S||S(_,m))&&_!==Object.prototype);return m},endsWith=(_,m,S)=>{_=String(_),(S===void 0||S>_.length)&&(S=_.length),S-=m.length;const T=_.indexOf(m,S);return T!==-1&&T===S},toArray=_=>{if(!_)return null;if(isArray(_))return _;let m=_.length;if(!isNumber(m))return null;const S=new Array(m);for(;m-- >0;)S[m]=_[m];return S},isTypedArray=(_=>m=>_&&m instanceof _)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(_,m)=>{const T=(_&&_[Symbol.iterator]).call(_);let v;for(;(v=T.next())&&!v.done;){const O=v.value;m.call(_,O[0],O[1])}},matchAll=(_,m)=>{let S;const T=[];for(;(S=_.exec(m))!==null;)T.push(S);return T},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=_=>_.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(S,T,v){return T.toUpperCase()+v}),hasOwnProperty=(({hasOwnProperty:_})=>(m,S)=>_.call(m,S))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(_,m)=>{const S=Object.getOwnPropertyDescriptors(_),T={};forEach(S,(v,O)=>{let A;(A=m(v,O,_))!==!1&&(T[O]=A||v)}),Object.defineProperties(_,T)},freezeMethods=_=>{reduceDescriptors(_,(m,S)=>{if(isFunction(_)&&["arguments","caller","callee"].indexOf(S)!==-1)return!1;const T=_[S];if(isFunction(T)){if(m.enumerable=!1,"writable"in m){m.writable=!1;return}m.set||(m.set=()=>{throw Error("Can not rewrite read-only method '"+S+"'")})}})},toObjectSet=(_,m)=>{const S={},T=v=>{v.forEach(O=>{S[O]=!0})};return isArray(_)?T(_):T(String(_).split(m)),S},noop=()=>{},toFiniteNumber=(_,m)=>_!=null&&Number.isFinite(_=+_)?_:m,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(_=16,m=ALPHABET.ALPHA_DIGIT)=>{let S="";const{length:T}=m;for(;_--;)S+=m[Math.random()*T|0];return S};function isSpecCompliantForm(_){return!!(_&&isFunction(_.append)&&_[Symbol.toStringTag]==="FormData"&&_[Symbol.iterator])}const toJSONObject=_=>{const m=new Array(10),S=(T,v)=>{if(isObject(T)){if(m.indexOf(T)>=0)return;if(!("toJSON"in T)){m[v]=T;const O=isArray(T)?[]:{};return forEach(T,(A,C)=>{const k=S(A,v+1);!isUndefined(k)&&(O[C]=k)}),m[v]=void 0,O}}return T};return S(_,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=_=>_&&(isObject(_)||isFunction(_))&&isFunction(_.then)&&isFunction(_.catch),_setImmediate=((_,m)=>_?setImmediate:m?((S,T)=>(_global.addEventListener("message",({source:v,data:O})=>{v===_global&&O===S&&T.length&&T.shift()()},!1),v=>{T.push(v),_global.postMessage(S,"*")}))(`axios@${Math.random()}`,[]):S=>setTimeout(S))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$2={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError$1(_,m,S,T,v){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=_,this.name="AxiosError",m&&(this.code=m),S&&(this.config=S),T&&(this.request=T),v&&(this.response=v,this.status=v.status?v.status:null)}utils$2.inherits(AxiosError$1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$2.toJSONObject(this.config),code:this.code,status:this.status}}});const prototype$1=AxiosError$1.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(_=>{descriptors[_]={value:_}}),Object.defineProperties(AxiosError$1,descriptors),Object.defineProperty(prototype$1,"isAxiosError",{value:!0}),AxiosError$1.from=(_,m,S,T,v,O)=>{const A=Object.create(prototype$1);return utils$2.toFlatObject(_,A,function(k){return k!==Error.prototype},C=>C!=="isAxiosError"),AxiosError$1.call(A,_.message,m,S,T,v),A.cause=_,A.name=_.name,O&&Object.assign(A,O),A};const httpAdapter=null;function isVisitable(_){return utils$2.isPlainObject(_)||utils$2.isArray(_)}function removeBrackets(_){return utils$2.endsWith(_,"[]")?_.slice(0,-2):_}function renderKey(_,m,S){return _?_.concat(m).map(function(v,O){return v=removeBrackets(v),!S&&O?"["+v+"]":v}).join(S?".":""):m}function isFlatArray(_){return utils$2.isArray(_)&&!_.some(isVisitable)}const predicates=utils$2.toFlatObject(utils$2,{},null,function(m){return/^is[A-Z]/.test(m)});function toFormData$1(_,m,S){if(!utils$2.isObject(_))throw new TypeError("target must be an object");m=m||new FormData,S=utils$2.toFlatObject(S,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,D){return!utils$2.isUndefined(D[j])});const T=S.metaTokens,v=S.visitor||M,O=S.dots,A=S.indexes,k=(S.Blob||typeof Blob<"u"&&Blob)&&utils$2.isSpecCompliantForm(m);if(!utils$2.isFunction(v))throw new TypeError("visitor must be a function");function $(B){if(B===null)return"";if(utils$2.isDate(B))return B.toISOString();if(!k&&utils$2.isBlob(B))throw new AxiosError$1("Blob is not supported. Use a Buffer instead.");return utils$2.isArrayBuffer(B)||utils$2.isTypedArray(B)?k&&typeof Blob=="function"?new Blob([B]):Buffer.from(B):B}function M(B,j,D){let q=B;if(B&&!D&&typeof B=="object"){if(utils$2.endsWith(j,"{}"))j=T?j:j.slice(0,-2),B=JSON.stringify(B);else if(utils$2.isArray(B)&&isFlatArray(B)||(utils$2.isFileList(B)||utils$2.endsWith(j,"[]"))&&(q=utils$2.toArray(B)))return j=removeBrackets(j),q.forEach(function(Y,Q){!(utils$2.isUndefined(Y)||Y===null)&&m.append(A===!0?renderKey([j],Q,O):A===null?j:j+"[]",$(Y))}),!1}return isVisitable(B)?!0:(m.append(renderKey(D,j,O),$(B)),!1)}const P=[],U=Object.assign(predicates,{defaultVisitor:M,convertValue:$,isVisitable});function N(B,j){if(!utils$2.isUndefined(B)){if(P.indexOf(B)!==-1)throw Error("Circular reference detected in "+j.join("."));P.push(B),utils$2.forEach(B,function(q,W){(!(utils$2.isUndefined(q)||q===null)&&v.call(m,q,utils$2.isString(W)?W.trim():W,j,U))===!0&&N(q,j?j.concat(W):[W])}),P.pop()}}if(!utils$2.isObject(_))throw new TypeError("data must be an object");return N(_),m}function encode$1(_){const m={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(_).replace(/[!'()~]|%20|%00/g,function(T){return m[T]})}function AxiosURLSearchParams(_,m){this._pairs=[],_&&toFormData$1(_,this,m)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(m,S){this._pairs.push([m,S])},prototype.toString=function(m){const S=m?function(T){return m.call(this,T,encode$1)}:encode$1;return this._pairs.map(function(v){return S(v[0])+"="+S(v[1])},"").join("&")};function encode(_){return encodeURIComponent(_).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(_,m,S){if(!m)return _;const T=S&&S.encode||encode,v=S&&S.serialize;let O;if(v?O=v(m,S):O=utils$2.isURLSearchParams(m)?m.toString():new AxiosURLSearchParams(m,S).toString(T),O){const A=_.indexOf("#");A!==-1&&(_=_.slice(0,A)),_+=(_.indexOf("?")===-1?"?":"&")+O}return _}class InterceptorManager{constructor(){this.handlers=[]}use(m,S,T){return this.handlers.push({fulfilled:m,rejected:S,synchronous:T?T.synchronous:!1,runWhen:T?T.runWhen:null}),this.handlers.length-1}eject(m){this.handlers[m]&&(this.handlers[m]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(m){utils$2.forEach(this.handlers,function(T){T!==null&&m(T)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",_navigator=typeof navigator=="object"&&navigator||void 0,hasStandardBrowserEnv=hasBrowserEnv&&(!_navigator||["ReactNative","NativeScript","NS"].indexOf(_navigator.product)<0),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils$1={__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,navigator:_navigator,origin},platform={...utils$1,...platform$1};function toURLEncodedForm(_,m){return toFormData$1(_,new platform.classes.URLSearchParams,Object.assign({visitor:function(S,T,v,O){return platform.isNode&&utils$2.isBuffer(S)?(this.append(T,S.toString("base64")),!1):O.defaultVisitor.apply(this,arguments)}},m))}function parsePropPath(_){return utils$2.matchAll(/\w+|\[(\w*)]/g,_).map(m=>m[0]==="[]"?"":m[1]||m[0])}function arrayToObject(_){const m={},S=Object.keys(_);let T;const v=S.length;let O;for(T=0;T<v;T++)O=S[T],m[O]=_[O];return m}function formDataToJSON(_){function m(S,T,v,O){let A=S[O++];if(A==="__proto__")return!0;const C=Number.isFinite(+A),k=O>=S.length;return A=!A&&utils$2.isArray(v)?v.length:A,k?(utils$2.hasOwnProp(v,A)?v[A]=[v[A],T]:v[A]=T,!C):((!v[A]||!utils$2.isObject(v[A]))&&(v[A]=[]),m(S,T,v[A],O)&&utils$2.isArray(v[A])&&(v[A]=arrayToObject(v[A])),!C)}if(utils$2.isFormData(_)&&utils$2.isFunction(_.entries)){const S={};return utils$2.forEachEntry(_,(T,v)=>{m(parsePropPath(T),v,S,0)}),S}return null}function stringifySafely(_,m,S){if(utils$2.isString(_))try{return(m||JSON.parse)(_),utils$2.trim(_)}catch(T){if(T.name!=="SyntaxError")throw T}return(0,JSON.stringify)(_)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(m,S){const T=S.getContentType()||"",v=T.indexOf("application/json")>-1,O=utils$2.isObject(m);if(O&&utils$2.isHTMLForm(m)&&(m=new FormData(m)),utils$2.isFormData(m))return v?JSON.stringify(formDataToJSON(m)):m;if(utils$2.isArrayBuffer(m)||utils$2.isBuffer(m)||utils$2.isStream(m)||utils$2.isFile(m)||utils$2.isBlob(m)||utils$2.isReadableStream(m))return m;if(utils$2.isArrayBufferView(m))return m.buffer;if(utils$2.isURLSearchParams(m))return S.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),m.toString();let C;if(O){if(T.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(m,this.formSerializer).toString();if((C=utils$2.isFileList(m))||T.indexOf("multipart/form-data")>-1){const k=this.env&&this.env.FormData;return toFormData$1(C?{"files[]":m}:m,k&&new k,this.formSerializer)}}return O||v?(S.setContentType("application/json",!1),stringifySafely(m)):m}],transformResponse:[function(m){const S=this.transitional||defaults.transitional,T=S&&S.forcedJSONParsing,v=this.responseType==="json";if(utils$2.isResponse(m)||utils$2.isReadableStream(m))return m;if(m&&utils$2.isString(m)&&(T&&!this.responseType||v)){const A=!(S&&S.silentJSONParsing)&&v;try{return JSON.parse(m)}catch(C){if(A)throw C.name==="SyntaxError"?AxiosError$1.from(C,AxiosError$1.ERR_BAD_RESPONSE,this,null,this.response):C}}return m}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(m){return m>=200&&m<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$2.forEach(["delete","get","head","post","put","patch"],_=>{defaults.headers[_]={}});const ignoreDuplicateOf=utils$2.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=_=>{const m={};let S,T,v;return _&&_.split(`
`).forEach(function(A){v=A.indexOf(":"),S=A.substring(0,v).trim().toLowerCase(),T=A.substring(v+1).trim(),!(!S||m[S]&&ignoreDuplicateOf[S])&&(S==="set-cookie"?m[S]?m[S].push(T):m[S]=[T]:m[S]=m[S]?m[S]+", "+T:T)}),m},$internals=Symbol("internals");function normalizeHeader(_){return _&&String(_).trim().toLowerCase()}function normalizeValue(_){return _===!1||_==null?_:utils$2.isArray(_)?_.map(normalizeValue):String(_)}function parseTokens(_){const m=Object.create(null),S=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let T;for(;T=S.exec(_);)m[T[1]]=T[2];return m}const isValidHeaderName=_=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(_.trim());function matchHeaderValue(_,m,S,T,v){if(utils$2.isFunction(T))return T.call(this,m,S);if(v&&(m=S),!!utils$2.isString(m)){if(utils$2.isString(T))return m.indexOf(T)!==-1;if(utils$2.isRegExp(T))return T.test(m)}}function formatHeader(_){return _.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(m,S,T)=>S.toUpperCase()+T)}function buildAccessors(_,m){const S=utils$2.toCamelCase(" "+m);["get","set","has"].forEach(T=>{Object.defineProperty(_,T+S,{value:function(v,O,A){return this[T].call(this,m,v,O,A)},configurable:!0})})}let AxiosHeaders$1=class{constructor(m){m&&this.set(m)}set(m,S,T){const v=this;function O(C,k,$){const M=normalizeHeader(k);if(!M)throw new Error("header name must be a non-empty string");const P=utils$2.findKey(v,M);(!P||v[P]===void 0||$===!0||$===void 0&&v[P]!==!1)&&(v[P||k]=normalizeValue(C))}const A=(C,k)=>utils$2.forEach(C,($,M)=>O($,M,k));if(utils$2.isPlainObject(m)||m instanceof this.constructor)A(m,S);else if(utils$2.isString(m)&&(m=m.trim())&&!isValidHeaderName(m))A(parseHeaders(m),S);else if(utils$2.isHeaders(m))for(const[C,k]of m.entries())O(k,C,T);else m!=null&&O(S,m,T);return this}get(m,S){if(m=normalizeHeader(m),m){const T=utils$2.findKey(this,m);if(T){const v=this[T];if(!S)return v;if(S===!0)return parseTokens(v);if(utils$2.isFunction(S))return S.call(this,v,T);if(utils$2.isRegExp(S))return S.exec(v);throw new TypeError("parser must be boolean|regexp|function")}}}has(m,S){if(m=normalizeHeader(m),m){const T=utils$2.findKey(this,m);return!!(T&&this[T]!==void 0&&(!S||matchHeaderValue(this,this[T],T,S)))}return!1}delete(m,S){const T=this;let v=!1;function O(A){if(A=normalizeHeader(A),A){const C=utils$2.findKey(T,A);C&&(!S||matchHeaderValue(T,T[C],C,S))&&(delete T[C],v=!0)}}return utils$2.isArray(m)?m.forEach(O):O(m),v}clear(m){const S=Object.keys(this);let T=S.length,v=!1;for(;T--;){const O=S[T];(!m||matchHeaderValue(this,this[O],O,m,!0))&&(delete this[O],v=!0)}return v}normalize(m){const S=this,T={};return utils$2.forEach(this,(v,O)=>{const A=utils$2.findKey(T,O);if(A){S[A]=normalizeValue(v),delete S[O];return}const C=m?formatHeader(O):String(O).trim();C!==O&&delete S[O],S[C]=normalizeValue(v),T[C]=!0}),this}concat(...m){return this.constructor.concat(this,...m)}toJSON(m){const S=Object.create(null);return utils$2.forEach(this,(T,v)=>{T!=null&&T!==!1&&(S[v]=m&&utils$2.isArray(T)?T.join(", "):T)}),S}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([m,S])=>m+": "+S).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(m){return m instanceof this?m:new this(m)}static concat(m,...S){const T=new this(m);return S.forEach(v=>T.set(v)),T}static accessor(m){const T=(this[$internals]=this[$internals]={accessors:{}}).accessors,v=this.prototype;function O(A){const C=normalizeHeader(A);T[C]||(buildAccessors(v,A),T[C]=!0)}return utils$2.isArray(m)?m.forEach(O):O(m),this}};AxiosHeaders$1.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),utils$2.reduceDescriptors(AxiosHeaders$1.prototype,({value:_},m)=>{let S=m[0].toUpperCase()+m.slice(1);return{get:()=>_,set(T){this[S]=T}}}),utils$2.freezeMethods(AxiosHeaders$1);function transformData(_,m){const S=this||defaults,T=m||S,v=AxiosHeaders$1.from(T.headers);let O=T.data;return utils$2.forEach(_,function(C){O=C.call(S,O,v.normalize(),m?m.status:void 0)}),v.normalize(),O}function isCancel$1(_){return!!(_&&_.__CANCEL__)}function CanceledError$1(_,m,S){AxiosError$1.call(this,_??"canceled",AxiosError$1.ERR_CANCELED,m,S),this.name="CanceledError"}utils$2.inherits(CanceledError$1,AxiosError$1,{__CANCEL__:!0});function settle(_,m,S){const T=S.config.validateStatus;!S.status||!T||T(S.status)?_(S):m(new AxiosError$1("Request failed with status code "+S.status,[AxiosError$1.ERR_BAD_REQUEST,AxiosError$1.ERR_BAD_RESPONSE][Math.floor(S.status/100)-4],S.config,S.request,S))}function parseProtocol(_){const m=/^([-+\w]{1,25})(:?\/\/|:)/.exec(_);return m&&m[1]||""}function speedometer(_,m){_=_||10;const S=new Array(_),T=new Array(_);let v=0,O=0,A;return m=m!==void 0?m:1e3,function(k){const $=Date.now(),M=T[O];A||(A=$),S[v]=k,T[v]=$;let P=O,U=0;for(;P!==v;)U+=S[P++],P=P%_;if(v=(v+1)%_,v===O&&(O=(O+1)%_),$-A<m)return;const N=M&&$-M;return N?Math.round(U*1e3/N):void 0}}function throttle(_,m){let S=0,T=1e3/m,v,O;const A=($,M=Date.now())=>{S=M,v=null,O&&(clearTimeout(O),O=null),_.apply(null,$)};return[(...$)=>{const M=Date.now(),P=M-S;P>=T?A($,M):(v=$,O||(O=setTimeout(()=>{O=null,A(v)},T-P)))},()=>v&&A(v)]}const progressEventReducer=(_,m,S=3)=>{let T=0;const v=speedometer(50,250);return throttle(O=>{const A=O.loaded,C=O.lengthComputable?O.total:void 0,k=A-T,$=v(k),M=A<=C;T=A;const P={loaded:A,total:C,progress:C?A/C:void 0,bytes:k,rate:$||void 0,estimated:$&&C&&M?(C-A)/$:void 0,event:O,lengthComputable:C!=null,[m?"download":"upload"]:!0};_(P)},S)},progressEventDecorator=(_,m)=>{const S=_!=null;return[T=>m[0]({lengthComputable:S,total:_,loaded:T}),m[1]]},asyncDecorator=_=>(...m)=>utils$2.asap(()=>_(...m)),isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const m=platform.navigator&&/(msie|trident)/i.test(platform.navigator.userAgent),S=document.createElement("a");let T;function v(O){let A=O;return m&&(S.setAttribute("href",A),A=S.href),S.setAttribute("href",A),{href:S.href,protocol:S.protocol?S.protocol.replace(/:$/,""):"",host:S.host,search:S.search?S.search.replace(/^\?/,""):"",hash:S.hash?S.hash.replace(/^#/,""):"",hostname:S.hostname,port:S.port,pathname:S.pathname.charAt(0)==="/"?S.pathname:"/"+S.pathname}}return T=v(window.location.href),function(A){const C=utils$2.isString(A)?v(A):A;return C.protocol===T.protocol&&C.host===T.host}}():function(){return function(){return!0}}(),cookies=platform.hasStandardBrowserEnv?{write(_,m,S,T,v,O){const A=[_+"="+encodeURIComponent(m)];utils$2.isNumber(S)&&A.push("expires="+new Date(S).toGMTString()),utils$2.isString(T)&&A.push("path="+T),utils$2.isString(v)&&A.push("domain="+v),O===!0&&A.push("secure"),document.cookie=A.join("; ")},read(_){const m=document.cookie.match(new RegExp("(^|;\\s*)("+_+")=([^;]*)"));return m?decodeURIComponent(m[3]):null},remove(_){this.write(_,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(_){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(_)}function combineURLs(_,m){return m?_.replace(/\/?\/$/,"")+"/"+m.replace(/^\/+/,""):_}function buildFullPath(_,m){return _&&!isAbsoluteURL(m)?combineURLs(_,m):m}const headersToObject=_=>_ instanceof AxiosHeaders$1?{..._}:_;function mergeConfig$1(_,m){m=m||{};const S={};function T($,M,P){return utils$2.isPlainObject($)&&utils$2.isPlainObject(M)?utils$2.merge.call({caseless:P},$,M):utils$2.isPlainObject(M)?utils$2.merge({},M):utils$2.isArray(M)?M.slice():M}function v($,M,P){if(utils$2.isUndefined(M)){if(!utils$2.isUndefined($))return T(void 0,$,P)}else return T($,M,P)}function O($,M){if(!utils$2.isUndefined(M))return T(void 0,M)}function A($,M){if(utils$2.isUndefined(M)){if(!utils$2.isUndefined($))return T(void 0,$)}else return T(void 0,M)}function C($,M,P){if(P in m)return T($,M);if(P in _)return T(void 0,$)}const k={url:O,method:O,data:O,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:C,headers:($,M)=>v(headersToObject($),headersToObject(M),!0)};return utils$2.forEach(Object.keys(Object.assign({},_,m)),function(M){const P=k[M]||v,U=P(_[M],m[M],M);utils$2.isUndefined(U)&&P!==C||(S[M]=U)}),S}const resolveConfig=_=>{const m=mergeConfig$1({},_);let{data:S,withXSRFToken:T,xsrfHeaderName:v,xsrfCookieName:O,headers:A,auth:C}=m;m.headers=A=AxiosHeaders$1.from(A),m.url=buildURL(buildFullPath(m.baseURL,m.url),_.params,_.paramsSerializer),C&&A.set("Authorization","Basic "+btoa((C.username||"")+":"+(C.password?unescape(encodeURIComponent(C.password)):"")));let k;if(utils$2.isFormData(S)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((k=A.getContentType())!==!1){const[$,...M]=k?k.split(";").map(P=>P.trim()).filter(Boolean):[];A.setContentType([$||"multipart/form-data",...M].join("; "))}}if(platform.hasStandardBrowserEnv&&(T&&utils$2.isFunction(T)&&(T=T(m)),T||T!==!1&&isURLSameOrigin(m.url))){const $=v&&O&&cookies.read(O);$&&A.set(v,$)}return m},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(_){return new Promise(function(S,T){const v=resolveConfig(_);let O=v.data;const A=AxiosHeaders$1.from(v.headers).normalize();let{responseType:C,onUploadProgress:k,onDownloadProgress:$}=v,M,P,U,N,B;function j(){N&&N(),B&&B(),v.cancelToken&&v.cancelToken.unsubscribe(M),v.signal&&v.signal.removeEventListener("abort",M)}let D=new XMLHttpRequest;D.open(v.method.toUpperCase(),v.url,!0),D.timeout=v.timeout;function q(){if(!D)return;const Y=AxiosHeaders$1.from("getAllResponseHeaders"in D&&D.getAllResponseHeaders()),K={data:!C||C==="text"||C==="json"?D.responseText:D.response,status:D.status,statusText:D.statusText,headers:Y,config:_,request:D};settle(function(ie){S(ie),j()},function(ie){T(ie),j()},K),D=null}"onloadend"in D?D.onloadend=q:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(q)},D.onabort=function(){D&&(T(new AxiosError$1("Request aborted",AxiosError$1.ECONNABORTED,_,D)),D=null)},D.onerror=function(){T(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,_,D)),D=null},D.ontimeout=function(){let Q=v.timeout?"timeout of "+v.timeout+"ms exceeded":"timeout exceeded";const K=v.transitional||transitionalDefaults;v.timeoutErrorMessage&&(Q=v.timeoutErrorMessage),T(new AxiosError$1(Q,K.clarifyTimeoutError?AxiosError$1.ETIMEDOUT:AxiosError$1.ECONNABORTED,_,D)),D=null},O===void 0&&A.setContentType(null),"setRequestHeader"in D&&utils$2.forEach(A.toJSON(),function(Q,K){D.setRequestHeader(K,Q)}),utils$2.isUndefined(v.withCredentials)||(D.withCredentials=!!v.withCredentials),C&&C!=="json"&&(D.responseType=v.responseType),$&&([U,B]=progressEventReducer($,!0),D.addEventListener("progress",U)),k&&D.upload&&([P,N]=progressEventReducer(k),D.upload.addEventListener("progress",P),D.upload.addEventListener("loadend",N)),(v.cancelToken||v.signal)&&(M=Y=>{D&&(T(!Y||Y.type?new CanceledError$1(null,_,D):Y),D.abort(),D=null)},v.cancelToken&&v.cancelToken.subscribe(M),v.signal&&(v.signal.aborted?M():v.signal.addEventListener("abort",M)));const W=parseProtocol(v.url);if(W&&platform.protocols.indexOf(W)===-1){T(new AxiosError$1("Unsupported protocol "+W+":",AxiosError$1.ERR_BAD_REQUEST,_));return}D.send(O||null)})},composeSignals=(_,m)=>{const{length:S}=_=_?_.filter(Boolean):[];if(m||S){let T=new AbortController,v;const O=function($){if(!v){v=!0,C();const M=$ instanceof Error?$:this.reason;T.abort(M instanceof AxiosError$1?M:new CanceledError$1(M instanceof Error?M.message:M))}};let A=m&&setTimeout(()=>{A=null,O(new AxiosError$1(`timeout ${m} of ms exceeded`,AxiosError$1.ETIMEDOUT))},m);const C=()=>{_&&(A&&clearTimeout(A),A=null,_.forEach($=>{$.unsubscribe?$.unsubscribe(O):$.removeEventListener("abort",O)}),_=null)};_.forEach($=>$.addEventListener("abort",O));const{signal:k}=T;return k.unsubscribe=()=>utils$2.asap(C),k}},streamChunk=function*(_,m){let S=_.byteLength;if(S<m){yield _;return}let T=0,v;for(;T<S;)v=T+m,yield _.slice(T,v),T=v},readBytes=async function*(_,m){for await(const S of readStream(_))yield*streamChunk(S,m)},readStream=async function*(_){if(_[Symbol.asyncIterator]){yield*_;return}const m=_.getReader();try{for(;;){const{done:S,value:T}=await m.read();if(S)break;yield T}}finally{await m.cancel()}},trackStream=(_,m,S,T)=>{const v=readBytes(_,m);let O=0,A,C=k=>{A||(A=!0,T&&T(k))};return new ReadableStream({async pull(k){try{const{done:$,value:M}=await v.next();if($){C(),k.close();return}let P=M.byteLength;if(S){let U=O+=P;S(U)}k.enqueue(new Uint8Array(M))}catch($){throw C($),$}},cancel(k){return C(k),v.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(_=>m=>_.encode(m))(new TextEncoder):async _=>new Uint8Array(await new Response(_).arrayBuffer())),test=(_,...m)=>{try{return!!_(...m)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let _=!1;const m=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!m}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$2.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(_=>_.body)};isFetchSupported&&(_=>{["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!resolvers[m]&&(resolvers[m]=utils$2.isFunction(_[m])?S=>S[m]():(S,T)=>{throw new AxiosError$1(`Response type '${m}' is not supported`,AxiosError$1.ERR_NOT_SUPPORT,T)})})})(new Response);const getBodyLength=async _=>{if(_==null)return 0;if(utils$2.isBlob(_))return _.size;if(utils$2.isSpecCompliantForm(_))return(await new Request(platform.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(utils$2.isArrayBufferView(_)||utils$2.isArrayBuffer(_))return _.byteLength;if(utils$2.isURLSearchParams(_)&&(_=_+""),utils$2.isString(_))return(await encodeText(_)).byteLength},resolveBodyLength=async(_,m)=>{const S=utils$2.toFiniteNumber(_.getContentLength());return S??getBodyLength(m)},fetchAdapter=isFetchSupported&&(async _=>{let{url:m,method:S,data:T,signal:v,cancelToken:O,timeout:A,onDownloadProgress:C,onUploadProgress:k,responseType:$,headers:M,withCredentials:P="same-origin",fetchOptions:U}=resolveConfig(_);$=$?($+"").toLowerCase():"text";let N=composeSignals([v,O&&O.toAbortSignal()],A),B;const j=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let D;try{if(k&&supportsRequestStream&&S!=="get"&&S!=="head"&&(D=await resolveBodyLength(M,T))!==0){let K=new Request(m,{method:"POST",body:T,duplex:"half"}),X;if(utils$2.isFormData(T)&&(X=K.headers.get("content-type"))&&M.setContentType(X),K.body){const[ie,ne]=progressEventDecorator(D,progressEventReducer(asyncDecorator(k)));T=trackStream(K.body,DEFAULT_CHUNK_SIZE,ie,ne)}}utils$2.isString(P)||(P=P?"include":"omit");const q="credentials"in Request.prototype;B=new Request(m,{...U,signal:N,method:S.toUpperCase(),headers:M.normalize().toJSON(),body:T,duplex:"half",credentials:q?P:void 0});let W=await fetch(B);const Y=supportsResponseStream&&($==="stream"||$==="response");if(supportsResponseStream&&(C||Y&&j)){const K={};["status","statusText","headers"].forEach(oe=>{K[oe]=W[oe]});const X=utils$2.toFiniteNumber(W.headers.get("content-length")),[ie,ne]=C&&progressEventDecorator(X,progressEventReducer(asyncDecorator(C),!0))||[];W=new Response(trackStream(W.body,DEFAULT_CHUNK_SIZE,ie,()=>{ne&&ne(),j&&j()}),K)}$=$||"text";let Q=await resolvers[utils$2.findKey(resolvers,$)||"text"](W,_);return!Y&&j&&j(),await new Promise((K,X)=>{settle(K,X,{data:Q,headers:AxiosHeaders$1.from(W.headers),status:W.status,statusText:W.statusText,config:_,request:B})})}catch(q){throw j&&j(),q&&q.name==="TypeError"&&/fetch/i.test(q.message)?Object.assign(new AxiosError$1("Network Error",AxiosError$1.ERR_NETWORK,_,B),{cause:q.cause||q}):AxiosError$1.from(q,q&&q.code,_,B)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$2.forEach(knownAdapters,(_,m)=>{if(_){try{Object.defineProperty(_,"name",{value:m})}catch{}Object.defineProperty(_,"adapterName",{value:m})}});const renderReason=_=>`- ${_}`,isResolvedHandle=_=>utils$2.isFunction(_)||_===null||_===!1,adapters={getAdapter:_=>{_=utils$2.isArray(_)?_:[_];const{length:m}=_;let S,T;const v={};for(let O=0;O<m;O++){S=_[O];let A;if(T=S,!isResolvedHandle(S)&&(T=knownAdapters[(A=String(S)).toLowerCase()],T===void 0))throw new AxiosError$1(`Unknown adapter '${A}'`);if(T)break;v[A||"#"+O]=T}if(!T){const O=Object.entries(v).map(([C,k])=>`adapter ${C} `+(k===!1?"is not supported by the environment":"is not available in the build"));let A=m?O.length>1?`since :
`+O.map(renderReason).join(`
`):" "+renderReason(O[0]):"as no adapter specified";throw new AxiosError$1("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return T},adapters:knownAdapters};function throwIfCancellationRequested(_){if(_.cancelToken&&_.cancelToken.throwIfRequested(),_.signal&&_.signal.aborted)throw new CanceledError$1(null,_)}function dispatchRequest(_){return throwIfCancellationRequested(_),_.headers=AxiosHeaders$1.from(_.headers),_.data=transformData.call(_,_.transformRequest),["post","put","patch"].indexOf(_.method)!==-1&&_.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(_.adapter||defaults.adapter)(_).then(function(T){return throwIfCancellationRequested(_),T.data=transformData.call(_,_.transformResponse,T),T.headers=AxiosHeaders$1.from(T.headers),T},function(T){return isCancel$1(T)||(throwIfCancellationRequested(_),T&&T.response&&(T.response.data=transformData.call(_,_.transformResponse,T.response),T.response.headers=AxiosHeaders$1.from(T.response.headers))),Promise.reject(T)})}const VERSION$1="1.7.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((_,m)=>{validators$1[_]=function(T){return typeof T===_||"a"+(m<1?"n ":" ")+_}});const deprecatedWarnings={};validators$1.transitional=function(m,S,T){function v(O,A){return"[Axios v"+VERSION$1+"] Transitional option '"+O+"'"+A+(T?". "+T:"")}return(O,A,C)=>{if(m===!1)throw new AxiosError$1(v(A," has been removed"+(S?" in "+S:"")),AxiosError$1.ERR_DEPRECATED);return S&&!deprecatedWarnings[A]&&(deprecatedWarnings[A]=!0,console.warn(v(A," has been deprecated since v"+S+" and will be removed in the near future"))),m?m(O,A,C):!0}};function assertOptions(_,m,S){if(typeof _!="object")throw new AxiosError$1("options must be an object",AxiosError$1.ERR_BAD_OPTION_VALUE);const T=Object.keys(_);let v=T.length;for(;v-- >0;){const O=T[v],A=m[O];if(A){const C=_[O],k=C===void 0||A(C,O,_);if(k!==!0)throw new AxiosError$1("option "+O+" must be "+k,AxiosError$1.ERR_BAD_OPTION_VALUE);continue}if(S!==!0)throw new AxiosError$1("Unknown option "+O,AxiosError$1.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;let Axios$1=class{constructor(m){this.defaults=m,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(m,S){try{return await this._request(m,S)}catch(T){if(T instanceof Error){let v;Error.captureStackTrace?Error.captureStackTrace(v={}):v=new Error;const O=v.stack?v.stack.replace(/^.+\n/,""):"";try{T.stack?O&&!String(T.stack).endsWith(O.replace(/^.+\n.+\n/,""))&&(T.stack+=`
`+O):T.stack=O}catch{}}throw T}}_request(m,S){typeof m=="string"?(S=S||{},S.url=m):S=m||{},S=mergeConfig$1(this.defaults,S);const{transitional:T,paramsSerializer:v,headers:O}=S;T!==void 0&&validator.assertOptions(T,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),v!=null&&(utils$2.isFunction(v)?S.paramsSerializer={serialize:v}:validator.assertOptions(v,{encode:validators.function,serialize:validators.function},!0)),S.method=(S.method||this.defaults.method||"get").toLowerCase();let A=O&&utils$2.merge(O.common,O[S.method]);O&&utils$2.forEach(["delete","get","head","post","put","patch","common"],B=>{delete O[B]}),S.headers=AxiosHeaders$1.concat(A,O);const C=[];let k=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(S)===!1||(k=k&&j.synchronous,C.unshift(j.fulfilled,j.rejected))});const $=[];this.interceptors.response.forEach(function(j){$.push(j.fulfilled,j.rejected)});let M,P=0,U;if(!k){const B=[dispatchRequest.bind(this),void 0];for(B.unshift.apply(B,C),B.push.apply(B,$),U=B.length,M=Promise.resolve(S);P<U;)M=M.then(B[P++],B[P++]);return M}U=C.length;let N=S;for(P=0;P<U;){const B=C[P++],j=C[P++];try{N=B(N)}catch(D){j.call(this,D);break}}try{M=dispatchRequest.call(this,N)}catch(B){return Promise.reject(B)}for(P=0,U=$.length;P<U;)M=M.then($[P++],$[P++]);return M}getUri(m){m=mergeConfig$1(this.defaults,m);const S=buildFullPath(m.baseURL,m.url);return buildURL(S,m.params,m.paramsSerializer)}};utils$2.forEach(["delete","get","head","options"],function(m){Axios$1.prototype[m]=function(S,T){return this.request(mergeConfig$1(T||{},{method:m,url:S,data:(T||{}).data}))}}),utils$2.forEach(["post","put","patch"],function(m){function S(T){return function(O,A,C){return this.request(mergeConfig$1(C||{},{method:m,headers:T?{"Content-Type":"multipart/form-data"}:{},url:O,data:A}))}}Axios$1.prototype[m]=S(),Axios$1.prototype[m+"Form"]=S(!0)});let CancelToken$1=class dt{constructor(m){if(typeof m!="function")throw new TypeError("executor must be a function.");let S;this.promise=new Promise(function(O){S=O});const T=this;this.promise.then(v=>{if(!T._listeners)return;let O=T._listeners.length;for(;O-- >0;)T._listeners[O](v);T._listeners=null}),this.promise.then=v=>{let O;const A=new Promise(C=>{T.subscribe(C),O=C}).then(v);return A.cancel=function(){T.unsubscribe(O)},A},m(function(O,A,C){T.reason||(T.reason=new CanceledError$1(O,A,C),S(T.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(m){if(this.reason){m(this.reason);return}this._listeners?this._listeners.push(m):this._listeners=[m]}unsubscribe(m){if(!this._listeners)return;const S=this._listeners.indexOf(m);S!==-1&&this._listeners.splice(S,1)}toAbortSignal(){const m=new AbortController,S=T=>{m.abort(T)};return this.subscribe(S),m.signal.unsubscribe=()=>this.unsubscribe(S),m.signal}static source(){let m;return{token:new dt(function(v){m=v}),cancel:m}}};function spread$1(_){return function(S){return _.apply(null,S)}}function isAxiosError$1(_){return utils$2.isObject(_)&&_.isAxiosError===!0}const HttpStatusCode$1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode$1).forEach(([_,m])=>{HttpStatusCode$1[m]=_});function createInstance(_){const m=new Axios$1(_),S=bind(Axios$1.prototype.request,m);return utils$2.extend(S,Axios$1.prototype,m,{allOwnKeys:!0}),utils$2.extend(S,m,null,{allOwnKeys:!0}),S.create=function(v){return createInstance(mergeConfig$1(_,v))},S}const axios=createInstance(defaults);axios.Axios=Axios$1,axios.CanceledError=CanceledError$1,axios.CancelToken=CancelToken$1,axios.isCancel=isCancel$1,axios.VERSION=VERSION$1,axios.toFormData=toFormData$1,axios.AxiosError=AxiosError$1,axios.Cancel=axios.CanceledError,axios.all=function(m){return Promise.all(m)},axios.spread=spread$1,axios.isAxiosError=isAxiosError$1,axios.mergeConfig=mergeConfig$1,axios.AxiosHeaders=AxiosHeaders$1,axios.formToJSON=_=>formDataToJSON(utils$2.isHTMLForm(_)?new FormData(_):_),axios.getAdapter=adapters.getAdapter,axios.HttpStatusCode=HttpStatusCode$1,axios.default=axios;const{Axios,AxiosError,CanceledError,isCancel,CancelToken,VERSION,all,Cancel,isAxiosError,spread,toFormData,AxiosHeaders,HttpStatusCode,formToJSON,getAdapter,mergeConfig}=axios;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}function getAugmentedNamespace(_){if(_.__esModule)return _;var m=_.default;if(typeof m=="function"){var S=function T(){return this instanceof T?Reflect.construct(m,arguments,this.constructor):m.apply(this,arguments)};S.prototype=m.prototype}else S={};return Object.defineProperty(S,"__esModule",{value:!0}),Object.keys(_).forEach(function(T){var v=Object.getOwnPropertyDescriptor(_,T);Object.defineProperty(S,T,v.get?v:{enumerable:!0,get:function(){return _[T]}})}),S}var esErrors,hasRequiredEsErrors;function requireEsErrors(){return hasRequiredEsErrors||(hasRequiredEsErrors=1,esErrors=Error),esErrors}var _eval,hasRequired_eval;function require_eval(){return hasRequired_eval||(hasRequired_eval=1,_eval=EvalError),_eval}var range,hasRequiredRange;function requireRange(){return hasRequiredRange||(hasRequiredRange=1,range=RangeError),range}var ref,hasRequiredRef;function requireRef(){return hasRequiredRef||(hasRequiredRef=1,ref=ReferenceError),ref}var syntax,hasRequiredSyntax;function requireSyntax(){return hasRequiredSyntax||(hasRequiredSyntax=1,syntax=SyntaxError),syntax}var type,hasRequiredType;function requireType(){return hasRequiredType||(hasRequiredType=1,type=TypeError),type}var uri,hasRequiredUri;function requireUri(){return hasRequiredUri||(hasRequiredUri=1,uri=URIError),uri}var shams,hasRequiredShams;function requireShams(){return hasRequiredShams||(hasRequiredShams=1,shams=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var m={},S=Symbol("test"),T=Object(S);if(typeof S=="string"||Object.prototype.toString.call(S)!=="[object Symbol]"||Object.prototype.toString.call(T)!=="[object Symbol]")return!1;var v=42;m[S]=v;for(S in m)return!1;if(typeof Object.keys=="function"&&Object.keys(m).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(m).length!==0)return!1;var O=Object.getOwnPropertySymbols(m);if(O.length!==1||O[0]!==S||!Object.prototype.propertyIsEnumerable.call(m,S))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var A=Object.getOwnPropertyDescriptor(m,S);if(A.value!==v||A.enumerable!==!0)return!1}return!0}),shams}var hasSymbols,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols;hasRequiredHasSymbols=1;var _=typeof Symbol<"u"&&Symbol,m=requireShams();return hasSymbols=function(){return typeof _!="function"||typeof Symbol!="function"||typeof _("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:m()},hasSymbols}var hasProto,hasRequiredHasProto;function requireHasProto(){if(hasRequiredHasProto)return hasProto;hasRequiredHasProto=1;var _={__proto__:null,foo:{}},m=Object;return hasProto=function(){return{__proto__:_}.foo===_.foo&&!(_ instanceof m)},hasProto}var implementation,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation;hasRequiredImplementation=1;var _="Function.prototype.bind called on incompatible ",m=Object.prototype.toString,S=Math.max,T="[object Function]",v=function(k,$){for(var M=[],P=0;P<k.length;P+=1)M[P]=k[P];for(var U=0;U<$.length;U+=1)M[U+k.length]=$[U];return M},O=function(k,$){for(var M=[],P=$,U=0;P<k.length;P+=1,U+=1)M[U]=k[P];return M},A=function(C,k){for(var $="",M=0;M<C.length;M+=1)$+=C[M],M+1<C.length&&($+=k);return $};return implementation=function(k){var $=this;if(typeof $!="function"||m.apply($)!==T)throw new TypeError(_+$);for(var M=O(arguments,1),P,U=function(){if(this instanceof P){var q=$.apply(this,v(M,arguments));return Object(q)===q?q:this}return $.apply(k,v(M,arguments))},N=S(0,$.length-M.length),B=[],j=0;j<N;j++)B[j]="$"+j;if(P=Function("binder","return function ("+A(B,",")+"){ return binder.apply(this,arguments); }")(U),$.prototype){var D=function(){};D.prototype=$.prototype,P.prototype=new D,D.prototype=null}return P},implementation}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var _=requireImplementation();return functionBind=Function.prototype.bind||_,functionBind}var hasown,hasRequiredHasown;function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var _=Function.prototype.call,m=Object.prototype.hasOwnProperty,S=requireFunctionBind();return hasown=S.call(_,m),hasown}var getIntrinsic,hasRequiredGetIntrinsic;function requireGetIntrinsic(){if(hasRequiredGetIntrinsic)return getIntrinsic;hasRequiredGetIntrinsic=1;var _,m=requireEsErrors(),S=require_eval(),T=requireRange(),v=requireRef(),O=requireSyntax(),A=requireType(),C=requireUri(),k=Function,$=function(me){try{return k('"use strict"; return ('+me+").constructor;")()}catch{}},M=Object.getOwnPropertyDescriptor;if(M)try{M({},"")}catch{M=null}var P=function(){throw new A},U=M?function(){try{return arguments.callee,P}catch{try{return M(arguments,"callee").get}catch{return P}}}():P,N=requireHasSymbols()(),B=requireHasProto()(),j=Object.getPrototypeOf||(B?function(me){return me.__proto__}:null),D={},q=typeof Uint8Array>"u"||!j?_:j(Uint8Array),W={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?_:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?_:ArrayBuffer,"%ArrayIteratorPrototype%":N&&j?j([][Symbol.iterator]()):_,"%AsyncFromSyncIteratorPrototype%":_,"%AsyncFunction%":D,"%AsyncGenerator%":D,"%AsyncGeneratorFunction%":D,"%AsyncIteratorPrototype%":D,"%Atomics%":typeof Atomics>"u"?_:Atomics,"%BigInt%":typeof BigInt>"u"?_:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?_:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?_:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?_:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":m,"%eval%":eval,"%EvalError%":S,"%Float32Array%":typeof Float32Array>"u"?_:Float32Array,"%Float64Array%":typeof Float64Array>"u"?_:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?_:FinalizationRegistry,"%Function%":k,"%GeneratorFunction%":D,"%Int8Array%":typeof Int8Array>"u"?_:Int8Array,"%Int16Array%":typeof Int16Array>"u"?_:Int16Array,"%Int32Array%":typeof Int32Array>"u"?_:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&j?j(j([][Symbol.iterator]())):_,"%JSON%":typeof JSON=="object"?JSON:_,"%Map%":typeof Map>"u"?_:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!j?_:j(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?_:Promise,"%Proxy%":typeof Proxy>"u"?_:Proxy,"%RangeError%":T,"%ReferenceError%":v,"%Reflect%":typeof Reflect>"u"?_:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?_:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!j?_:j(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?_:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&j?j(""[Symbol.iterator]()):_,"%Symbol%":N?Symbol:_,"%SyntaxError%":O,"%ThrowTypeError%":U,"%TypedArray%":q,"%TypeError%":A,"%Uint8Array%":typeof Uint8Array>"u"?_:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?_:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?_:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?_:Uint32Array,"%URIError%":C,"%WeakMap%":typeof WeakMap>"u"?_:WeakMap,"%WeakRef%":typeof WeakRef>"u"?_:WeakRef,"%WeakSet%":typeof WeakSet>"u"?_:WeakSet};if(j)try{null.error}catch(me){var Y=j(j(me));W["%Error.prototype%"]=Y}var Q=function me(ee){var de;if(ee==="%AsyncFunction%")de=$("async function () {}");else if(ee==="%GeneratorFunction%")de=$("function* () {}");else if(ee==="%AsyncGeneratorFunction%")de=$("async function* () {}");else if(ee==="%AsyncGenerator%"){var le=me("%AsyncGeneratorFunction%");le&&(de=le.prototype)}else if(ee==="%AsyncIteratorPrototype%"){var pe=me("%AsyncGenerator%");pe&&j&&(de=j(pe.prototype))}return W[ee]=de,de},K={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},X=requireFunctionBind(),ie=requireHasown(),ne=X.call(Function.call,Array.prototype.concat),oe=X.call(Function.apply,Array.prototype.splice),te=X.call(Function.call,String.prototype.replace),ce=X.call(Function.call,String.prototype.slice),re=X.call(Function.call,RegExp.prototype.exec),Te=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,be=/\\(\\)?/g,he=function(ee){var de=ce(ee,0,1),le=ce(ee,-1);if(de==="%"&&le!=="%")throw new O("invalid intrinsic syntax, expected closing `%`");if(le==="%"&&de!=="%")throw new O("invalid intrinsic syntax, expected opening `%`");var pe=[];return te(ee,Te,function(ye,Re,fe,Ee){pe[pe.length]=fe?te(Ee,be,"$1"):Re||ye}),pe},$e=function(ee,de){var le=ee,pe;if(ie(K,le)&&(pe=K[le],le="%"+pe[0]+"%"),ie(W,le)){var ye=W[le];if(ye===D&&(ye=Q(le)),typeof ye>"u"&&!de)throw new A("intrinsic "+ee+" exists, but is not available. Please file an issue!");return{alias:pe,name:le,value:ye}}throw new O("intrinsic "+ee+" does not exist!")};return getIntrinsic=function(ee,de){if(typeof ee!="string"||ee.length===0)throw new A("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof de!="boolean")throw new A('"allowMissing" argument must be a boolean');if(re(/^%?[^%]*%?$/,ee)===null)throw new O("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var le=he(ee),pe=le.length>0?le[0]:"",ye=$e("%"+pe+"%",de),Re=ye.name,fe=ye.value,Ee=!1,Le=ye.alias;Le&&(pe=Le[0],oe(le,ne([0,1],Le)));for(var De=1,ve=!0;De<le.length;De+=1){var Se=le[De],we=ce(Se,0,1),Ce=ce(Se,-1);if((we==='"'||we==="'"||we==="`"||Ce==='"'||Ce==="'"||Ce==="`")&&we!==Ce)throw new O("property names with quotes must have matching quotes");if((Se==="constructor"||!ve)&&(Ee=!0),pe+="."+Se,Re="%"+pe+"%",ie(W,Re))fe=W[Re];else if(fe!=null){if(!(Se in fe)){if(!de)throw new A("base intrinsic for "+ee+" exists, but the property is not available.");return}if(M&&De+1>=le.length){var ke=M(fe,Se);ve=!!ke,ve&&"get"in ke&&!("originalValue"in ke.get)?fe=ke.get:fe=fe[Se]}else ve=ie(fe,Se),fe=fe[Se];ve&&!Ee&&(W[Re]=fe)}}return fe},getIntrinsic}var callBind={exports:{}},esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(hasRequiredEsDefineProperty)return esDefineProperty;hasRequiredEsDefineProperty=1;var _=requireGetIntrinsic(),m=_("%Object.defineProperty%",!0)||!1;if(m)try{m({},"a",{value:1})}catch{m=!1}return esDefineProperty=m,esDefineProperty}var gopd,hasRequiredGopd;function requireGopd(){if(hasRequiredGopd)return gopd;hasRequiredGopd=1;var _=requireGetIntrinsic(),m=_("%Object.getOwnPropertyDescriptor%",!0);if(m)try{m([],"length")}catch{m=null}return gopd=m,gopd}var defineDataProperty,hasRequiredDefineDataProperty;function requireDefineDataProperty(){if(hasRequiredDefineDataProperty)return defineDataProperty;hasRequiredDefineDataProperty=1;var _=requireEsDefineProperty(),m=requireSyntax(),S=requireType(),T=requireGopd();return defineDataProperty=function(O,A,C){if(!O||typeof O!="object"&&typeof O!="function")throw new S("`obj` must be an object or a function`");if(typeof A!="string"&&typeof A!="symbol")throw new S("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new S("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new S("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new S("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new S("`loose`, if provided, must be a boolean");var k=arguments.length>3?arguments[3]:null,$=arguments.length>4?arguments[4]:null,M=arguments.length>5?arguments[5]:null,P=arguments.length>6?arguments[6]:!1,U=!!T&&T(O,A);if(_)_(O,A,{configurable:M===null&&U?U.configurable:!M,enumerable:k===null&&U?U.enumerable:!k,value:C,writable:$===null&&U?U.writable:!$});else if(P||!k&&!$&&!M)O[A]=C;else throw new m("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},defineDataProperty}var hasPropertyDescriptors_1,hasRequiredHasPropertyDescriptors;function requireHasPropertyDescriptors(){if(hasRequiredHasPropertyDescriptors)return hasPropertyDescriptors_1;hasRequiredHasPropertyDescriptors=1;var _=requireEsDefineProperty(),m=function(){return!!_};return m.hasArrayLengthDefineBug=function(){if(!_)return null;try{return _([],"length",{value:1}).length!==1}catch{return!0}},hasPropertyDescriptors_1=m,hasPropertyDescriptors_1}var setFunctionLength,hasRequiredSetFunctionLength;function requireSetFunctionLength(){if(hasRequiredSetFunctionLength)return setFunctionLength;hasRequiredSetFunctionLength=1;var _=requireGetIntrinsic(),m=requireDefineDataProperty(),S=requireHasPropertyDescriptors()(),T=requireGopd(),v=requireType(),O=_("%Math.floor%");return setFunctionLength=function(C,k){if(typeof C!="function")throw new v("`fn` is not a function");if(typeof k!="number"||k<0||k>4294967295||O(k)!==k)throw new v("`length` must be a positive 32-bit integer");var $=arguments.length>2&&!!arguments[2],M=!0,P=!0;if("length"in C&&T){var U=T(C,"length");U&&!U.configurable&&(M=!1),U&&!U.writable&&(P=!1)}return(M||P||!$)&&(S?m(C,"length",k,!0,!0):m(C,"length",k)),C},setFunctionLength}var hasRequiredCallBind;function requireCallBind(){return hasRequiredCallBind||(hasRequiredCallBind=1,function(_){var m=requireFunctionBind(),S=requireGetIntrinsic(),T=requireSetFunctionLength(),v=requireType(),O=S("%Function.prototype.apply%"),A=S("%Function.prototype.call%"),C=S("%Reflect.apply%",!0)||m.call(A,O),k=requireEsDefineProperty(),$=S("%Math.max%");_.exports=function(U){if(typeof U!="function")throw new v("a function is required");var N=C(m,A,arguments);return T(N,1+$(0,U.length-(arguments.length-1)),!0)};var M=function(){return C(m,O,arguments)};k?k(_.exports,"apply",{value:M}):_.exports.apply=M}(callBind)),callBind.exports}var callBound,hasRequiredCallBound;function requireCallBound(){if(hasRequiredCallBound)return callBound;hasRequiredCallBound=1;var _=requireGetIntrinsic(),m=requireCallBind(),S=m(_("String.prototype.indexOf"));return callBound=function(v,O){var A=_(v,!!O);return typeof A=="function"&&S(v,".prototype.")>-1?m(A):A},callBound}const _nodeResolve_empty={},_nodeResolve_empty$1={__proto__:null,default:_nodeResolve_empty},require$$0=getAugmentedNamespace(_nodeResolve_empty$1);var objectInspect,hasRequiredObjectInspect;function requireObjectInspect(){if(hasRequiredObjectInspect)return objectInspect;hasRequiredObjectInspect=1;var _=typeof Map=="function"&&Map.prototype,m=Object.getOwnPropertyDescriptor&&_?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,S=_&&m&&typeof m.get=="function"?m.get:null,T=_&&Map.prototype.forEach,v=typeof Set=="function"&&Set.prototype,O=Object.getOwnPropertyDescriptor&&v?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,A=v&&O&&typeof O.get=="function"?O.get:null,C=v&&Set.prototype.forEach,k=typeof WeakMap=="function"&&WeakMap.prototype,$=k?WeakMap.prototype.has:null,M=typeof WeakSet=="function"&&WeakSet.prototype,P=M?WeakSet.prototype.has:null,U=typeof WeakRef=="function"&&WeakRef.prototype,N=U?WeakRef.prototype.deref:null,B=Boolean.prototype.valueOf,j=Object.prototype.toString,D=Function.prototype.toString,q=String.prototype.match,W=String.prototype.slice,Y=String.prototype.replace,Q=String.prototype.toUpperCase,K=String.prototype.toLowerCase,X=RegExp.prototype.test,ie=Array.prototype.concat,ne=Array.prototype.join,oe=Array.prototype.slice,te=Math.floor,ce=typeof BigInt=="function"?BigInt.prototype.valueOf:null,re=Object.getOwnPropertySymbols,Te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,be=typeof Symbol=="function"&&typeof Symbol.iterator=="object",he=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===be||!0)?Symbol.toStringTag:null,$e=Object.prototype.propertyIsEnumerable,me=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(z){return z.__proto__}:null);function ee(z,Z){if(z===1/0||z===-1/0||z!==z||z&&z>-1e3&&z<1e3||X.call(/e/,Z))return Z;var ae=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof z=="number"){var ue=z<0?-te(-z):te(z);if(ue!==z){var ge=String(ue),se=W.call(Z,ge.length+1);return Y.call(ge,ae,"$&_")+"."+Y.call(Y.call(se,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Y.call(Z,ae,"$&_")}var de=require$$0,le=de.custom,pe=Ce(le)?le:null;objectInspect=function z(Z,ae,ue,ge){var se=ae||{};if(Oe(se,"quoteStyle")&&se.quoteStyle!=="single"&&se.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Oe(se,"maxStringLength")&&(typeof se.maxStringLength=="number"?se.maxStringLength<0&&se.maxStringLength!==1/0:se.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var xe=Oe(se,"customInspect")?se.customInspect:!0;if(typeof xe!="boolean"&&xe!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Oe(se,"indent")&&se.indent!==null&&se.indent!=="	"&&!(parseInt(se.indent,10)===se.indent&&se.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Oe(se,"numericSeparator")&&typeof se.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Me=se.numericSeparator;if(typeof Z>"u")return"undefined";if(Z===null)return"null";if(typeof Z=="boolean")return Z?"true":"false";if(typeof Z=="string")return tt(Z,se);if(typeof Z=="number"){if(Z===0)return 1/0/Z>0?"0":"-0";var _e=String(Z);return Me?ee(Z,_e):_e}if(typeof Z=="bigint"){var Fe=String(Z)+"n";return Me?ee(Z,Fe):Fe}var Ze=typeof se.depth>"u"?5:se.depth;if(typeof ue>"u"&&(ue=0),ue>=Ze&&Ze>0&&typeof Z=="object")return fe(Z)?"[Array]":"[Object]";var Pe=_t(se,ue);if(typeof ge>"u")ge=[];else if(et(ge,Z)>=0)return"[Circular]";function Ae(Ne,He,Et){if(He&&(ge=oe.call(ge),ge.push(He)),Et){var ut={depth:se.depth};return Oe(se,"quoteStyle")&&(ut.quoteStyle=se.quoteStyle),z(Ne,ut,ue+1,ge)}return z(Ne,se,ue+1,ge)}if(typeof Z=="function"&&!Le(Z)){var nt=ht(Z),it=qe(Z,Ae);return"[Function"+(nt?": "+nt:" (anonymous)")+"]"+(it.length>0?" { "+ne.call(it,", ")+" }":"")}if(Ce(Z)){var st=be?Y.call(String(Z),/^(Symbol\(.*\))_[^)]*$/,"$1"):Te.call(Z);return typeof Z=="object"&&!be?Ue(st):st}if(St(Z)){for(var Be="<"+K.call(String(Z.nodeName)),Ge=Z.attributes||[],We=0;We<Ge.length;We++)Be+=" "+Ge[We].name+"="+ye(Re(Ge[We].value),"double",se);return Be+=">",Z.childNodes&&Z.childNodes.length&&(Be+="..."),Be+="</"+K.call(String(Z.nodeName))+">",Be}if(fe(Z)){if(Z.length===0)return"[]";var Ye=qe(Z,Ae);return Pe&&!wt(Ye)?"["+ze(Ye,Pe)+"]":"[ "+ne.call(Ye,", ")+" ]"}if(De(Z)){var Je=qe(Z,Ae);return!("cause"in Error.prototype)&&"cause"in Z&&!$e.call(Z,"cause")?"{ ["+String(Z)+"] "+ne.call(ie.call("[cause]: "+Ae(Z.cause),Je),", ")+" }":Je.length===0?"["+String(Z)+"]":"{ ["+String(Z)+"] "+ne.call(Je,", ")+" }"}if(typeof Z=="object"&&xe){if(pe&&typeof Z[pe]=="function"&&de)return de(Z,{depth:Ze-ue});if(xe!=="symbol"&&typeof Z.inspect=="function")return Z.inspect()}if(ft(Z)){var ot=[];return T&&T.call(Z,function(Ne,He){ot.push(Ae(He,Z,!0)+" => "+Ae(Ne,Z))}),rt("Map",S.call(Z),ot,Pe)}if(mt(Z)){var at=[];return C&&C.call(Z,function(Ne){at.push(Ae(Ne,Z))}),rt("Set",A.call(Z),at,Pe)}if(pt(Z))return Ve("WeakMap");if(yt(Z))return Ve("WeakSet");if(gt(Z))return Ve("WeakRef");if(Se(Z))return Ue(Ae(Number(Z)));if(ke(Z))return Ue(Ae(ce.call(Z)));if(we(Z))return Ue(B.call(Z));if(ve(Z))return Ue(Ae(String(Z)));if(typeof window<"u"&&Z===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Z===globalThis||typeof commonjsGlobal<"u"&&Z===commonjsGlobal)return"{ [object globalThis] }";if(!Ee(Z)&&!Le(Z)){var Ke=qe(Z,Ae),lt=me?me(Z)===Object.prototype:Z instanceof Object||Z.constructor===Object,Qe=Z instanceof Object?"":"null prototype",ct=!lt&&he&&Object(Z)===Z&&he in Z?W.call(Ie(Z),8,-1):Qe?"Object":"",Tt=lt||typeof Z.constructor!="function"?"":Z.constructor.name?Z.constructor.name+" ":"",Xe=Tt+(ct||Qe?"["+ne.call(ie.call([],ct||[],Qe||[]),": ")+"] ":"");return Ke.length===0?Xe+"{}":Pe?Xe+"{"+ze(Ke,Pe)+"}":Xe+"{ "+ne.call(Ke,", ")+" }"}return String(Z)};function ye(z,Z,ae){var ue=(ae.quoteStyle||Z)==="double"?'"':"'";return ue+z+ue}function Re(z){return Y.call(String(z),/"/g,"&quot;")}function fe(z){return Ie(z)==="[object Array]"&&(!he||!(typeof z=="object"&&he in z))}function Ee(z){return Ie(z)==="[object Date]"&&(!he||!(typeof z=="object"&&he in z))}function Le(z){return Ie(z)==="[object RegExp]"&&(!he||!(typeof z=="object"&&he in z))}function De(z){return Ie(z)==="[object Error]"&&(!he||!(typeof z=="object"&&he in z))}function ve(z){return Ie(z)==="[object String]"&&(!he||!(typeof z=="object"&&he in z))}function Se(z){return Ie(z)==="[object Number]"&&(!he||!(typeof z=="object"&&he in z))}function we(z){return Ie(z)==="[object Boolean]"&&(!he||!(typeof z=="object"&&he in z))}function Ce(z){if(be)return z&&typeof z=="object"&&z instanceof Symbol;if(typeof z=="symbol")return!0;if(!z||typeof z!="object"||!Te)return!1;try{return Te.call(z),!0}catch{}return!1}function ke(z){if(!z||typeof z!="object"||!ce)return!1;try{return ce.call(z),!0}catch{}return!1}var je=Object.prototype.hasOwnProperty||function(z){return z in this};function Oe(z,Z){return je.call(z,Z)}function Ie(z){return j.call(z)}function ht(z){if(z.name)return z.name;var Z=q.call(D.call(z),/^function\s*([\w$]+)/);return Z?Z[1]:null}function et(z,Z){if(z.indexOf)return z.indexOf(Z);for(var ae=0,ue=z.length;ae<ue;ae++)if(z[ae]===Z)return ae;return-1}function ft(z){if(!S||!z||typeof z!="object")return!1;try{S.call(z);try{A.call(z)}catch{return!0}return z instanceof Map}catch{}return!1}function pt(z){if(!$||!z||typeof z!="object")return!1;try{$.call(z,$);try{P.call(z,P)}catch{return!0}return z instanceof WeakMap}catch{}return!1}function gt(z){if(!N||!z||typeof z!="object")return!1;try{return N.call(z),!0}catch{}return!1}function mt(z){if(!A||!z||typeof z!="object")return!1;try{A.call(z);try{S.call(z)}catch{return!0}return z instanceof Set}catch{}return!1}function yt(z){if(!P||!z||typeof z!="object")return!1;try{P.call(z,P);try{$.call(z,$)}catch{return!0}return z instanceof WeakSet}catch{}return!1}function St(z){return!z||typeof z!="object"?!1:typeof HTMLElement<"u"&&z instanceof HTMLElement?!0:typeof z.nodeName=="string"&&typeof z.getAttribute=="function"}function tt(z,Z){if(z.length>Z.maxStringLength){var ae=z.length-Z.maxStringLength,ue="... "+ae+" more character"+(ae>1?"s":"");return tt(W.call(z,0,Z.maxStringLength),Z)+ue}var ge=Y.call(Y.call(z,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,bt);return ye(ge,"single",Z)}function bt(z){var Z=z.charCodeAt(0),ae={8:"b",9:"t",10:"n",12:"f",13:"r"}[Z];return ae?"\\"+ae:"\\x"+(Z<16?"0":"")+Q.call(Z.toString(16))}function Ue(z){return"Object("+z+")"}function Ve(z){return z+" { ? }"}function rt(z,Z,ae,ue){var ge=ue?ze(ae,ue):ne.call(ae,", ");return z+" ("+Z+") {"+ge+"}"}function wt(z){for(var Z=0;Z<z.length;Z++)if(et(z[Z],`
`)>=0)return!1;return!0}function _t(z,Z){var ae;if(z.indent==="	")ae="	";else if(typeof z.indent=="number"&&z.indent>0)ae=ne.call(Array(z.indent+1)," ");else return null;return{base:ae,prev:ne.call(Array(Z+1),ae)}}function ze(z,Z){if(z.length===0)return"";var ae=`
`+Z.prev+Z.base;return ae+ne.call(z,","+ae)+`
`+Z.prev}function qe(z,Z){var ae=fe(z),ue=[];if(ae){ue.length=z.length;for(var ge=0;ge<z.length;ge++)ue[ge]=Oe(z,ge)?Z(z[ge],z):""}var se=typeof re=="function"?re(z):[],xe;if(be){xe={};for(var Me=0;Me<se.length;Me++)xe["$"+se[Me]]=se[Me]}for(var _e in z)Oe(z,_e)&&(ae&&String(Number(_e))===_e&&_e<z.length||be&&xe["$"+_e]instanceof Symbol||(X.call(/[^\w$]/,_e)?ue.push(Z(_e,z)+": "+Z(z[_e],z)):ue.push(_e+": "+Z(z[_e],z))));if(typeof re=="function")for(var Fe=0;Fe<se.length;Fe++)$e.call(z,se[Fe])&&ue.push("["+Z(se[Fe])+"]: "+Z(z[se[Fe]],z));return ue}return objectInspect}var sideChannel,hasRequiredSideChannel;function requireSideChannel(){if(hasRequiredSideChannel)return sideChannel;hasRequiredSideChannel=1;var _=requireGetIntrinsic(),m=requireCallBound(),S=requireObjectInspect(),T=requireType(),v=_("%WeakMap%",!0),O=_("%Map%",!0),A=m("WeakMap.prototype.get",!0),C=m("WeakMap.prototype.set",!0),k=m("WeakMap.prototype.has",!0),$=m("Map.prototype.get",!0),M=m("Map.prototype.set",!0),P=m("Map.prototype.has",!0),U=function(D,q){for(var W=D,Y;(Y=W.next)!==null;W=Y)if(Y.key===q)return W.next=Y.next,Y.next=D.next,D.next=Y,Y},N=function(D,q){var W=U(D,q);return W&&W.value},B=function(D,q,W){var Y=U(D,q);Y?Y.value=W:D.next={key:q,next:D.next,value:W}},j=function(D,q){return!!U(D,q)};return sideChannel=function(){var q,W,Y,Q={assert:function(K){if(!Q.has(K))throw new T("Side channel does not contain "+S(K))},get:function(K){if(v&&K&&(typeof K=="object"||typeof K=="function")){if(q)return A(q,K)}else if(O){if(W)return $(W,K)}else if(Y)return N(Y,K)},has:function(K){if(v&&K&&(typeof K=="object"||typeof K=="function")){if(q)return k(q,K)}else if(O){if(W)return P(W,K)}else if(Y)return j(Y,K);return!1},set:function(K,X){v&&K&&(typeof K=="object"||typeof K=="function")?(q||(q=new v),C(q,K,X)):O?(W||(W=new O),M(W,K,X)):(Y||(Y={key:{},next:null}),B(Y,K,X))}};return Q},sideChannel}var formats,hasRequiredFormats;function requireFormats(){if(hasRequiredFormats)return formats;hasRequiredFormats=1;var _=String.prototype.replace,m=/%20/g,S={RFC1738:"RFC1738",RFC3986:"RFC3986"};return formats={default:S.RFC3986,formatters:{RFC1738:function(T){return _.call(T,m,"+")},RFC3986:function(T){return String(T)}},RFC1738:S.RFC1738,RFC3986:S.RFC3986},formats}var utils,hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;var _=requireFormats(),m=Object.prototype.hasOwnProperty,S=Array.isArray,T=function(){for(var D=[],q=0;q<256;++q)D.push("%"+((q<16?"0":"")+q.toString(16)).toUpperCase());return D}(),v=function(q){for(;q.length>1;){var W=q.pop(),Y=W.obj[W.prop];if(S(Y)){for(var Q=[],K=0;K<Y.length;++K)typeof Y[K]<"u"&&Q.push(Y[K]);W.obj[W.prop]=Q}}},O=function(q,W){for(var Y=W&&W.plainObjects?Object.create(null):{},Q=0;Q<q.length;++Q)typeof q[Q]<"u"&&(Y[Q]=q[Q]);return Y},A=function D(q,W,Y){if(!W)return q;if(typeof W!="object"){if(S(q))q.push(W);else if(q&&typeof q=="object")(Y&&(Y.plainObjects||Y.allowPrototypes)||!m.call(Object.prototype,W))&&(q[W]=!0);else return[q,W];return q}if(!q||typeof q!="object")return[q].concat(W);var Q=q;return S(q)&&!S(W)&&(Q=O(q,Y)),S(q)&&S(W)?(W.forEach(function(K,X){if(m.call(q,X)){var ie=q[X];ie&&typeof ie=="object"&&K&&typeof K=="object"?q[X]=D(ie,K,Y):q.push(K)}else q[X]=K}),q):Object.keys(W).reduce(function(K,X){var ie=W[X];return m.call(K,X)?K[X]=D(K[X],ie,Y):K[X]=ie,K},Q)},C=function(q,W){return Object.keys(W).reduce(function(Y,Q){return Y[Q]=W[Q],Y},q)},k=function(D,q,W){var Y=D.replace(/\+/g," ");if(W==="iso-8859-1")return Y.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(Y)}catch{return Y}},$=1024,M=function(q,W,Y,Q,K){if(q.length===0)return q;var X=q;if(typeof q=="symbol"?X=Symbol.prototype.toString.call(q):typeof q!="string"&&(X=String(q)),Y==="iso-8859-1")return escape(X).replace(/%u[0-9a-f]{4}/gi,function(Te){return"%26%23"+parseInt(Te.slice(2),16)+"%3B"});for(var ie="",ne=0;ne<X.length;ne+=$){for(var oe=X.length>=$?X.slice(ne,ne+$):X,te=[],ce=0;ce<oe.length;++ce){var re=oe.charCodeAt(ce);if(re===45||re===46||re===95||re===126||re>=48&&re<=57||re>=65&&re<=90||re>=97&&re<=122||K===_.RFC1738&&(re===40||re===41)){te[te.length]=oe.charAt(ce);continue}if(re<128){te[te.length]=T[re];continue}if(re<2048){te[te.length]=T[192|re>>6]+T[128|re&63];continue}if(re<55296||re>=57344){te[te.length]=T[224|re>>12]+T[128|re>>6&63]+T[128|re&63];continue}ce+=1,re=65536+((re&1023)<<10|oe.charCodeAt(ce)&1023),te[te.length]=T[240|re>>18]+T[128|re>>12&63]+T[128|re>>6&63]+T[128|re&63]}ie+=te.join("")}return ie},P=function(q){for(var W=[{obj:{o:q},prop:"o"}],Y=[],Q=0;Q<W.length;++Q)for(var K=W[Q],X=K.obj[K.prop],ie=Object.keys(X),ne=0;ne<ie.length;++ne){var oe=ie[ne],te=X[oe];typeof te=="object"&&te!==null&&Y.indexOf(te)===-1&&(W.push({obj:X,prop:oe}),Y.push(te))}return v(W),q},U=function(q){return Object.prototype.toString.call(q)==="[object RegExp]"},N=function(q){return!q||typeof q!="object"?!1:!!(q.constructor&&q.constructor.isBuffer&&q.constructor.isBuffer(q))},B=function(q,W){return[].concat(q,W)},j=function(q,W){if(S(q)){for(var Y=[],Q=0;Q<q.length;Q+=1)Y.push(W(q[Q]));return Y}return W(q)};return utils={arrayToObject:O,assign:C,combine:B,compact:P,decode:k,encode:M,isBuffer:N,isRegExp:U,maybeMap:j,merge:A},utils}var stringify_1,hasRequiredStringify;function requireStringify(){if(hasRequiredStringify)return stringify_1;hasRequiredStringify=1;var _=requireSideChannel(),m=requireUtils(),S=requireFormats(),T=Object.prototype.hasOwnProperty,v={brackets:function(D){return D+"[]"},comma:"comma",indices:function(D,q){return D+"["+q+"]"},repeat:function(D){return D}},O=Array.isArray,A=Array.prototype.push,C=function(j,D){A.apply(j,O(D)?D:[D])},k=Date.prototype.toISOString,$=S.default,M={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:m.encode,encodeValuesOnly:!1,format:$,formatter:S.formatters[$],indices:!1,serializeDate:function(D){return k.call(D)},skipNulls:!1,strictNullHandling:!1},P=function(D){return typeof D=="string"||typeof D=="number"||typeof D=="boolean"||typeof D=="symbol"||typeof D=="bigint"},U={},N=function j(D,q,W,Y,Q,K,X,ie,ne,oe,te,ce,re,Te,be,he,$e,me){for(var ee=D,de=me,le=0,pe=!1;(de=de.get(U))!==void 0&&!pe;){var ye=de.get(D);if(le+=1,typeof ye<"u"){if(ye===le)throw new RangeError("Cyclic object value");pe=!0}typeof de.get(U)>"u"&&(le=0)}if(typeof oe=="function"?ee=oe(q,ee):ee instanceof Date?ee=re(ee):W==="comma"&&O(ee)&&(ee=m.maybeMap(ee,function(Ie){return Ie instanceof Date?re(Ie):Ie})),ee===null){if(K)return ne&&!he?ne(q,M.encoder,$e,"key",Te):q;ee=""}if(P(ee)||m.isBuffer(ee)){if(ne){var Re=he?q:ne(q,M.encoder,$e,"key",Te);return[be(Re)+"="+be(ne(ee,M.encoder,$e,"value",Te))]}return[be(q)+"="+be(String(ee))]}var fe=[];if(typeof ee>"u")return fe;var Ee;if(W==="comma"&&O(ee))he&&ne&&(ee=m.maybeMap(ee,ne)),Ee=[{value:ee.length>0?ee.join(",")||null:void 0}];else if(O(oe))Ee=oe;else{var Le=Object.keys(ee);Ee=te?Le.sort(te):Le}var De=ie?q.replace(/\./g,"%2E"):q,ve=Y&&O(ee)&&ee.length===1?De+"[]":De;if(Q&&O(ee)&&ee.length===0)return ve+"[]";for(var Se=0;Se<Ee.length;++Se){var we=Ee[Se],Ce=typeof we=="object"&&typeof we.value<"u"?we.value:ee[we];if(!(X&&Ce===null)){var ke=ce&&ie?we.replace(/\./g,"%2E"):we,je=O(ee)?typeof W=="function"?W(ve,ke):ve:ve+(ce?"."+ke:"["+ke+"]");me.set(D,le);var Oe=_();Oe.set(U,me),C(fe,j(Ce,je,W,Y,Q,K,X,ie,W==="comma"&&he&&O(ee)?null:ne,oe,te,ce,re,Te,be,he,$e,Oe))}}return fe},B=function(D){if(!D)return M;if(typeof D.allowEmptyArrays<"u"&&typeof D.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof D.encodeDotInKeys<"u"&&typeof D.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(D.encoder!==null&&typeof D.encoder<"u"&&typeof D.encoder!="function")throw new TypeError("Encoder has to be a function.");var q=D.charset||M.charset;if(typeof D.charset<"u"&&D.charset!=="utf-8"&&D.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var W=S.default;if(typeof D.format<"u"){if(!T.call(S.formatters,D.format))throw new TypeError("Unknown format option provided.");W=D.format}var Y=S.formatters[W],Q=M.filter;(typeof D.filter=="function"||O(D.filter))&&(Q=D.filter);var K;if(D.arrayFormat in v?K=D.arrayFormat:"indices"in D?K=D.indices?"indices":"repeat":K=M.arrayFormat,"commaRoundTrip"in D&&typeof D.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var X=typeof D.allowDots>"u"?D.encodeDotInKeys===!0?!0:M.allowDots:!!D.allowDots;return{addQueryPrefix:typeof D.addQueryPrefix=="boolean"?D.addQueryPrefix:M.addQueryPrefix,allowDots:X,allowEmptyArrays:typeof D.allowEmptyArrays=="boolean"?!!D.allowEmptyArrays:M.allowEmptyArrays,arrayFormat:K,charset:q,charsetSentinel:typeof D.charsetSentinel=="boolean"?D.charsetSentinel:M.charsetSentinel,commaRoundTrip:D.commaRoundTrip,delimiter:typeof D.delimiter>"u"?M.delimiter:D.delimiter,encode:typeof D.encode=="boolean"?D.encode:M.encode,encodeDotInKeys:typeof D.encodeDotInKeys=="boolean"?D.encodeDotInKeys:M.encodeDotInKeys,encoder:typeof D.encoder=="function"?D.encoder:M.encoder,encodeValuesOnly:typeof D.encodeValuesOnly=="boolean"?D.encodeValuesOnly:M.encodeValuesOnly,filter:Q,format:W,formatter:Y,serializeDate:typeof D.serializeDate=="function"?D.serializeDate:M.serializeDate,skipNulls:typeof D.skipNulls=="boolean"?D.skipNulls:M.skipNulls,sort:typeof D.sort=="function"?D.sort:null,strictNullHandling:typeof D.strictNullHandling=="boolean"?D.strictNullHandling:M.strictNullHandling}};return stringify_1=function(j,D){var q=j,W=B(D),Y,Q;typeof W.filter=="function"?(Q=W.filter,q=Q("",q)):O(W.filter)&&(Q=W.filter,Y=Q);var K=[];if(typeof q!="object"||q===null)return"";var X=v[W.arrayFormat],ie=X==="comma"&&W.commaRoundTrip;Y||(Y=Object.keys(q)),W.sort&&Y.sort(W.sort);for(var ne=_(),oe=0;oe<Y.length;++oe){var te=Y[oe];W.skipNulls&&q[te]===null||C(K,N(q[te],te,X,ie,W.allowEmptyArrays,W.strictNullHandling,W.skipNulls,W.encodeDotInKeys,W.encode?W.encoder:null,W.filter,W.sort,W.allowDots,W.serializeDate,W.format,W.formatter,W.encodeValuesOnly,W.charset,ne))}var ce=K.join(W.delimiter),re=W.addQueryPrefix===!0?"?":"";return W.charsetSentinel&&(W.charset==="iso-8859-1"?re+="utf8=%26%2310003%3B&":re+="utf8=%E2%9C%93&"),ce.length>0?re+ce:""},stringify_1}var parse,hasRequiredParse;function requireParse(){if(hasRequiredParse)return parse;hasRequiredParse=1;var _=requireUtils(),m=Object.prototype.hasOwnProperty,S=Array.isArray,T={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:_.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},v=function(U){return U.replace(/&#(\d+);/g,function(N,B){return String.fromCharCode(parseInt(B,10))})},O=function(U,N){return U&&typeof U=="string"&&N.comma&&U.indexOf(",")>-1?U.split(","):U},A="utf8=%26%2310003%3B",C="utf8=%E2%9C%93",k=function(N,B){var j={__proto__:null},D=B.ignoreQueryPrefix?N.replace(/^\?/,""):N;D=D.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var q=B.parameterLimit===1/0?void 0:B.parameterLimit,W=D.split(B.delimiter,q),Y=-1,Q,K=B.charset;if(B.charsetSentinel)for(Q=0;Q<W.length;++Q)W[Q].indexOf("utf8=")===0&&(W[Q]===C?K="utf-8":W[Q]===A&&(K="iso-8859-1"),Y=Q,Q=W.length);for(Q=0;Q<W.length;++Q)if(Q!==Y){var X=W[Q],ie=X.indexOf("]="),ne=ie===-1?X.indexOf("="):ie+1,oe,te;ne===-1?(oe=B.decoder(X,T.decoder,K,"key"),te=B.strictNullHandling?null:""):(oe=B.decoder(X.slice(0,ne),T.decoder,K,"key"),te=_.maybeMap(O(X.slice(ne+1),B),function(re){return B.decoder(re,T.decoder,K,"value")})),te&&B.interpretNumericEntities&&K==="iso-8859-1"&&(te=v(te)),X.indexOf("[]=")>-1&&(te=S(te)?[te]:te);var ce=m.call(j,oe);ce&&B.duplicates==="combine"?j[oe]=_.combine(j[oe],te):(!ce||B.duplicates==="last")&&(j[oe]=te)}return j},$=function(U,N,B,j){for(var D=j?N:O(N,B),q=U.length-1;q>=0;--q){var W,Y=U[q];if(Y==="[]"&&B.parseArrays)W=B.allowEmptyArrays&&(D===""||B.strictNullHandling&&D===null)?[]:[].concat(D);else{W=B.plainObjects?Object.create(null):{};var Q=Y.charAt(0)==="["&&Y.charAt(Y.length-1)==="]"?Y.slice(1,-1):Y,K=B.decodeDotInKeys?Q.replace(/%2E/g,"."):Q,X=parseInt(K,10);!B.parseArrays&&K===""?W={0:D}:!isNaN(X)&&Y!==K&&String(X)===K&&X>=0&&B.parseArrays&&X<=B.arrayLimit?(W=[],W[X]=D):K!=="__proto__"&&(W[K]=D)}D=W}return D},M=function(N,B,j,D){if(N){var q=j.allowDots?N.replace(/\.([^.[]+)/g,"[$1]"):N,W=/(\[[^[\]]*])/,Y=/(\[[^[\]]*])/g,Q=j.depth>0&&W.exec(q),K=Q?q.slice(0,Q.index):q,X=[];if(K){if(!j.plainObjects&&m.call(Object.prototype,K)&&!j.allowPrototypes)return;X.push(K)}for(var ie=0;j.depth>0&&(Q=Y.exec(q))!==null&&ie<j.depth;){if(ie+=1,!j.plainObjects&&m.call(Object.prototype,Q[1].slice(1,-1))&&!j.allowPrototypes)return;X.push(Q[1])}if(Q){if(j.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+j.depth+" and strictDepth is true");X.push("["+q.slice(Q.index)+"]")}return $(X,B,j,D)}},P=function(N){if(!N)return T;if(typeof N.allowEmptyArrays<"u"&&typeof N.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof N.decodeDotInKeys<"u"&&typeof N.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(N.decoder!==null&&typeof N.decoder<"u"&&typeof N.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof N.charset<"u"&&N.charset!=="utf-8"&&N.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var B=typeof N.charset>"u"?T.charset:N.charset,j=typeof N.duplicates>"u"?T.duplicates:N.duplicates;if(j!=="combine"&&j!=="first"&&j!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var D=typeof N.allowDots>"u"?N.decodeDotInKeys===!0?!0:T.allowDots:!!N.allowDots;return{allowDots:D,allowEmptyArrays:typeof N.allowEmptyArrays=="boolean"?!!N.allowEmptyArrays:T.allowEmptyArrays,allowPrototypes:typeof N.allowPrototypes=="boolean"?N.allowPrototypes:T.allowPrototypes,allowSparse:typeof N.allowSparse=="boolean"?N.allowSparse:T.allowSparse,arrayLimit:typeof N.arrayLimit=="number"?N.arrayLimit:T.arrayLimit,charset:B,charsetSentinel:typeof N.charsetSentinel=="boolean"?N.charsetSentinel:T.charsetSentinel,comma:typeof N.comma=="boolean"?N.comma:T.comma,decodeDotInKeys:typeof N.decodeDotInKeys=="boolean"?N.decodeDotInKeys:T.decodeDotInKeys,decoder:typeof N.decoder=="function"?N.decoder:T.decoder,delimiter:typeof N.delimiter=="string"||_.isRegExp(N.delimiter)?N.delimiter:T.delimiter,depth:typeof N.depth=="number"||N.depth===!1?+N.depth:T.depth,duplicates:j,ignoreQueryPrefix:N.ignoreQueryPrefix===!0,interpretNumericEntities:typeof N.interpretNumericEntities=="boolean"?N.interpretNumericEntities:T.interpretNumericEntities,parameterLimit:typeof N.parameterLimit=="number"?N.parameterLimit:T.parameterLimit,parseArrays:N.parseArrays!==!1,plainObjects:typeof N.plainObjects=="boolean"?N.plainObjects:T.plainObjects,strictDepth:typeof N.strictDepth=="boolean"?!!N.strictDepth:T.strictDepth,strictNullHandling:typeof N.strictNullHandling=="boolean"?N.strictNullHandling:T.strictNullHandling}};return parse=function(U,N){var B=P(N);if(U===""||U===null||typeof U>"u")return B.plainObjects?Object.create(null):{};for(var j=typeof U=="string"?k(U,B):U,D=B.plainObjects?Object.create(null):{},q=Object.keys(j),W=0;W<q.length;++W){var Y=q[W],Q=M(Y,j[Y],B,typeof U=="string");D=_.merge(D,Q,B)}return B.allowSparse===!0?D:_.compact(D)},parse}var lib,hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1;var _=requireStringify(),m=requireParse(),S=requireFormats();return lib={formats:S,parse:m,stringify:_},lib}var libExports=requireLib();const d=getDefaultExportFromCjs(libExports);let L$1=class{#e;#t;#r;#n;_logger=null;#i="";constructor(m,S,T){this.#e=axios.create({baseURL:m,...T??{}}),this.#t=S,this.#r=new n$1,this.#n=new u$1}setLogger(m){this._logger=m,this.#r.setLogger(this.getLogger())}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}setRestrictionManagerParams(m){this.#r.params=m}getRestrictionManagerParams(){return this.#r.params}setLogTag(m){this.#i=m}clearLogTag(){this.#i=""}async batch(m,S=!0){const T=Array.isArray(m);let v=T?[]:{},O=0;const A=(C,k)=>{let $=null,M=null;if(Array.isArray(C)?($=C[0],M=C[1]):C.method&&($=C.method,M=C.params),$){O++;let P=$+"?"+d.stringify(M);T||Array.isArray(v)?v.push(P):v[k]=P}};return T?m.forEach((C,k)=>A(C,k)):Object.entries(m).forEach(([C,k])=>A(k,C)),O<1?Promise.resolve(new Result):this.call("batch",{halt:S?1:0,cmd:v}).then(C=>{const k=C.getData().result,$=T?[]:{},M=(B,j)=>{if(typeof k.result[j]<"u"||typeof k.result_error[j]<"u"){let D=B.split("?"),q=new AjaxResult({result:typeof k.result[j]<"u"?k.result[j]:{},error:k?.result_error[j]||void 0,total:k.result_total[j],next:k.result_next[j]},{method:D[0]||"",params:d.parse(D[1]||""),start:0},C.getStatus());T||Array.isArray($)?$.push(q):$[j]=q}};Array.isArray(v)?v.forEach((B,j)=>M(B,j)):Object.entries(v).forEach(([B,j])=>M(j,B));let P;const U=B=>new AjaxError({status:0,answerError:{error:B.getErrorMessages().join("; "),errorDescription:`batch ${B.getQuery().method}: ${d.stringify(B.getQuery().params,{encode:!1})}`},cause:B.getErrors().next().value}),N=new Result;if(T||Array.isArray($)){P=[];for(let B of $){if(B.getStatus()!==200||!B.isSuccess){const j=U(B);if(!S&&!B.isSuccess){N.addError(j);continue}return Promise.reject(j)}P.push(B.getData().result)}}else{P={};for(let B of Object.keys($)){let j=$[B];if(j.getStatus()!==200||!j.isSuccess){const D=U(j);if(!S&&!j.isSuccess){N.addError(D);continue}return Promise.reject(D)}P[B]=j.getData().result}}return N.setData(P),Promise.resolve(N)})}async call(m,S,T=0){let v=this.#t.getAuthData();return v===!1&&(v=await this.#t.refreshAuth()),await this.#r.check(),this.#e.post(this.#s(m),this.#o(v,S,T)).then(O=>{const A=O.data;return Promise.resolve({status:O.status,payload:A})},async O=>{let A={error:O?.code||0,errorDescription:O?.message||""};if(O instanceof AxiosError&&O.response&&O.response.data){const k=O.response.data;A={error:k.error,errorDescription:k.error_description}}const C=new AjaxError({status:O.response?.status||0,answerError:A,cause:O});return C.status===401&&["expired_token","invalid_token"].includes(C.answerError.error)?(this.getLogger().info(`refreshAuth >> ${C.answerError.error} >>>`),v=await this.#t.refreshAuth(),await this.#r.check(),this.#e.post(this.#s(m),this.#o(v,S,T)).then(async k=>{const $=k.data;return Promise.resolve({status:k.status,payload:$})},async k=>{let $={error:k?.code||0,errorDescription:k?.message||""};if(k instanceof AxiosError&&k.response&&k.response.data){const P=k.response.data;$={error:P.error,errorDescription:P.error_description}}const M=new AjaxError({status:k.response?.status||0,answerError:$,cause:k});return Promise.reject(M)})):Promise.reject(C)}).then(O=>{const A=new AjaxResult(O.payload,{method:m,params:S,start:T},O.status);return Promise.resolve(A)})}#o(m,S,T=0){let v=Object.assign({},S);return this.#i.length>0&&(v.logTag=this.#i),v[this.#n.getQueryStringParameterName()]=this.#n.getRequestId(),v[this.#n.getQueryStringSdkParameterName()]="0.1.0",v.data&&v.data.start&&delete v.data.start,m.refresh_token!=="hook"&&(v.auth=m.access_token),v.start=T,v}#s(m){return`${encodeURIComponent(m)}.json`}};class AbstractB24{static batchSize=50;_isInit=!1;_http=null;_logger=null;constructor(){this._isInit=!1}get isInit(){return this._isInit}async init(){return this._isInit=!0,Promise.resolve()}destroy(){}setLogger(m){this._logger=m,this.getHttpClient().setLogger(this.getLogger())}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}callMethod(m,S,T){return this.getHttpClient().call(m,S||{},T||0)}async callListMethod(m,S={},T=null,v=null){const O=new Result;return c$1.isFunction(T)&&T!==null&&T(0),this.callMethod(m,S,0).then(async A=>{let C=[],k;if(v!==null?k=A.getData().result[v]:k=A.getData().result,C=C.concat(k),A.isMore()){let $=A;for(;$=await $.getNext(this.getHttpClient()),$!==!1;){let M;if(v!==null?M=$.getData().result[v]:M=$.getData().result,C=C.concat(M),T){const P=$.getTotal();T(P>0?Math.round(100*C.length/P):100)}}}return O.setData(C),T&&T(100),Promise.resolve(O)})}async*fetchListMethod(m,S={},T="ID",v=null){S.order=S.order||{},S.filter=S.filter||{},S.start=-1;let O=`>${T}`;S.order[T]="ASC",S.filter[O]=0;do{let A=await this.callMethod(m,S,S.start),C;if(c$1.isNull(v)&&v!==null?C=A.getData().result[v]:C=A.getData().result,C.length===0||(yield C,C.length<AbstractB24.batchSize))break;const k=C[C.length-1];k&&T in k&&(S.filter[O]=k[T])}while(!0)}async callBatch(m,S=!0){return this.getHttpClient().batch(m,S)}chunkArray(m,S=50){const T=[];for(let v=0;v<m.length;v+=S){const O=m.slice(v,v+S);T.push(O)}return T}async callBatchByChunk(m,S=!0){const T=new Result,v=[],O=this.chunkArray(m,AbstractB24.batchSize);try{for(const A of O){const C=await this.callBatch(A,S);v.push(...C.getData())}}catch(A){return Promise.reject(A)}return Promise.resolve(T.setData(v))}getHttpClient(){if(!this.isInit||this._http===null)throw new Error("Http not init");return this._http}_getHttpOptions(){return null}_ensureInitialized(){if(!this._isInit)throw new Error("B24 not initialized")}}var B24LangList=(_=>(_.en="en",_.de="de",_.la="la",_.br="br",_.fr="fr",_.it="it",_.pl="pl",_.ru="ru",_.ua="ua",_.tr="tr",_.sc="sc",_.tc="tc",_.ja="ja",_.vn="vn",_.id="id",_.ms="ms",_.th="th",_.ar="ar",_))(B24LangList||{});const e=()=>({scrollWidth:Math.max(document.documentElement.scrollWidth,document.documentElement.offsetWidth),scrollHeight:Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight)});class t{static isInternalConstructing=!1;static instance=null;_defLocale=null;constructor(){if(!t.isInternalConstructing)throw new TypeError("FormatterNumber is not constructable");t.isInternalConstructing=!1}static getInstance(){return t.instance||(t.isInternalConstructing=!0,t.instance=new t),t.instance}setDefLocale(m){this._defLocale=m}format(m,S){let T;(typeof S>"u"||!c$1.isStringFilled(S))&&(S=c$1.isStringFilled(this._defLocale)?this._defLocale||"en":navigator?.language),Number.isInteger(m)?T=new Intl.NumberFormat(S,{minimumFractionDigits:0,maximumFractionDigits:0}):T=new Intl.NumberFormat(S,{minimumFractionDigits:2,maximumFractionDigits:2});let v=T.format(m);return S.includes("ru")&&(v=v.replace(",",".")),v}}class IbanSpecification{countryCode;length;structure;example;_cachedRegex=null;constructor(m,S,T,v){this.countryCode=m,this.length=S,this.structure=T,this.example=v}isValid(m){return this.length===m.length&&this.countryCode===m.slice(0,2)&&this._regex().test(m.slice(4))&&this._iso7064Mod9710(this._iso13616Prepare(m))==1}toBBAN(m,S){return(this._regex().exec(m.slice(4)||"")||[]).slice(1).join(S)}fromBBAN(m){if(!this.isValidBBAN(m))throw new Error("Invalid BBAN");const S=("0"+(98-this._iso7064Mod9710(this._iso13616Prepare(this.countryCode+"00"+m)))).slice(-2);return this.countryCode+S+m}isValidBBAN(m){return this.length-4===m.length&&this._regex().test(m)}_regex(){return this._cachedRegex===null&&(this._cachedRegex=this._parseStructure(this.structure)),this._cachedRegex}_parseStructure(m){const S=(m.match(/(.{3})/g)||[]).map(T=>{let v;const O=T.slice(0,1),A=parseInt(T.slice(1),10);switch(O){case"A":v="0-9A-Za-z";break;case"B":v="0-9A-Z";break;case"C":v="A-Za-z";break;case"F":v="0-9";break;case"L":v="a-z";break;case"U":v="A-Z";break;case"W":v="0-9a-z";break}return"(["+v+"]{"+A+"})"});return new RegExp("^"+S.join("")+"$")}_iso13616Prepare(m){return m=m.toUpperCase(),m=m.substring(4)+m.substring(0,4),m.split("").map(S=>{const T=S.charCodeAt(0);return T>=65&&T<=90?(T-65+10).toString():S}).join("")}_iso7064Mod9710(m){let S=m,T;for(;S.length>2;)T=S.slice(0,9),S=parseInt(T,10)%97+S.slice(T.length);return parseInt(S,10)%97}}class FormatterIban{static isInternalConstructing=!1;static instance=null;_countries;constructor(){if(!FormatterIban.isInternalConstructing)throw new TypeError("FormatterIban is not constructable");FormatterIban.isInternalConstructing=!1,this._countries=new Map}static getInstance(){return FormatterIban.instance||(FormatterIban.isInternalConstructing=!0,FormatterIban.instance=new FormatterIban),FormatterIban.instance}addSpecification(m){this._countries.set(m.countryCode,m)}isValid(m){if(!this._isString(m))return!1;m=this.electronicFormat(m);const S=m.slice(0,2);if(!this._countries.has(S))throw new Error(`No country with code ${S}`);let T=this._countries.get(S);return!!T&&T.isValid(m)}printFormat(m,S){typeof S>"u"&&(S=" ");const T=/(.{4})(?!$)/g;return this.electronicFormat(m).replace(T,"$1"+S)}electronicFormat(m){const S=/[^a-zA-Z0-9]/g;return m.replace(S,"").toUpperCase()}toBBAN(m,S){typeof S>"u"&&(S=" "),m=this.electronicFormat(m);const T=m.slice(0,2);if(!this._countries.has(T))throw new Error(`No country with code ${T}`);let v=this._countries.get(T);if(!v)throw new Error(`No country with code ${T}`);return v.toBBAN(m,S)}fromBBAN(m,S){if(!this._countries.has(m))throw new Error(`No country with code ${m}`);let T=this._countries.get(m);if(!T)throw new Error(`No country with code ${m}`);return T.fromBBAN(this.electronicFormat(S))}isValidBBAN(m,S){if(!this._isString(S))return!1;if(!this._countries.has(m))throw new Error(`No country with code ${m}`);let T=this._countries.get(m);return!!T&&T.isValidBBAN(this.electronicFormat(S))}_isString(m){return typeof m=="string"||m instanceof String}}const useFormatter=()=>{const _=t.getInstance(),m=FormatterIban.getInstance();return m.addSpecification(new IbanSpecification("AD",24,"F04F04A12","AD1200012030200359100100")),m.addSpecification(new IbanSpecification("AE",23,"F03F16","AE070331234567890123456")),m.addSpecification(new IbanSpecification("AL",28,"F08A16","AL47212110090000000235698741")),m.addSpecification(new IbanSpecification("AT",20,"F05F11","AT611904300234573201")),m.addSpecification(new IbanSpecification("AZ",28,"U04A20","AZ21NABZ00000000137010001944")),m.addSpecification(new IbanSpecification("BA",20,"F03F03F08F02","BA391290079401028494")),m.addSpecification(new IbanSpecification("BE",16,"F03F07F02","BE68539007547034")),m.addSpecification(new IbanSpecification("BG",22,"U04F04F02A08","BG80BNBG96611020345678")),m.addSpecification(new IbanSpecification("BH",22,"U04A14","BH67BMAG00001299123456")),m.addSpecification(new IbanSpecification("BR",29,"F08F05F10U01A01","BR9700360305000010009795493P1")),m.addSpecification(new IbanSpecification("BY",28,"A04F04A16","BY13NBRB3600900000002Z00AB00")),m.addSpecification(new IbanSpecification("CH",21,"F05A12","CH9300762011623852957")),m.addSpecification(new IbanSpecification("CR",22,"F04F14","CR72012300000171549015")),m.addSpecification(new IbanSpecification("CY",28,"F03F05A16","CY17002001280000001200527600")),m.addSpecification(new IbanSpecification("CZ",24,"F04F06F10","CZ6508000000192000145399")),m.addSpecification(new IbanSpecification("DE",22,"F08F10","DE89370400440532013000")),m.addSpecification(new IbanSpecification("DK",18,"F04F09F01","DK5000400440116243")),m.addSpecification(new IbanSpecification("DO",28,"U04F20","DO28BAGR00000001212453611324")),m.addSpecification(new IbanSpecification("EE",20,"F02F02F11F01","EE382200221020145685")),m.addSpecification(new IbanSpecification("EG",29,"F04F04F17","EG800002000156789012345180002")),m.addSpecification(new IbanSpecification("ES",24,"F04F04F01F01F10","ES9121000418450200051332")),m.addSpecification(new IbanSpecification("FI",18,"F06F07F01","FI2112345600000785")),m.addSpecification(new IbanSpecification("FO",18,"F04F09F01","FO6264600001631634")),m.addSpecification(new IbanSpecification("FR",27,"F05F05A11F02","FR1420041010050500013M02606")),m.addSpecification(new IbanSpecification("GB",22,"U04F06F08","GB29NWBK60161331926819")),m.addSpecification(new IbanSpecification("GE",22,"U02F16","GE29NB0000000101904917")),m.addSpecification(new IbanSpecification("GI",23,"U04A15","GI75NWBK000000007099453")),m.addSpecification(new IbanSpecification("GL",18,"F04F09F01","GL8964710001000206")),m.addSpecification(new IbanSpecification("GR",27,"F03F04A16","GR1601101250000000012300695")),m.addSpecification(new IbanSpecification("GT",28,"A04A20","GT82TRAJ01020000001210029690")),m.addSpecification(new IbanSpecification("HR",21,"F07F10","HR1210010051863000160")),m.addSpecification(new IbanSpecification("HU",28,"F03F04F01F15F01","HU42117730161111101800000000")),m.addSpecification(new IbanSpecification("IE",22,"U04F06F08","IE29AIBK93115212345678")),m.addSpecification(new IbanSpecification("IL",23,"F03F03F13","IL620108000000099999999")),m.addSpecification(new IbanSpecification("IS",26,"F04F02F06F10","IS140159260076545510730339")),m.addSpecification(new IbanSpecification("IT",27,"U01F05F05A12","IT60X0542811101000000123456")),m.addSpecification(new IbanSpecification("IQ",23,"U04F03A12","IQ98NBIQ850123456789012")),m.addSpecification(new IbanSpecification("JO",30,"A04F22","JO15AAAA1234567890123456789012")),m.addSpecification(new IbanSpecification("KW",30,"U04A22","KW81CBKU0000000000001234560101")),m.addSpecification(new IbanSpecification("KZ",20,"F03A13","KZ86125KZT5004100100")),m.addSpecification(new IbanSpecification("LB",28,"F04A20","LB62099900000001001901229114")),m.addSpecification(new IbanSpecification("LC",32,"U04F24","LC07HEMM000100010012001200013015")),m.addSpecification(new IbanSpecification("LI",21,"F05A12","LI21088100002324013AA")),m.addSpecification(new IbanSpecification("LT",20,"F05F11","LT121000011101001000")),m.addSpecification(new IbanSpecification("LU",20,"F03A13","LU280019400644750000")),m.addSpecification(new IbanSpecification("LV",21,"U04A13","LV80BANK0000435195001")),m.addSpecification(new IbanSpecification("MC",27,"F05F05A11F02","MC5811222000010123456789030")),m.addSpecification(new IbanSpecification("MD",24,"U02A18","MD24AG000225100013104168")),m.addSpecification(new IbanSpecification("ME",22,"F03F13F02","ME25505000012345678951")),m.addSpecification(new IbanSpecification("MK",19,"F03A10F02","MK07250120000058984")),m.addSpecification(new IbanSpecification("MR",27,"F05F05F11F02","MR1300020001010000123456753")),m.addSpecification(new IbanSpecification("MT",31,"U04F05A18","MT84MALT011000012345MTLCAST001S")),m.addSpecification(new IbanSpecification("MU",30,"U04F02F02F12F03U03","MU17BOMM0101101030300200000MUR")),m.addSpecification(new IbanSpecification("NL",18,"U04F10","NL91ABNA0417164300")),m.addSpecification(new IbanSpecification("NO",15,"F04F06F01","NO9386011117947")),m.addSpecification(new IbanSpecification("PK",24,"U04A16","PK36SCBL0000001123456702")),m.addSpecification(new IbanSpecification("PL",28,"F08F16","PL61109010140000071219812874")),m.addSpecification(new IbanSpecification("PS",29,"U04A21","PS92PALS000000000400123456702")),m.addSpecification(new IbanSpecification("PT",25,"F04F04F11F02","PT50000201231234567890154")),m.addSpecification(new IbanSpecification("QA",29,"U04A21","QA30AAAA123456789012345678901")),m.addSpecification(new IbanSpecification("RO",24,"U04A16","RO49AAAA1B31007593840000")),m.addSpecification(new IbanSpecification("RS",22,"F03F13F02","RS35260005601001611379")),m.addSpecification(new IbanSpecification("SA",24,"F02A18","SA0380000000608010167519")),m.addSpecification(new IbanSpecification("SC",31,"U04F04F16U03","SC18SSCB11010000000000001497USD")),m.addSpecification(new IbanSpecification("SE",24,"F03F16F01","SE4550000000058398257466")),m.addSpecification(new IbanSpecification("SI",19,"F05F08F02","SI56263300012039086")),m.addSpecification(new IbanSpecification("SK",24,"F04F06F10","SK3112000000198742637541")),m.addSpecification(new IbanSpecification("SM",27,"U01F05F05A12","SM86U0322509800000000270100")),m.addSpecification(new IbanSpecification("ST",25,"F08F11F02","ST68000100010051845310112")),m.addSpecification(new IbanSpecification("SV",28,"U04F20","SV62CENR00000000000000700025")),m.addSpecification(new IbanSpecification("TL",23,"F03F14F02","TL380080012345678910157")),m.addSpecification(new IbanSpecification("TN",24,"F02F03F13F02","TN5910006035183598478831")),m.addSpecification(new IbanSpecification("TR",26,"F05F01A16","TR330006100519786457841326")),m.addSpecification(new IbanSpecification("UA",29,"F25","UA511234567890123456789012345")),m.addSpecification(new IbanSpecification("VA",22,"F18","VA59001123000012345678")),m.addSpecification(new IbanSpecification("VG",24,"U04F16","VG96VPVG0000012345678901")),m.addSpecification(new IbanSpecification("XK",20,"F04F10F02","XK051212012345678906")),m.addSpecification(new IbanSpecification("AO",25,"F21","AO69123456789012345678901")),m.addSpecification(new IbanSpecification("BF",27,"F23","BF2312345678901234567890123")),m.addSpecification(new IbanSpecification("BI",16,"F12","BI41123456789012")),m.addSpecification(new IbanSpecification("BJ",28,"F24","BJ39123456789012345678901234")),m.addSpecification(new IbanSpecification("CI",28,"U02F22","CI70CI1234567890123456789012")),m.addSpecification(new IbanSpecification("CM",27,"F23","CM9012345678901234567890123")),m.addSpecification(new IbanSpecification("CV",25,"F21","CV30123456789012345678901")),m.addSpecification(new IbanSpecification("DZ",24,"F20","DZ8612345678901234567890")),m.addSpecification(new IbanSpecification("IR",26,"F22","IR861234568790123456789012")),m.addSpecification(new IbanSpecification("MG",27,"F23","MG1812345678901234567890123")),m.addSpecification(new IbanSpecification("ML",28,"U01F23","ML15A12345678901234567890123")),m.addSpecification(new IbanSpecification("MZ",25,"F21","MZ25123456789012345678901")),m.addSpecification(new IbanSpecification("SN",28,"U01F23","SN52A12345678901234567890123")),m.addSpecification(new IbanSpecification("GF",27,"F05F05A11F02","GF121234512345123456789AB13")),m.addSpecification(new IbanSpecification("GP",27,"F05F05A11F02","GP791234512345123456789AB13")),m.addSpecification(new IbanSpecification("MQ",27,"F05F05A11F02","MQ221234512345123456789AB13")),m.addSpecification(new IbanSpecification("RE",27,"F05F05A11F02","RE131234512345123456789AB13")),m.addSpecification(new IbanSpecification("PF",27,"F05F05A11F02","PF281234512345123456789AB13")),m.addSpecification(new IbanSpecification("TF",27,"F05F05A11F02","TF891234512345123456789AB13")),m.addSpecification(new IbanSpecification("YT",27,"F05F05A11F02","YT021234512345123456789AB13")),m.addSpecification(new IbanSpecification("NC",27,"F05F05A11F02","NC551234512345123456789AB13")),m.addSpecification(new IbanSpecification("BL",27,"F05F05A11F02","BL391234512345123456789AB13")),m.addSpecification(new IbanSpecification("MF",27,"F05F05A11F02","MF551234512345123456789AB13")),m.addSpecification(new IbanSpecification("PM",27,"F05F05A11F02","PM071234512345123456789AB13")),m.addSpecification(new IbanSpecification("WF",27,"F05F05A11F02","WF621234512345123456789AB13")),{formatterNumber:_,formatterIban:m}};class AuthHookManager{#e;constructor(m){this.#e=Object.freeze(Object.assign({},m))}getAuthData(){const m=this.#e.b24Url.replaceAll("https://","").replaceAll("http://","").replace(/:(80|443)$/,"");return{access_token:this.#e.secret,refresh_token:"hook",expires_in:0,domain:m,member_id:m}}refreshAuth(){return Promise.resolve(this.getAuthData())}getUniq(m){const S=this.getAuthData();if(S===!1)throw new Error("AuthData not init");return[m,S.member_id].join("_")}getTargetOrigin(){return`${this.#e.b24Url}`}getTargetOriginWithPath(){return`${this.#e.b24Url}/rest/${this.#e.userId}/${this.#e.secret}`}get isAdmin(){return!0}}class B24Hook extends AbstractB24{#e;constructor(m){super(),this.#e=new AuthHookManager(m),this._http=new L$1(this.#e.getTargetOriginWithPath(),this.#e,this._getHttpOptions()),this._isInit=!0}setLogger(m){super.setLogger(m)}get auth(){return this.#e}getTargetOrigin(){return this._ensureInitialized(),this.#e.getTargetOrigin()}getTargetOriginWithPath(){return this._ensureInitialized(),this.#e.getTargetOriginWithPath()}}var MessageCommands=(_=>(_.getInitData="getInitData",_.setInstallFinish="setInstallFinish",_.setInstall="setInstall",_.refreshAuth="refreshAuth",_.setAppOption="setAppOption",_.setUserOption="setUserOption",_.resizeWindow="resizeWindow",_.reloadWindow="reloadWindow",_.setTitle="setTitle",_.setScroll="setScroll",_.openApplication="openApplication",_.closeApplication="closeApplication",_.openPath="openPath",_.imCallTo="imCallTo",_.imPhoneTo="imPhoneTo",_.imOpenMessenger="imOpenMessenger",_.imOpenHistory="imOpenHistory",_.selectUser="selectUser",_.selectAccess="selectAccess",_.selectCRM="selectCRM",_.showAppForm="showAppForm",_))(MessageCommands||{});class MessageManager{#e;#t;_logger=null;runCallbackHandler;constructor(m){this.#e=m,this.#t=new Map,this.runCallbackHandler=this._runCallback.bind(this)}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}subscribe(){window.addEventListener("message",this.runCallbackHandler)}unsubscribe(){window.removeEventListener("message",this.runCallbackHandler)}async send(m,S=null){return new Promise((T,v)=>{let O;const A={resolve:T,reject:v,timeoutId:null},C=this.#r(A);if(m.toString().indexOf(":")>=0)O={method:m.toString(),params:S||"",callback:C,appSid:this.#e.getAppSid()};else{O=m.toString();let k=[S?JSON.stringify(S):null,C,this.#e.getAppSid()];O+=":"+k.filter(Boolean).join(":")}this.getLogger().log(`send to ${this.#e.getTargetOrigin()}`,{cmd:O}),parent.postMessage(O,this.#e.getTargetOrigin()),S?.isSafely&&(this.#t.get(C).timeoutId=window.setTimeout(()=>{this.#t.has(C)&&(this.getLogger().warn(`Action ${m.toString()} stop by timeout`),this.#t.delete(C),T({isSafely:!0}))},parseInt(String(S?.safelyTime||900))))})}_runCallback(m){if(m.origin===this.#e.getTargetOrigin()&&m.data){this.getLogger().log(`get from ${m.origin}`,{data:m.data});let S=m.data.split(":");const T={id:S[0],args:S.slice(1).join(":")};if(T.args&&(T.args=JSON.parse(T.args)),this.#t.has(T.id)){const v=this.#t.get(T.id);v.timeoutId&&clearTimeout(v.timeoutId),this.#t.delete(T.id),v.resolve(T.args)}}}#r(m){let S=h$1.getUniqId();return this.#t.set(S,m),S}}class AppFrame{#e="";#t=!0;#r=null;#n=null;#i=null;constructor(m){m.DOMAIN&&(this.#e=m.DOMAIN,this.#e=this.#e.replace(/:(80|443)$/,"")),this.#t=m.PROTOCOL===!0,m.LANG&&(this.#i=m.LANG),m.APP_SID&&(this.#r=m.APP_SID)}initData(m){return this.#e||(this.#e=m.DOMAIN),this.#n||(this.#n=m.PATH),this.#i||(this.#i=m.LANG),this.#t=parseInt(m.PROTOCOL)===1,this.#e=this.#e.replace(/:(80|443)$/,""),this}getAppSid(){if(this.#r===null)throw new Error("Not init appSid");return this.#r}getTargetOrigin(){return`${this.#t?"https":"http"}://${this.#e}`}getTargetOriginWithPath(){return this.getTargetOrigin()+(this.#n??"")}getLang(){return this.#i||B24LangList.en}}class AuthManager{#e=null;#t=null;#r=0;#n=null;#i=!1;#o;#s;constructor(m,S){this.#o=m,this.#s=S}initData(m){return m.AUTH_ID&&(this.#e=m.AUTH_ID,this.#t=m.REFRESH_ID,this.#r=new Date().valueOf()+parseInt(m.AUTH_EXPIRES)*1e3,this.#i=m.IS_ADMIN,this.#n=m.MEMBER_ID||""),this}getAuthData(){return this.#r>new Date().valueOf()?{access_token:this.#e,refresh_token:this.#t,expires_in:this.#r,domain:this.#o.getTargetOrigin(),member_id:this.#n}:!1}async refreshAuth(){return this.#s.send(MessageCommands.refreshAuth,{}).then(m=>(this.#e=m.AUTH_ID,this.#t=m.REFRESH_ID,this.#r=new Date().valueOf()+parseInt(m.AUTH_EXPIRES)*1e3,Promise.resolve(this.getAuthData())))}getUniq(m){return[m,this.#n||""].join("_")}get isAdmin(){return this.#i}}class ParentManager{#e;constructor(m){this.#e=m}async closeApplication(){return this.#e.send(MessageCommands.closeApplication,{isSafely:!1})}fitWindow(){let m="100%",S=this.getScrollSize().scrollHeight;return this.#e.send(MessageCommands.resizeWindow,{width:m,height:S,isSafely:!0})}resizeWindow(m,S){return m>0&&S>0?this.#e.send(MessageCommands.resizeWindow,{width:m,height:S,isSafely:!0}):Promise.reject(new Error(`Wrong width:number = ${m} or height:number = ${S}`))}async resizeWindowAuto(m=null,S=0,T=0){const v=document.body;let O=Math.max(v.scrollWidth,v.offsetWidth);T>0&&(O=Math.max(T,O));let A=Math.max(v.scrollHeight,v.offsetHeight);return m&&(A=Math.max(m.scrollHeight,m.offsetHeight)),S>0&&(A=Math.max(S,A)),this.resizeWindow(O,A)}getScrollSize(){return e()}async scrollParentWindow(m){return Number.isInteger(m)?(m<0&&(m=0),this.#e.send(MessageCommands.setScroll,{scroll:m,isSafely:!0})):Promise.reject(new Error("Wrong scroll number"))}async reloadWindow(){return this.#e.send(MessageCommands.reloadWindow,{isSafely:!0})}async setTitle(m){return this.#e.send(MessageCommands.setTitle,{title:m.toString(),isSafely:!0})}async imCallTo(m,S=!0){return this.#e.send(MessageCommands.imCallTo,{userId:m,video:S,isSafely:!0})}async imPhoneTo(m){return this.#e.send(MessageCommands.imPhoneTo,{phone:m,isSafely:!0})}async imOpenMessenger(m){return this.#e.send(MessageCommands.imOpenMessenger,{dialogId:m,isSafely:!0})}async imOpenHistory(m){return this.#e.send(MessageCommands.imOpenHistory,{dialogId:m,isSafely:!0})}}let OptionsManager$1=class{#e;#t=null;#r=null;constructor(m){this.#e=m}initData(m){return m.APP_OPTIONS&&(this.#t=m.APP_OPTIONS),m.USER_OPTIONS&&(this.#r=m.USER_OPTIONS),this}appGet(m){if(this.#t&&this.#t[m])return this.#t[m];throw new Error(`app.option.${m} not set`)}async appSet(m,S){return this.#t||(this.#t=[]),this.#t[m]=S,this.#n(MessageCommands.setAppOption,m,this.#t[m])}userGet(m){if(this.#r&&this.#r[m])return this.#r[m];throw new Error(`user.option.${m} not set`)}async userSet(m,S){return this.#t||(this.#t=[]),this.#t[m]||(this.#t[m]=null),this.#r[m]=S,this.#n(MessageCommands.setUserOption,m,this.#r[m])}async#n(m,S,T){return this.#e.send(m,{name:S,value:T,isSafely:!0}).then(()=>Promise.resolve())}};class DialogManager{#e;constructor(m){this.#e=m}async selectUser(){return this.#e.send(MessageCommands.selectUser,{mult:!1})}async selectUsers(){return this.#e.send(MessageCommands.selectUser,{mult:!0})}async selectAccess(m=[]){return console.warn("@deprecated selectAccess"),this.#e.send(MessageCommands.selectAccess,{value:m})}async selectCRM(m){return console.warn("@deprecated selectCRM"),this.#e.send(MessageCommands.selectCRM,{entityType:m?.entityType,multiple:m?.multiple,value:m?.value})}}class SliderManager{#e;#t;constructor(m,S){this.#e=m,this.#t=S}getUrl(m="/"){return new URL(m,this.#e.getTargetOrigin())}getTargetOrigin(){return this.#e.getTargetOrigin()}async openSliderAppPage(m={}){return this.#t.send(MessageCommands.openApplication,m)}#r(m=1640){return m>0?m>1200&&m<=1640?"/crm/type/0/details/0/../../../../..":m>950&&m<=1200?"/company/personal/user/0/groups/create/../../../../../..":m>900&&m<=950?"/crm/company/requisite/0/../../../..":m<=900?"/workgroups/group/0/card/../../../..":"/crm/deal/../..":"/crm/deal/../.."}async openPath(m,S=1640){const T=new URL(m);return T.searchParams.set("IFRAME","Y"),T.searchParams.set("IFRAME_TYPE","SIDE_SLIDER"),this.#t.send(MessageCommands.openPath,{path:[this.#r(S),T.pathname,T.search].join("")}).then(v=>v?.result==="error"?v?.errorCode==="METHOD_NOT_SUPPORTED_ON_DEVICE"?new Promise((O,A)=>{const C=window.open(m,"_blank");if(!C){A(new Error("Error open window"));return}let k=0,$=1e3*60*5,M=window.setInterval(()=>{k=k+1,C.closed?(clearInterval(M),O({isOpenAtNewWindow:!0,isClose:!0})):k>$&&(clearInterval(M),O({isOpenAtNewWindow:!0,isClose:!1}))},1e3)}):Promise.reject(new Error(v?.errorCode)):v?.result==="close"?Promise.resolve({isOpenAtNewWindow:!1,isClose:!0}):Promise.resolve({isOpenAtNewWindow:!1,isClose:!1}))}async showAppForm(m){return console.warn("@deprecated showAppForm"),this.#t.send(MessageCommands.showAppForm,{params:m,isSafely:!0})}}class PlacementManager{#e="";#t={};constructor(){}initData(m){this.#e=m.PLACEMENT||"DEFAULT";const S=m.PLACEMENT_OPTIONS;return this.#t=Object.freeze(S),this}get title(){return this.#e}get isDefault(){return this.title==="DEFAULT"}get options(){return this.#t}get isSliderMode(){return this.options?.IFRAME==="Y"}}class B24Frame extends AbstractB24{#e=!1;#t=!1;#r;#n;#i;#o;#s;#l;#c;#a;constructor(m){super(),this.#r=new AppFrame(m),this.#n=new MessageManager(this.#r),this.#n.subscribe(),this.#i=new AuthManager(this.#r,this.#n),this.#o=new ParentManager(this.#n),this.#s=new OptionsManager$1(this.#n),this.#l=new DialogManager(this.#n),this.#c=new SliderManager(this.#r,this.#n),this.#a=new PlacementManager,this._isInit=!1}setLogger(m){super.setLogger(m),this.#n.setLogger(this.getLogger())}get isFirstRun(){return this._ensureInitialized(),this.#t}get isInstallMode(){return this._ensureInitialized(),this.#e}get parent(){return this._ensureInitialized(),this.#o}get auth(){return this._ensureInitialized(),this.#i}get slider(){return this._ensureInitialized(),this.#c}get placement(){return this._ensureInitialized(),this.#a}get options(){return this._ensureInitialized(),this.#s}get dialog(){return this._ensureInitialized(),this.#l}async init(){return this.#n.send(MessageCommands.getInitData,{}).then(m=>(this.getLogger().log("init data:",m),this.#r.initData(m),this.#i.initData(m),this.#a.initData(m),this.#s.initData(m),this.#e=m.INSTALL,this.#t=m.FIRST_RUN,this._http=new L$1(this.#r.getTargetOriginWithPath(),this.#i,this._getHttpOptions()),this.#t?this.#n.send(MessageCommands.setInstall,{install:!0}):(this._isInit=!0,Promise.resolve())))}destroy(){this.#n.unsubscribe(),super.destroy()}async installFinish(){return this.isInstallMode?this.#n.send(MessageCommands.setInstallFinish,{}):Promise.reject(new Error("Application was previously installed. You cannot call installFinish"))}getTargetOrigin(){return this._ensureInitialized(),this.#r.getTargetOrigin()}getTargetOriginWithPath(){return this._ensureInitialized(),this.#r.getTargetOriginWithPath()}getAppSid(){return this._ensureInitialized(),this.#r.getAppSid()}getLang(){return this._ensureInitialized(),this.#r.getLang()}}class UnhandledMatchError extends Error{constructor(m,...S){super(...S),this.name="UnhandledMatchError",this.message=`Unhandled match value of type ${m}`,this.stack=new Error().stack}}class AbstractHelper{_b24;_logger=null;_data=null;constructor(m){this._b24=m}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}async initData(m){return this.getLogger().log(m),Promise.reject(new Error("Rewrite this function"))}}class ProfileManager extends AbstractHelper{_data=null;async initData(m){this._data=m}get data(){if(this._data===null)throw new Error("ProfileManager.data not initialized");return this._data}}class AppManager extends AbstractHelper{_data=null;async initData(m){this._data=m}get data(){if(this._data===null)throw new Error("AppManager.data not initialized");return this._data}get statusCode(){return StatusDescriptions[this.data.status]||"Unknown status"}}class PaymentManager extends AbstractHelper{_data=null;async initData(m){this._data=m}get data(){if(this._data===null)throw new Error("PaymentManager.data not initialized");return this._data}}class LicenseManager extends AbstractHelper{_data=null;async initData(m){this._data=m,this.makeRestrictionManagerParams()}get data(){if(this._data===null)throw new Error("LicenseManager.data not initialized");return this._data}makeRestrictionManagerParams(){this.data?.license&&this.data.license.includes("ent")&&(this.getLogger().log(`LICENSE ${this.data.license} => up restriction manager params`,RestrictionManagerParamsForEnterprise),this._b24.getHttpClient().setRestrictionManagerParams(RestrictionManagerParamsForEnterprise))}}class CurrencyManager extends AbstractHelper{async initData(m){this._data={currencyBase:"?",currencyList:new Map},this.setBaseCurrency(m.currencyBase),this.setCurrencyList(m.currencyList);try{await this.loadData()}catch(S){throw console.error(S),new Error("Failed to load data")}}async loadData(){const m=this.currencyList.map(S=>({method:"crm.currency.get",params:{id:S}}));if(m.length<1)return Promise.resolve();try{(await this._b24.callBatchByChunk(m,!0)).getData().forEach(S=>{if(typeof S.LANG>"u")return;const T=S.CURRENCY,v=this.data.currencyList.get(T);typeof v>"u"||Object.entries(S.LANG).forEach(([O,A])=>{switch(v.lang[O]={decimals:parseInt(A.DECIMALS),decPoint:A.DEC_POINT,formatString:A.FORMAT_STRING,fullName:A.FULL_NAME,isHideZero:A.HIDE_ZERO==="Y",thousandsSep:A.THOUSANDS_SEP,thousandsVariant:A.THOUSANDS_VARIANT},v.lang[O].thousandsVariant){case"N":v.lang[O].thousandsSep="";break;case"D":v.lang[O].thousandsSep=".";break;case"C":v.lang[O].thousandsSep=",";break;case"S":v.lang[O].thousandsSep=" ";break;case"B":v.lang[O].thousandsSep="&nbsp;";break;case"OWN":default:c$1.isStringFilled(v.lang[O].thousandsSep)||(v.lang[O].thousandsSep=" ");break}})})}catch(S){console.error(S)}}get data(){if(this._data===null)throw new Error("CurrencyManager.data not initialized");return this._data}setBaseCurrency(m){this._data.currencyBase=m}get baseCurrency(){return this.data.currencyBase}setCurrencyList(m=[]){this.data.currencyList.clear(),m.forEach(S=>{this.data.currencyList.set(S.CURRENCY,{amount:parseFloat(S.CURRENCY),amountCnt:parseInt(S.AMOUNT_CNT),isBase:S.BASE==="Y",currencyCode:S.CURRENCY,dateUpdate:h$1.toDateTime(S.DATE_UPDATE),decimals:parseInt(S.DECIMALS),decPoint:S.DEC_POINT,formatString:S.FORMAT_STRING,fullName:S.FULL_NAME,lid:S.LID,sort:parseInt(S.SORT),thousandsSep:S?.THOUSANDS_SEP||null,lang:{}})})}getCurrencyFullName(m,S){const T=this.data.currencyList.get(m);if(typeof T>"u")throw new UnhandledMatchError(m);let v=T.fullName;if(!(typeof S>"u")){const O=T.lang[S];c$1.isUndefined(O)||(v=O.fullName)}return v}getCurrencyLiteral(m,S){const T=this.data.currencyList.get(m);if(typeof T>"u")throw new UnhandledMatchError(m);let v=T.formatString;if(!(typeof S>"u")){const O=T.lang[S];c$1.isUndefined(O)||(v=O.formatString)}return v.replaceAll("&#","&%").replaceAll("#","").replaceAll("&%","&#").trim()||""}get currencyList(){return Array.from(this.data.currencyList.keys())}format(m,S,T){const v=this.data.currencyList.get(S);if(typeof v>"u")throw new UnhandledMatchError(S);const O={formatString:v.formatString,decimals:v.decimals,decPoint:v.decPoint,thousandsSep:v.thousandsSep};c$1.isStringFilled(O.thousandsSep)||(O.thousandsSep="");const A=v.lang[T];return c$1.isUndefined(A)||(O.formatString=A.formatString,O.decimals=A.decimals,O.decPoint=A.decPoint,O.thousandsSep=A.thousandsSep),O.formatString.replaceAll("&#","&%").replace("#",h$1.numberFormat(m,O.decimals,O.decPoint,O.thousandsSep)).replaceAll("&%","&#")||""}}class OptionsManager extends AbstractHelper{_data;_type;static getSupportTypes(){return[TypeOption.NotSet,TypeOption.JsonArray,TypeOption.JsonObject,TypeOption.FloatVal,TypeOption.IntegerVal,TypeOption.BoolYN,TypeOption.StringVal]}static prepareArrayList(m){return c$1.isArray(m)?m:c$1.isObject(m)?Array.from(Object.values(m)):[]}constructor(m,S){super(m),this._type=S,this._data=new Map}get data(){return this._data}reset(){this.data.clear()}async initData(m){this.reset(),c$1.isObject(m)&&Object.entries(m).forEach(([S,T])=>{this.data.set(S,T)})}getJsonArray(m,S=[]){if(!this.data.has(m))return S;let T=this.data.get(m);try{T=JSON.parse(T),!c$1.isArray(T)&&!c$1.isObject(T)&&(T=S)}catch(v){this.getLogger().error(v),T=S}return OptionsManager.prepareArrayList(T)}getJsonObject(m,S={}){if(!this.data.has(m))return S;let T=this.data.get(m);try{T=JSON.parse(T)}catch(v){this.getLogger().error(v),T=S}return c$1.isObject(T)||(T=S),T}getFloat(m,S=0){return this.data.has(m)?h$1.toNumber(this.data.get(m)):S}getInteger(m,S=0){return this.data.has(m)?h$1.toInteger(this.data.get(m)):S}getBoolYN(m,S=!0){return this.data.has(m)?h$1.toBoolean(this.data.get(m)):S}getBoolNY(m,S=!1){return this.data.has(m)?h$1.toBoolean(this.data.get(m)):S}getString(m,S=""){return this.data.has(m)?this.data.get(m).toString():S}getDate(m,S=null){if(!this.data.has(m))return S;try{let T=h$1.toDateTime(this.data.get(m).toString());return T.isValid?T:S}catch{return S}}encode(m){return JSON.stringify(m)}decode(m,S){try{return m.length>0?JSON.parse(m):S}catch(T){this.getLogger().warn(T,m)}return S}getMethodSave(){switch(this._type){case"app":return"app.option.set";case"user":return"user.option.set"}}async save(m,S){const T=[];return T.push({method:this.getMethodSave(),params:{options:m}}),c$1.isObject(S)&&T.push({method:"pull.application.event.add",params:{COMMAND:S?.command,PARAMS:S?.params,MODULE_ID:S?.moduleId}}),this._b24.callBatch(T,!0)}}class StorageManager{_logger=null;userId;siteId;constructor(m={}){this.userId=m.userId?h$1.toInteger(m.userId):0,this.siteId=m.siteId?m.siteId:"none"}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}set(m,S){if(typeof window.localStorage>"u"){this.getLogger().error(new Error("undefined window.localStorage"));return}typeof S!="string"&&S&&(S=JSON.stringify(S)),window.localStorage.setItem(this._getKey(m),S)}get(m,S){if(typeof window.localStorage>"u")return S||null;const T=window.localStorage.getItem(this._getKey(m));return T===null?S||null:JSON.parse(T)}remove(m){if(typeof window.localStorage>"u"){this.getLogger().error(new Error("undefined window.localStorage"));return}return window.localStorage.removeItem(this._getKey(m))}_getKey(m){return`@bitrix24/b24jssdk-pull-${this.userId}-${this.siteId}-${m}`}compareKey(m,S){return m===this._getKey(S)}}class ErrorNotConnected extends Error{constructor(m){super(m),this.name="ErrorNotConnected"}}class ErrorTimeout extends Error{constructor(m){super(m),this.name="ErrorTimeout"}}const u="2.0";class JsonRpc{_logger=null;_connector;_idCounter=0;_handlers={};_rpcResponseAwaiters=new Map;constructor(m){if(this._connector=m.connector,c$1.isPlainObject(m.handlers))for(const S in m.handlers)this.handle(S,m.handlers[S])}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}handle(m,S){this._handlers[m]=S}async executeOutgoingRpcCommand(m,S,T=5){return new Promise((v,O)=>{const A=this.createRequest(m,S);this._connector.send(JSON.stringify(A))||O(new ErrorNotConnected("websocket is not connected"));const C=setTimeout(()=>{this._rpcResponseAwaiters.delete(A.id),O(new ErrorTimeout("no response"))},T*1e3);this._rpcResponseAwaiters.set(A.id,{resolve:v,reject:O,timeout:C})})}executeOutgoingRpcBatch(m){const S=[],T=[];return m.forEach(({method:v,params:O,id:A})=>{const C=this.createRequest(v,O,A);S.push(C),T.push(new Promise((k,$)=>this._rpcResponseAwaiters.set(C.id,{resolve:k,reject:$})))}),this._connector.send(JSON.stringify(S)),T}processRpcResponse(m){if("id"in m&&this._rpcResponseAwaiters.has(Number(m.id))){const S=this._rpcResponseAwaiters.get(Number(m.id));S&&("result"in m?S.resolve(m.result):"error"in m?S.reject(m?.error||"error"):S.reject("wrong response structure"),clearTimeout(S.timeout),this._rpcResponseAwaiters.delete(Number(m.id)));return}this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: Received rpc response with unknown id`),m)}parseJsonRpcMessage(m){let S;try{S=JSON.parse(m)}catch(T){this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: Could not decode json rpc message`),T);return}if(c$1.isArray(S))return this.executeIncomingRpcBatch(S);if(c$1.isJsonRpcRequest(S))return this.executeIncomingRpcCommand(S);if(c$1.isJsonRpcResponse(S))return this.processRpcResponse(S);this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: unknown rpc packet`),S)}executeIncomingRpcCommand({method:m,params:S}){return m in this._handlers?this._handlers[m].call(this,S||{}):{jsonrpc:u,error:ListRpcError.MethodNotFound}}executeIncomingRpcBatch(m){let S=[];for(let T of m)if("jsonrpc"in T)if("method"in T){let v=this.executeIncomingRpcCommand(T);v&&(v.jsonrpc=u,v.id=T.id,S.push(v))}else this.processRpcResponse(T);else this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: unknown rpc command in batch`),T),S.push({jsonrpc:u,error:ListRpcError.InvalidRequest});return S}nextId(){return++this._idCounter}createPublishRequest(m){return m.map(S=>this.createRequest("publish",S))}createRequest(m,S,T){return T||(T=this.nextId()),{jsonrpc:u,method:m,params:S,id:T}}}class SharedConfig{_logger=null;_storage;_ttl=24*60*60;_callbacks;constructor(m={}){m=m||{},this._storage=m.storage||new StorageManager,this._callbacks={onWebSocketBlockChanged:c$1.isFunction(m.onWebSocketBlockChanged)?m.onWebSocketBlockChanged:()=>{}},this._storage&&window.addEventListener("storage",this.onLocalStorageSet.bind(this))}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}onLocalStorageSet(m){this._storage.compareKey(m.key||"",LsKeys.WebsocketBlocked)&&m.newValue!==m.oldValue&&this._callbacks.onWebSocketBlockChanged({isWebSocketBlocked:this.isWebSocketBlocked()})}isWebSocketBlocked(){return this._storage?this._storage.get(LsKeys.WebsocketBlocked,0)>new Date().getTime():!1}setWebSocketBlocked(m){if(!this._storage)return!1;try{this._storage.set(LsKeys.WebsocketBlocked,m?new Date().getTime()+this._ttl:0)}catch(S){return this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: Could not save WS_blocked flag in local storage. Error: `),S),!1}return!0}isLongPollingBlocked(){return this._storage?this._storage.get(LsKeys.LongPollingBlocked,0)>new Date().getTime():!1}setLongPollingBlocked(m){if(!this._storage)return!1;try{this._storage.set(LsKeys.LongPollingBlocked,m?new Date().getTime()+this._ttl:0)}catch(S){return this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: Could not save LP_blocked flag in local storage. Error: `),S),!1}return!0}isLoggingEnabled(){return this._storage?this._storage.get(LsKeys.LoggingEnabled,0)>this.getTimestamp():!1}setLoggingEnabled(m){if(!this._storage)return!1;try{this._storage.set(LsKeys.LoggingEnabled,m?this.getTimestamp()+this._ttl:0)}catch(S){return this.getLogger().error(new Error(`${h$1.getDateForLog()}: LocalStorage error: `),S),!1}return!0}getTimestamp(){return new Date().getTime()}}class ChannelManager{_logger=null;_publicIds;_restClient;_getPublicListMethod;constructor(m){this._publicIds=new Map,this._restClient=m.b24,this._getPublicListMethod=m.getPublicListMethod}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}async getPublicIds(m){const S=new Date;let T={},v=[];return m.forEach(O=>{const A=this._publicIds.get(O);A&&A.end>S?T[A.userId]=A:v.push(O)}),v.length===0?Promise.resolve(T):new Promise(O=>{this._restClient.callMethod(this._getPublicListMethod,{users:v}).then(A=>{const C=A.getData().result;this.setPublicIds(Object.values(C)),v.forEach(k=>{const $=this._publicIds.get(k);$&&(T[$.userId]=$)}),O(T)}).catch(A=>(this.getLogger().error(A),O({})))})}setPublicIds(m){m.forEach(S=>{const T=Number(S.user_id);this._publicIds.set(T,{userId:T,publicId:S.public_id,signature:S.signature,start:new Date(S.start),end:new Date(S.end)})})}}var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=_;function _(m,S){for(var T=new Array(arguments.length-1),v=0,O=2,A=!0;O<arguments.length;)T[v++]=arguments[O++];return new Promise(function(k,$){T[v]=function(P){if(A)if(A=!1,P)$(P);else{for(var U=new Array(arguments.length-1),N=0;N<U.length;)U[N++]=arguments[N];k.apply(null,U)}};try{m.apply(S||null,T)}catch(M){A&&(A=!1,$(M))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(_){var m=_;m.length=function(C){var k=C.length;if(!k)return 0;for(var $=0;--k%4>1&&C.charAt(k)==="=";)++$;return Math.ceil(C.length*3)/4-$};for(var S=new Array(64),T=new Array(123),v=0;v<64;)T[S[v]=v<26?v+65:v<52?v+71:v<62?v-4:v-59|43]=v++;m.encode=function(C,k,$){for(var M=null,P=[],U=0,N=0,B;k<$;){var j=C[k++];switch(N){case 0:P[U++]=S[j>>2],B=(j&3)<<4,N=1;break;case 1:P[U++]=S[B|j>>4],B=(j&15)<<2,N=2;break;case 2:P[U++]=S[B|j>>6],P[U++]=S[j&63],N=0;break}U>8191&&((M||(M=[])).push(String.fromCharCode.apply(String,P)),U=0)}return N&&(P[U++]=S[B],P[U++]=61,N===1&&(P[U++]=61)),M?(U&&M.push(String.fromCharCode.apply(String,P.slice(0,U))),M.join("")):String.fromCharCode.apply(String,P.slice(0,U))};var O="invalid encoding";m.decode=function(C,k,$){for(var M=$,P=0,U,N=0;N<C.length;){var B=C.charCodeAt(N++);if(B===61&&P>1)break;if((B=T[B])===void 0)throw Error(O);switch(P){case 0:U=B,P=1;break;case 1:k[$++]=U<<2|(B&48)>>4,U=B,P=2;break;case 2:k[$++]=(U&15)<<4|(B&60)>>2,U=B,P=3;break;case 3:k[$++]=(U&3)<<6|B,P=0;break}}if(P===1)throw Error(O);return $-M},m.test=function(C){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(C)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=_;function _(){this._listeners={}}return _.prototype.on=function(S,T,v){return(this._listeners[S]||(this._listeners[S]=[])).push({fn:T,ctx:v||this}),this},_.prototype.off=function(S,T){if(S===void 0)this._listeners={};else if(T===void 0)this._listeners[S]=[];else for(var v=this._listeners[S],O=0;O<v.length;)v[O].fn===T?v.splice(O,1):++O;return this},_.prototype.emit=function(S){var T=this._listeners[S];if(T){for(var v=[],O=1;O<arguments.length;)v.push(arguments[O++]);for(O=0;O<T.length;)T[O].fn.apply(T[O++].ctx,v)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=_(_);function _(O){return typeof Float32Array<"u"?function(){var A=new Float32Array([-0]),C=new Uint8Array(A.buffer),k=C[3]===128;function $(N,B,j){A[0]=N,B[j]=C[0],B[j+1]=C[1],B[j+2]=C[2],B[j+3]=C[3]}function M(N,B,j){A[0]=N,B[j]=C[3],B[j+1]=C[2],B[j+2]=C[1],B[j+3]=C[0]}O.writeFloatLE=k?$:M,O.writeFloatBE=k?M:$;function P(N,B){return C[0]=N[B],C[1]=N[B+1],C[2]=N[B+2],C[3]=N[B+3],A[0]}function U(N,B){return C[3]=N[B],C[2]=N[B+1],C[1]=N[B+2],C[0]=N[B+3],A[0]}O.readFloatLE=k?P:U,O.readFloatBE=k?U:P}():function(){function A(k,$,M,P){var U=$<0?1:0;if(U&&($=-$),$===0)k(1/$>0?0:2147483648,M,P);else if(isNaN($))k(2143289344,M,P);else if($>34028234663852886e22)k((U<<31|2139095040)>>>0,M,P);else if($<11754943508222875e-54)k((U<<31|Math.round($/1401298464324817e-60))>>>0,M,P);else{var N=Math.floor(Math.log($)/Math.LN2),B=Math.round($*Math.pow(2,-N)*8388608)&8388607;k((U<<31|N+127<<23|B)>>>0,M,P)}}O.writeFloatLE=A.bind(null,m),O.writeFloatBE=A.bind(null,S);function C(k,$,M){var P=k($,M),U=(P>>31)*2+1,N=P>>>23&255,B=P&8388607;return N===255?B?NaN:U*(1/0):N===0?U*1401298464324817e-60*B:U*Math.pow(2,N-150)*(B+8388608)}O.readFloatLE=C.bind(null,T),O.readFloatBE=C.bind(null,v)}(),typeof Float64Array<"u"?function(){var A=new Float64Array([-0]),C=new Uint8Array(A.buffer),k=C[7]===128;function $(N,B,j){A[0]=N,B[j]=C[0],B[j+1]=C[1],B[j+2]=C[2],B[j+3]=C[3],B[j+4]=C[4],B[j+5]=C[5],B[j+6]=C[6],B[j+7]=C[7]}function M(N,B,j){A[0]=N,B[j]=C[7],B[j+1]=C[6],B[j+2]=C[5],B[j+3]=C[4],B[j+4]=C[3],B[j+5]=C[2],B[j+6]=C[1],B[j+7]=C[0]}O.writeDoubleLE=k?$:M,O.writeDoubleBE=k?M:$;function P(N,B){return C[0]=N[B],C[1]=N[B+1],C[2]=N[B+2],C[3]=N[B+3],C[4]=N[B+4],C[5]=N[B+5],C[6]=N[B+6],C[7]=N[B+7],A[0]}function U(N,B){return C[7]=N[B],C[6]=N[B+1],C[5]=N[B+2],C[4]=N[B+3],C[3]=N[B+4],C[2]=N[B+5],C[1]=N[B+6],C[0]=N[B+7],A[0]}O.readDoubleLE=k?P:U,O.readDoubleBE=k?U:P}():function(){function A(k,$,M,P,U,N){var B=P<0?1:0;if(B&&(P=-P),P===0)k(0,U,N+$),k(1/P>0?0:2147483648,U,N+M);else if(isNaN(P))k(0,U,N+$),k(2146959360,U,N+M);else if(P>17976931348623157e292)k(0,U,N+$),k((B<<31|2146435072)>>>0,U,N+M);else{var j;if(P<22250738585072014e-324)j=P/5e-324,k(j>>>0,U,N+$),k((B<<31|j/4294967296)>>>0,U,N+M);else{var D=Math.floor(Math.log(P)/Math.LN2);D===1024&&(D=1023),j=P*Math.pow(2,-D),k(j*4503599627370496>>>0,U,N+$),k((B<<31|D+1023<<20|j*1048576&1048575)>>>0,U,N+M)}}}O.writeDoubleLE=A.bind(null,m,0,4),O.writeDoubleBE=A.bind(null,S,4,0);function C(k,$,M,P,U){var N=k(P,U+$),B=k(P,U+M),j=(B>>31)*2+1,D=B>>>20&2047,q=4294967296*(B&1048575)+N;return D===2047?q?NaN:j*(1/0):D===0?j*5e-324*q:j*Math.pow(2,D-1075)*(q+4503599627370496)}O.readDoubleLE=C.bind(null,T,0,4),O.readDoubleBE=C.bind(null,v,4,0)}(),O}function m(O,A,C){A[C]=O&255,A[C+1]=O>>>8&255,A[C+2]=O>>>16&255,A[C+3]=O>>>24}function S(O,A,C){A[C]=O>>>24,A[C+1]=O>>>16&255,A[C+2]=O>>>8&255,A[C+3]=O&255}function T(O,A){return(O[A]|O[A+1]<<8|O[A+2]<<16|O[A+3]<<24)>>>0}function v(O,A){return(O[A]<<24|O[A+1]<<16|O[A+2]<<8|O[A+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(_){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(_){var m=_;m.length=function(T){for(var v=0,O=0,A=0;A<T.length;++A)O=T.charCodeAt(A),O<128?v+=1:O<2048?v+=2:(O&64512)===55296&&(T.charCodeAt(A+1)&64512)===56320?(++A,v+=4):v+=3;return v},m.read=function(T,v,O){var A=O-v;if(A<1)return"";for(var C=null,k=[],$=0,M;v<O;)M=T[v++],M<128?k[$++]=M:M>191&&M<224?k[$++]=(M&31)<<6|T[v++]&63:M>239&&M<365?(M=((M&7)<<18|(T[v++]&63)<<12|(T[v++]&63)<<6|T[v++]&63)-65536,k[$++]=55296+(M>>10),k[$++]=56320+(M&1023)):k[$++]=(M&15)<<12|(T[v++]&63)<<6|T[v++]&63,$>8191&&((C||(C=[])).push(String.fromCharCode.apply(String,k)),$=0);return C?($&&C.push(String.fromCharCode.apply(String,k.slice(0,$))),C.join("")):String.fromCharCode.apply(String,k.slice(0,$))},m.write=function(T,v,O){for(var A=O,C,k,$=0;$<T.length;++$)C=T.charCodeAt($),C<128?v[O++]=C:C<2048?(v[O++]=C>>6|192,v[O++]=C&63|128):(C&64512)===55296&&((k=T.charCodeAt($+1))&64512)===56320?(C=65536+((C&1023)<<10)+(k&1023),++$,v[O++]=C>>18|240,v[O++]=C>>12&63|128,v[O++]=C>>6&63|128,v[O++]=C&63|128):(v[O++]=C>>12|224,v[O++]=C>>6&63|128,v[O++]=C&63|128);return O-A}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=_;function _(m,S,T){var v=T||8192,O=v>>>1,A=null,C=v;return function($){if($<1||$>O)return m($);C+$>v&&(A=m(v),C=0);var M=S.call(A,C,C+=$);return C&7&&(C=(C|7)+1),M}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=m;var _=requireMinimal$1();function m(O,A){this.lo=O>>>0,this.hi=A>>>0}var S=m.zero=new m(0,0);S.toNumber=function(){return 0},S.zzEncode=S.zzDecode=function(){return this},S.length=function(){return 1};var T=m.zeroHash="\0\0\0\0\0\0\0\0";m.fromNumber=function(A){if(A===0)return S;var C=A<0;C&&(A=-A);var k=A>>>0,$=(A-k)/4294967296>>>0;return C&&($=~$>>>0,k=~k>>>0,++k>4294967295&&(k=0,++$>4294967295&&($=0))),new m(k,$)},m.from=function(A){if(typeof A=="number")return m.fromNumber(A);if(_.isString(A))if(_.Long)A=_.Long.fromString(A);else return m.fromNumber(parseInt(A,10));return A.low||A.high?new m(A.low>>>0,A.high>>>0):S},m.prototype.toNumber=function(A){if(!A&&this.hi>>>31){var C=~this.lo+1>>>0,k=~this.hi>>>0;return C||(k=k+1>>>0),-(C+k*4294967296)}return this.lo+this.hi*4294967296},m.prototype.toLong=function(A){return _.Long?new _.Long(this.lo|0,this.hi|0,!!A):{low:this.lo|0,high:this.hi|0,unsigned:!!A}};var v=String.prototype.charCodeAt;return m.fromHash=function(A){return A===T?S:new m((v.call(A,0)|v.call(A,1)<<8|v.call(A,2)<<16|v.call(A,3)<<24)>>>0,(v.call(A,4)|v.call(A,5)<<8|v.call(A,6)<<16|v.call(A,7)<<24)>>>0)},m.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},m.prototype.zzEncode=function(){var A=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^A)>>>0,this.lo=(this.lo<<1^A)>>>0,this},m.prototype.zzDecode=function(){var A=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^A)>>>0,this.hi=(this.hi>>>1^A)>>>0,this},m.prototype.length=function(){var A=this.lo,C=(this.lo>>>28|this.hi<<4)>>>0,k=this.hi>>>24;return k===0?C===0?A<16384?A<128?1:2:A<2097152?3:4:C<16384?C<128?5:6:C<2097152?7:8:k<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(_){var m=_;m.asPromise=requireAspromise(),m.base64=requireBase64(),m.EventEmitter=requireEventemitter(),m.float=requireFloat(),m.inquire=requireInquire(),m.utf8=requireUtf8(),m.pool=requirePool(),m.LongBits=requireLongbits(),m.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),m.global=m.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,m.emptyArray=Object.freeze?Object.freeze([]):[],m.emptyObject=Object.freeze?Object.freeze({}):{},m.isInteger=Number.isInteger||function(O){return typeof O=="number"&&isFinite(O)&&Math.floor(O)===O},m.isString=function(O){return typeof O=="string"||O instanceof String},m.isObject=function(O){return O&&typeof O=="object"},m.isset=m.isSet=function(O,A){var C=O[A];return C!=null&&O.hasOwnProperty(A)?typeof C!="object"||(Array.isArray(C)?C.length:Object.keys(C).length)>0:!1},m.Buffer=function(){try{var v=m.inquire("buffer").Buffer;return v.prototype.utf8Write?v:null}catch{return null}}(),m._Buffer_from=null,m._Buffer_allocUnsafe=null,m.newBuffer=function(O){return typeof O=="number"?m.Buffer?m._Buffer_allocUnsafe(O):new m.Array(O):m.Buffer?m._Buffer_from(O):typeof Uint8Array>"u"?O:new Uint8Array(O)},m.Array=typeof Uint8Array<"u"?Uint8Array:Array,m.Long=m.global.dcodeIO&&m.global.dcodeIO.Long||m.global.Long||m.inquire("long"),m.key2Re=/^true|false|0|1$/,m.key32Re=/^-?(?:0|[1-9][0-9]*)$/,m.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,m.longToHash=function(O){return O?m.LongBits.from(O).toHash():m.LongBits.zeroHash},m.longFromHash=function(O,A){var C=m.LongBits.fromHash(O);return m.Long?m.Long.fromBits(C.lo,C.hi,A):C.toNumber(!!A)};function S(v,O,A){for(var C=Object.keys(O),k=0;k<C.length;++k)(v[C[k]]===void 0||!A)&&(v[C[k]]=O[C[k]]);return v}m.merge=S,m.lcFirst=function(O){return O.charAt(0).toLowerCase()+O.substring(1)};function T(v){function O(A,C){if(!(this instanceof O))return new O(A,C);Object.defineProperty(this,"message",{get:function(){return A}}),Error.captureStackTrace?Error.captureStackTrace(this,O):Object.defineProperty(this,"stack",{value:new Error().stack||""}),C&&S(this,C)}return O.prototype=Object.create(Error.prototype,{constructor:{value:O,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return v},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),O}m.newError=T,m.ProtocolError=T("ProtocolError"),m.oneOfGetter=function(O){for(var A={},C=0;C<O.length;++C)A[O[C]]=1;return function(){for(var k=Object.keys(this),$=k.length-1;$>-1;--$)if(A[k[$]]===1&&this[k[$]]!==void 0&&this[k[$]]!==null)return k[$]}},m.oneOfSetter=function(O){return function(A){for(var C=0;C<O.length;++C)O[C]!==A&&delete this[O[C]]}},m.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},m._configure=function(){var v=m.Buffer;if(!v){m._Buffer_from=m._Buffer_allocUnsafe=null;return}m._Buffer_from=v.from!==Uint8Array.from&&v.from||function(A,C){return new v(A,C)},m._Buffer_allocUnsafe=v.allocUnsafe||function(A){return new v(A)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=k;var _=requireMinimal$1(),m,S=_.LongBits,T=_.base64,v=_.utf8;function O(D,q,W){this.fn=D,this.len=q,this.next=void 0,this.val=W}function A(){}function C(D){this.head=D.head,this.tail=D.tail,this.len=D.len,this.next=D.states}function k(){this.len=0,this.head=new O(A,0,0),this.tail=this.head,this.states=null}var $=function(){return _.Buffer?function(){return(k.create=function(){return new m})()}:function(){return new k}};k.create=$(),k.alloc=function(q){return new _.Array(q)},_.Array!==Array&&(k.alloc=_.pool(k.alloc,_.Array.prototype.subarray)),k.prototype._push=function(q,W,Y){return this.tail=this.tail.next=new O(q,W,Y),this.len+=W,this};function M(D,q,W){q[W]=D&255}function P(D,q,W){for(;D>127;)q[W++]=D&127|128,D>>>=7;q[W]=D}function U(D,q){this.len=D,this.next=void 0,this.val=q}U.prototype=Object.create(O.prototype),U.prototype.fn=P,k.prototype.uint32=function(q){return this.len+=(this.tail=this.tail.next=new U((q=q>>>0)<128?1:q<16384?2:q<2097152?3:q<268435456?4:5,q)).len,this},k.prototype.int32=function(q){return q<0?this._push(N,10,S.fromNumber(q)):this.uint32(q)},k.prototype.sint32=function(q){return this.uint32((q<<1^q>>31)>>>0)};function N(D,q,W){for(;D.hi;)q[W++]=D.lo&127|128,D.lo=(D.lo>>>7|D.hi<<25)>>>0,D.hi>>>=7;for(;D.lo>127;)q[W++]=D.lo&127|128,D.lo=D.lo>>>7;q[W++]=D.lo}k.prototype.uint64=function(q){var W=S.from(q);return this._push(N,W.length(),W)},k.prototype.int64=k.prototype.uint64,k.prototype.sint64=function(q){var W=S.from(q).zzEncode();return this._push(N,W.length(),W)},k.prototype.bool=function(q){return this._push(M,1,q?1:0)};function B(D,q,W){q[W]=D&255,q[W+1]=D>>>8&255,q[W+2]=D>>>16&255,q[W+3]=D>>>24}k.prototype.fixed32=function(q){return this._push(B,4,q>>>0)},k.prototype.sfixed32=k.prototype.fixed32,k.prototype.fixed64=function(q){var W=S.from(q);return this._push(B,4,W.lo)._push(B,4,W.hi)},k.prototype.sfixed64=k.prototype.fixed64,k.prototype.float=function(q){return this._push(_.float.writeFloatLE,4,q)},k.prototype.double=function(q){return this._push(_.float.writeDoubleLE,8,q)};var j=_.Array.prototype.set?function(q,W,Y){W.set(q,Y)}:function(q,W,Y){for(var Q=0;Q<q.length;++Q)W[Y+Q]=q[Q]};return k.prototype.bytes=function(q){var W=q.length>>>0;if(!W)return this._push(M,1,0);if(_.isString(q)){var Y=k.alloc(W=T.length(q));T.decode(q,Y,0),q=Y}return this.uint32(W)._push(j,W,q)},k.prototype.string=function(q){var W=v.length(q);return W?this.uint32(W)._push(v.write,W,q):this._push(M,1,0)},k.prototype.fork=function(){return this.states=new C(this),this.head=this.tail=new O(A,0,0),this.len=0,this},k.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new O(A,0,0),this.len=0),this},k.prototype.ldelim=function(){var q=this.head,W=this.tail,Y=this.len;return this.reset().uint32(Y),Y&&(this.tail.next=q.next,this.tail=W,this.len+=Y),this},k.prototype.finish=function(){for(var q=this.head.next,W=this.constructor.alloc(this.len),Y=0;q;)q.fn(q.val,W,Y),Y+=q.len,q=q.next;return W},k._configure=function(D){m=D,k.create=$(),m._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=S;var _=requireWriter();(S.prototype=Object.create(_.prototype)).constructor=S;var m=requireMinimal$1();function S(){_.call(this)}S._configure=function(){S.alloc=m._Buffer_allocUnsafe,S.writeBytesBuffer=m.Buffer&&m.Buffer.prototype instanceof Uint8Array&&m.Buffer.prototype.set.name==="set"?function(O,A,C){A.set(O,C)}:function(O,A,C){if(O.copy)O.copy(A,C,0,O.length);else for(var k=0;k<O.length;)A[C++]=O[k++]}},S.prototype.bytes=function(O){m.isString(O)&&(O=m._Buffer_from(O,"base64"));var A=O.length>>>0;return this.uint32(A),A&&this._push(S.writeBytesBuffer,A,O),this};function T(v,O,A){v.length<40?m.utf8.write(v,O,A):O.utf8Write?O.utf8Write(v,A):O.write(v,A)}return S.prototype.string=function(O){var A=m.Buffer.byteLength(O);return this.uint32(A),A&&this._push(T,A,O),this},S._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=O;var _=requireMinimal$1(),m,S=_.LongBits,T=_.utf8;function v(P,U){return RangeError("index out of range: "+P.pos+" + "+(U||1)+" > "+P.len)}function O(P){this.buf=P,this.pos=0,this.len=P.length}var A=typeof Uint8Array<"u"?function(U){if(U instanceof Uint8Array||Array.isArray(U))return new O(U);throw Error("illegal buffer")}:function(U){if(Array.isArray(U))return new O(U);throw Error("illegal buffer")},C=function(){return _.Buffer?function(N){return(O.create=function(j){return _.Buffer.isBuffer(j)?new m(j):A(j)})(N)}:A};O.create=C(),O.prototype._slice=_.Array.prototype.subarray||_.Array.prototype.slice,O.prototype.uint32=function(){var U=4294967295;return function(){if(U=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(U=(U|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(U=(U|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(U=(U|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(U=(U|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return U;if((this.pos+=5)>this.len)throw this.pos=this.len,v(this,10);return U}}(),O.prototype.int32=function(){return this.uint32()|0},O.prototype.sint32=function(){var U=this.uint32();return U>>>1^-(U&1)|0};function k(){var P=new S(0,0),U=0;if(this.len-this.pos>4){for(;U<4;++U)if(P.lo=(P.lo|(this.buf[this.pos]&127)<<U*7)>>>0,this.buf[this.pos++]<128)return P;if(P.lo=(P.lo|(this.buf[this.pos]&127)<<28)>>>0,P.hi=(P.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return P;U=0}else{for(;U<3;++U){if(this.pos>=this.len)throw v(this);if(P.lo=(P.lo|(this.buf[this.pos]&127)<<U*7)>>>0,this.buf[this.pos++]<128)return P}return P.lo=(P.lo|(this.buf[this.pos++]&127)<<U*7)>>>0,P}if(this.len-this.pos>4){for(;U<5;++U)if(P.hi=(P.hi|(this.buf[this.pos]&127)<<U*7+3)>>>0,this.buf[this.pos++]<128)return P}else for(;U<5;++U){if(this.pos>=this.len)throw v(this);if(P.hi=(P.hi|(this.buf[this.pos]&127)<<U*7+3)>>>0,this.buf[this.pos++]<128)return P}throw Error("invalid varint encoding")}O.prototype.bool=function(){return this.uint32()!==0};function $(P,U){return(P[U-4]|P[U-3]<<8|P[U-2]<<16|P[U-1]<<24)>>>0}O.prototype.fixed32=function(){if(this.pos+4>this.len)throw v(this,4);return $(this.buf,this.pos+=4)},O.prototype.sfixed32=function(){if(this.pos+4>this.len)throw v(this,4);return $(this.buf,this.pos+=4)|0};function M(){if(this.pos+8>this.len)throw v(this,8);return new S($(this.buf,this.pos+=4),$(this.buf,this.pos+=4))}return O.prototype.float=function(){if(this.pos+4>this.len)throw v(this,4);var U=_.float.readFloatLE(this.buf,this.pos);return this.pos+=4,U},O.prototype.double=function(){if(this.pos+8>this.len)throw v(this,4);var U=_.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,U},O.prototype.bytes=function(){var U=this.uint32(),N=this.pos,B=this.pos+U;if(B>this.len)throw v(this,U);if(this.pos+=U,Array.isArray(this.buf))return this.buf.slice(N,B);if(N===B){var j=_.Buffer;return j?j.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,N,B)},O.prototype.string=function(){var U=this.bytes();return T.read(U,0,U.length)},O.prototype.skip=function(U){if(typeof U=="number"){if(this.pos+U>this.len)throw v(this,U);this.pos+=U}else do if(this.pos>=this.len)throw v(this);while(this.buf[this.pos++]&128);return this},O.prototype.skipType=function(P){switch(P){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(P=this.uint32()&7)!==4;)this.skipType(P);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+P+" at offset "+this.pos)}return this},O._configure=function(P){m=P,O.create=C(),m._configure();var U=_.Long?"toLong":"toNumber";_.merge(O.prototype,{int64:function(){return k.call(this)[U](!1)},uint64:function(){return k.call(this)[U](!0)},sint64:function(){return k.call(this).zzDecode()[U](!1)},fixed64:function(){return M.call(this)[U](!0)},sfixed64:function(){return M.call(this)[U](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=S;var _=requireReader();(S.prototype=Object.create(_.prototype)).constructor=S;var m=requireMinimal$1();function S(T){_.call(this,T)}return S._configure=function(){m.Buffer&&(S.prototype._slice=m.Buffer.prototype.slice)},S.prototype.string=function(){var v=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+v,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+v,this.len))},S._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=m;var _=requireMinimal$1();(m.prototype=Object.create(_.EventEmitter.prototype)).constructor=m;function m(S,T,v){if(typeof S!="function")throw TypeError("rpcImpl must be a function");_.EventEmitter.call(this),this.rpcImpl=S,this.requestDelimited=!!T,this.responseDelimited=!!v}return m.prototype.rpcCall=function S(T,v,O,A,C){if(!A)throw TypeError("request must be specified");var k=this;if(!C)return _.asPromise(S,k,T,v,O,A);if(!k.rpcImpl){setTimeout(function(){C(Error("already ended"))},0);return}try{return k.rpcImpl(T,v[k.requestDelimited?"encodeDelimited":"encode"](A).finish(),function(M,P){if(M)return k.emit("error",M,T),C(M);if(P===null){k.end(!0);return}if(!(P instanceof O))try{P=O[k.responseDelimited?"decodeDelimited":"decode"](P)}catch(U){return k.emit("error",U,T),C(U)}return k.emit("data",P,T),C(null,P)})}catch($){k.emit("error",$,T),setTimeout(function(){C($)},0);return}},m.prototype.end=function(T){return this.rpcImpl&&(T||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(_){var m=_;m.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(_){var m=_;m.build="minimal",m.Writer=requireWriter(),m.BufferWriter=requireWriter_buffer(),m.Reader=requireReader(),m.BufferReader=requireReader_buffer(),m.util=requireMinimal$1(),m.rpc=requireRpc(),m.roots=requireRoots(),m.configure=S;function S(){m.util._configure(),m.Writer._configure(m.BufferWriter),m.Reader._configure(m.BufferReader)}S()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const h=getDefaultExportFromCjs(minimalExports);let i=h.Reader,l=h.Writer,f=h.util;const $root=h.roots["push-server"]||(h.roots["push-server"]={});$root.RequestBatch=function(){function _(m){if(this.requests=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.requests=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.requests!=null&&m.requests.length)for(var T=0;T<m.requests.length;++T)$root.Request.encode(m.requests[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.RequestBatch;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.requests&&v.requests.length||(v.requests=[]),v.requests.push($root.Request.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.Request=function(){function _(S){if(S)for(var T=Object.keys(S),v=0;v<T.length;++v)S[T[v]]!=null&&(this[T[v]]=S[T[v]])}_.prototype.incomingMessages=null,_.prototype.channelStats=null,_.prototype.serverStats=null;var m;return Object.defineProperty(_.prototype,"command",{get:f.oneOfGetter(m=["incomingMessages","channelStats","serverStats"]),set:f.oneOfSetter(m)}),_.create=function(S){return new _(S)},_.encode=function(S,T){return T||(T=l.create()),S.incomingMessages!=null&&S.hasOwnProperty("incomingMessages")&&$root.IncomingMessagesRequest.encode(S.incomingMessages,T.uint32(10).fork()).ldelim(),S.channelStats!=null&&S.hasOwnProperty("channelStats")&&$root.ChannelStatsRequest.encode(S.channelStats,T.uint32(18).fork()).ldelim(),S.serverStats!=null&&S.hasOwnProperty("serverStats")&&$root.ServerStatsRequest.encode(S.serverStats,T.uint32(26).fork()).ldelim(),T},_.decode=function(S,T){S instanceof i||(S=i.create(S));for(var v=T===void 0?S.len:S.pos+T,O=new $root.Request;S.pos<v;){var A=S.uint32();switch(A>>>3){case 1:O.incomingMessages=$root.IncomingMessagesRequest.decode(S,S.uint32());break;case 2:O.channelStats=$root.ChannelStatsRequest.decode(S,S.uint32());break;case 3:O.serverStats=$root.ServerStatsRequest.decode(S,S.uint32());break;default:S.skipType(A&7);break}}return O},_}(),$root.IncomingMessagesRequest=function(){function _(m){if(this.messages=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.messages=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.messages!=null&&m.messages.length)for(var T=0;T<m.messages.length;++T)$root.IncomingMessage.encode(m.messages[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.IncomingMessagesRequest;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.messages&&v.messages.length||(v.messages=[]),v.messages.push($root.IncomingMessage.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.IncomingMessage=function(){function _(m){if(this.receivers=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.receivers=f.emptyArray,_.prototype.sender=null,_.prototype.body="",_.prototype.expiry=0,_.prototype.type="",_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.receivers!=null&&m.receivers.length)for(var T=0;T<m.receivers.length;++T)$root.Receiver.encode(m.receivers[T],S.uint32(10).fork()).ldelim();return m.sender!=null&&m.hasOwnProperty("sender")&&$root.Sender.encode(m.sender,S.uint32(18).fork()).ldelim(),m.body!=null&&m.hasOwnProperty("body")&&S.uint32(26).string(m.body),m.expiry!=null&&m.hasOwnProperty("expiry")&&S.uint32(32).uint32(m.expiry),m.type!=null&&m.hasOwnProperty("type")&&S.uint32(42).string(m.type),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.IncomingMessage;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.receivers&&v.receivers.length||(v.receivers=[]),v.receivers.push($root.Receiver.decode(m,m.uint32()));break;case 2:v.sender=$root.Sender.decode(m,m.uint32());break;case 3:v.body=m.string();break;case 4:v.expiry=m.uint32();break;case 5:v.type=m.string();break;default:m.skipType(O&7);break}}return v},_}(),$root.ChannelStatsRequest=function(){function _(m){if(this.channels=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.channels=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.channels!=null&&m.channels.length)for(var T=0;T<m.channels.length;++T)$root.ChannelId.encode(m.channels[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ChannelStatsRequest;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.channels&&v.channels.length||(v.channels=[]),v.channels.push($root.ChannelId.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.ChannelId=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.id=f.newBuffer([]),_.prototype.isPrivate=!1,_.prototype.signature=f.newBuffer([]),_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.id!=null&&m.hasOwnProperty("id")&&S.uint32(10).bytes(m.id),m.isPrivate!=null&&m.hasOwnProperty("isPrivate")&&S.uint32(16).bool(m.isPrivate),m.signature!=null&&m.hasOwnProperty("signature")&&S.uint32(26).bytes(m.signature),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ChannelId;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.id=m.bytes();break;case 2:v.isPrivate=m.bool();break;case 3:v.signature=m.bytes();break;default:m.skipType(O&7);break}}return v},_}(),$root.ServerStatsRequest=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ServerStatsRequest;m.pos<T;){var O=m.uint32();switch(O>>>3){default:m.skipType(O&7);break}}return v},_}(),$root.Sender=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.type=0,_.prototype.id=f.newBuffer([]),_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.type!=null&&m.hasOwnProperty("type")&&S.uint32(8).int32(m.type),m.id!=null&&m.hasOwnProperty("id")&&S.uint32(18).bytes(m.id),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.Sender;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.type=m.int32();break;case 2:v.id=m.bytes();break;default:m.skipType(O&7);break}}return v},_}(),$root.SenderType=function(){var _={},m=Object.create(_);return m[_[0]="UNKNOWN"]=0,m[_[1]="CLIENT"]=1,m[_[2]="BACKEND"]=2,m}(),$root.Receiver=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.id=f.newBuffer([]),_.prototype.isPrivate=!1,_.prototype.signature=f.newBuffer([]),_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.id!=null&&m.hasOwnProperty("id")&&S.uint32(10).bytes(m.id),m.isPrivate!=null&&m.hasOwnProperty("isPrivate")&&S.uint32(16).bool(m.isPrivate),m.signature!=null&&m.hasOwnProperty("signature")&&S.uint32(26).bytes(m.signature),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.Receiver;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.id=m.bytes();break;case 2:v.isPrivate=m.bool();break;case 3:v.signature=m.bytes();break;default:m.skipType(O&7);break}}return v},_}(),$root.ResponseBatch=function(){function _(m){if(this.responses=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.responses=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.responses!=null&&m.responses.length)for(var T=0;T<m.responses.length;++T)$root.Response.encode(m.responses[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ResponseBatch;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.responses&&v.responses.length||(v.responses=[]),v.responses.push($root.Response.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.Response=function(){function _(S){if(S)for(var T=Object.keys(S),v=0;v<T.length;++v)S[T[v]]!=null&&(this[T[v]]=S[T[v]])}_.prototype.outgoingMessages=null,_.prototype.channelStats=null,_.prototype.serverStats=null;var m;return Object.defineProperty(_.prototype,"command",{get:f.oneOfGetter(m=["outgoingMessages","channelStats","serverStats"]),set:f.oneOfSetter(m)}),_.create=function(S){return new _(S)},_.encode=function(S,T){return T||(T=l.create()),S.outgoingMessages!=null&&S.hasOwnProperty("outgoingMessages")&&$root.OutgoingMessagesResponse.encode(S.outgoingMessages,T.uint32(10).fork()).ldelim(),S.channelStats!=null&&S.hasOwnProperty("channelStats")&&$root.ChannelStatsResponse.encode(S.channelStats,T.uint32(18).fork()).ldelim(),S.serverStats!=null&&S.hasOwnProperty("serverStats")&&$root.JsonResponse.encode(S.serverStats,T.uint32(26).fork()).ldelim(),T},_.decode=function(S,T){S instanceof i||(S=i.create(S));for(var v=T===void 0?S.len:S.pos+T,O=new $root.Response;S.pos<v;){var A=S.uint32();switch(A>>>3){case 1:O.outgoingMessages=$root.OutgoingMessagesResponse.decode(S,S.uint32());break;case 2:O.channelStats=$root.ChannelStatsResponse.decode(S,S.uint32());break;case 3:O.serverStats=$root.JsonResponse.decode(S,S.uint32());break;default:S.skipType(A&7);break}}return O},_}(),$root.OutgoingMessagesResponse=function(){function _(m){if(this.messages=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.messages=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.messages!=null&&m.messages.length)for(var T=0;T<m.messages.length;++T)$root.OutgoingMessage.encode(m.messages[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.OutgoingMessagesResponse;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.messages&&v.messages.length||(v.messages=[]),v.messages.push($root.OutgoingMessage.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.OutgoingMessage=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.id=f.newBuffer([]),_.prototype.body="",_.prototype.expiry=0,_.prototype.created=0,_.prototype.sender=null,_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.id!=null&&m.hasOwnProperty("id")&&S.uint32(10).bytes(m.id),m.body!=null&&m.hasOwnProperty("body")&&S.uint32(18).string(m.body),m.expiry!=null&&m.hasOwnProperty("expiry")&&S.uint32(24).uint32(m.expiry),m.created!=null&&m.hasOwnProperty("created")&&S.uint32(37).fixed32(m.created),m.sender!=null&&m.hasOwnProperty("sender")&&$root.Sender.encode(m.sender,S.uint32(42).fork()).ldelim(),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.OutgoingMessage;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.id=m.bytes();break;case 2:v.body=m.string();break;case 3:v.expiry=m.uint32();break;case 4:v.created=m.fixed32();break;case 5:v.sender=$root.Sender.decode(m,m.uint32());break;default:m.skipType(O&7);break}}return v},_}(),$root.ChannelStatsResponse=function(){function _(m){if(this.channels=[],m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.channels=f.emptyArray,_.create=function(m){return new _(m)},_.encode=function(m,S){if(S||(S=l.create()),m.channels!=null&&m.channels.length)for(var T=0;T<m.channels.length;++T)$root.ChannelStats.encode(m.channels[T],S.uint32(10).fork()).ldelim();return S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ChannelStatsResponse;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.channels&&v.channels.length||(v.channels=[]),v.channels.push($root.ChannelStats.decode(m,m.uint32()));break;default:m.skipType(O&7);break}}return v},_}(),$root.ChannelStats=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.id=f.newBuffer([]),_.prototype.isPrivate=!1,_.prototype.isOnline=!1,_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.id!=null&&m.hasOwnProperty("id")&&S.uint32(10).bytes(m.id),m.isPrivate!=null&&m.hasOwnProperty("isPrivate")&&S.uint32(16).bool(m.isPrivate),m.isOnline!=null&&m.hasOwnProperty("isOnline")&&S.uint32(24).bool(m.isOnline),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.ChannelStats;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.id=m.bytes();break;case 2:v.isPrivate=m.bool();break;case 3:v.isOnline=m.bool();break;default:m.skipType(O&7);break}}return v},_}(),$root.JsonResponse=function(){function _(m){if(m)for(var S=Object.keys(m),T=0;T<S.length;++T)m[S[T]]!=null&&(this[S[T]]=m[S[T]])}return _.prototype.json="",_.create=function(m){return new _(m)},_.encode=function(m,S){return S||(S=l.create()),m.json!=null&&m.hasOwnProperty("json")&&S.uint32(10).string(m.json),S},_.decode=function(m,S){m instanceof i||(m=i.create(m));for(var T=S===void 0?m.len:m.pos+S,v=new $root.JsonResponse;m.pos<T;){var O=m.uint32();switch(O>>>3){case 1:v.json=m.string();break;default:m.skipType(O&7);break}}return v},_}(),$root.Response;const ResponseBatch=$root.ResponseBatch;$root.Request;const RequestBatch=$root.RequestBatch;$root.IncomingMessagesRequest;const IncomingMessage=$root.IncomingMessage,Receiver=$root.Receiver;class AbstractConnector{_logger=null;_connected=!1;_connectionType;_disconnectCode=0;_disconnectReason="";_parent;_callbacks;constructor(m){this._parent=m.parent,this._connectionType=ConnectionType.Undefined,this._callbacks={onOpen:c$1.isFunction(m.onOpen)?m.onOpen:()=>{},onDisconnect:c$1.isFunction(m.onDisconnect)?m.onDisconnect:()=>{},onError:c$1.isFunction(m.onError)?m.onError:()=>{},onMessage:c$1.isFunction(m.onMessage)?m.onMessage:()=>{}}}setLogger(m){this._logger=m}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}destroy(){}get connected(){return this._connected}set connected(m){m!=this._connected&&(this._connected=m,this._connected?this._callbacks.onOpen():this._callbacks.onDisconnect({code:this.disconnectCode,reason:this.disconnectReason}))}get disconnectCode(){return this._disconnectCode}get disconnectReason(){return this._disconnectReason}get connectionPath(){return this._parent.getConnectionPath(this._connectionType)}}class WebSocketConnector extends AbstractConnector{_socket;_onSocketOpenHandler;_onSocketCloseHandler;_onSocketErrorHandler;_onSocketMessageHandler;constructor(m){super(m),this._connectionType=ConnectionType.WebSocket,this._socket=null,this._onSocketOpenHandler=this._onSocketOpen.bind(this),this._onSocketCloseHandler=this._onSocketClose.bind(this),this._onSocketErrorHandler=this._onSocketError.bind(this),this._onSocketMessageHandler=this._onSocketMessage.bind(this)}destroy(){super.destroy(),this._socket&&(this._socket.close(),this._socket=null)}connect(){if(this._socket){if(this._socket.readyState===1)return;this.clearEventListener(),this._socket.close(),this._socket=null}this._createSocket()}get socket(){return this._socket}disconnect(m,S){this._socket!==null&&(this.clearEventListener(),this._socket.close(m,S)),this._socket=null,this._disconnectCode=m,this._disconnectReason=S,this.connected=!1}send(m){return!this._socket||this._socket.readyState!==1?(this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: WebSocket is not connected`)),!1):(this._socket.send(m),!0)}_onSocketOpen(){this.connected=!0}_onSocketClose(m){this._socket=null,this._disconnectCode=Number(m.code),this._disconnectReason=m.reason,this.connected=!1}_onSocketError(m){this._callbacks.onError(new Error(`Socket error: ${m}`))}_onSocketMessage(m){this._callbacks.onMessage(m.data)}clearEventListener(){this._socket&&(this._socket.removeEventListener("open",this._onSocketOpenHandler),this._socket.removeEventListener("close",this._onSocketCloseHandler),this._socket.removeEventListener("error",this._onSocketErrorHandler),this._socket.removeEventListener("message",this._onSocketMessageHandler))}_createSocket(){if(this._socket)throw new Error("Socket already exists");if(!this.connectionPath)throw new Error("Websocket connection path is not defined");this._socket=new WebSocket(this.connectionPath),this._socket.binaryType="arraybuffer",this._socket.addEventListener("open",this._onSocketOpenHandler),this._socket.addEventListener("close",this._onSocketCloseHandler),this._socket.addEventListener("error",this._onSocketErrorHandler),this._socket.addEventListener("message",this._onSocketMessageHandler)}}const a=60;class LongPollingConnector extends AbstractConnector{_active;_requestTimeout;_failureTimeout;_xhr;_requestAborted;constructor(m){super(m),this._active=!1,this._connectionType=ConnectionType.LongPolling,this._requestTimeout=null,this._failureTimeout=null,this._xhr=this.createXhr(),this._requestAborted=!1}connect(){this._active=!0,this.performRequest()}disconnect(m,S){this._active=!1,this.clearTimeOut(),this._xhr&&(this._requestAborted=!0,this._xhr.abort()),this._disconnectCode=m,this._disconnectReason=S,this.connected=!1}performRequest(){if(this._active){if(!this.connectionPath)throw new Error("Long polling connection path is not defined");this._xhr.readyState!==0&&this._xhr.readyState!==4||(this.clearTimeOut(),this._failureTimeout=setTimeout(()=>{this.connected=!0},5e3),this._requestTimeout=setTimeout(this.onRequestTimeout.bind(this),a*1e3),this._xhr.open("GET",this.connectionPath),this._xhr.send())}}onRequestTimeout(){this._requestAborted=!0,this._xhr.abort(),this.performRequest()}onXhrReadyStateChange(){this._xhr.readyState===4&&((!this._requestAborted||this._xhr.status==200)&&this.onResponse(this._xhr.response),this._requestAborted=!1)}send(m){const S=this._parent.getPublicationPath();if(!S)return this.getLogger().error(new Error(`${h$1.getDateForLog()}: Pull: publication path is empty`)),!1;const T=new XMLHttpRequest;return T.open("POST",S),T.send(m),!0}onResponse(m){if(this.clearTimeOut(),this._xhr.status===200)this.connected=!0,c$1.isStringFilled(m)||m instanceof ArrayBuffer?this._callbacks.onMessage(m):this._parent.session.mid=null,this.performRequest();else if(this._xhr.status===304){if(this.connected=!0,this._xhr.getResponseHeader("Expires")==="Thu, 01 Jan 1973 11:11:01 GMT"){const S=this._xhr.getResponseHeader("Last-Message-Id");c$1.isStringFilled(S)&&this._parent.setLastMessageId(S||"")}this.performRequest()}else this._callbacks.onError(new Error("Could not connect to the server")),this.connected=!1}clearTimeOut(){this._failureTimeout&&(clearTimeout(this._failureTimeout),this._failureTimeout=null),this._requestTimeout&&(clearTimeout(this._requestTimeout),this._requestTimeout=null)}createXhr(){const m=new XMLHttpRequest;return this._parent.isProtobufSupported()&&!this._parent.isJsonRpc()&&(m.responseType="arraybuffer"),m.addEventListener("readystatechange",this.onXhrReadyStateChange.bind(this)),m}}const y=19,I=30*60,H=5e3,F=60*1e3,E=10,R=10,G="ping",J="pong",w="bx-pull-session",V=20,L={api:{},channels:{},publicChannels:{},server:{timeShift:0},clientId:null,jwt:null,exp:0};class PullClient{_logger=null;_restClient;_status;_context;_guestMode;_guestUserId;_userId;_configGetMethod;_getPublicListMethod;_siteId;_enabled;_unloading=!1;_starting=!1;_debug=!1;_connectionAttempt=0;_connectionType=ConnectionType.WebSocket;_reconnectTimeout=null;_restartTimeout=null;_restoreWebSocketTimeout=null;_skipStorageInit;_skipCheckRevision;_subscribers={};_watchTagsQueue=new Map;_watchUpdateInterval=174e4;_watchForceUpdateInterval=5e3;_configTimestamp=0;_session={mid:null,tag:null,time:null,history:{},lastMessageIds:[],messageCount:0};_connectors={[ConnectionType.Undefined]:null,[ConnectionType.WebSocket]:null,[ConnectionType.LongPolling]:null};_isSecure;_config=null;_storage=null;_sharedConfig;_channelManager;_jsonRpcAdapter=null;_checkInterval=null;_offlineTimeout=null;_watchUpdateTimeout=null;_pingWaitTimeout=null;_isManualDisconnect=!1;_loggingEnabled=!1;_onPingTimeoutHandler;_userStatusCallbacks={};_connectPromise=null;_startingPromise=null;constructor(m){this._restClient=m.b24,this._status=PullStatus.Offline,this._context="master",m.restApplication&&(typeof m.configGetMethod>"u"&&(m.configGetMethod="pull.application.config.get"),typeof m.skipCheckRevision>"u"&&(m.skipCheckRevision=!0),c$1.isStringFilled(m.restApplication)&&(m.siteId=m.restApplication),m.serverEnabled=!0),this._guestMode=m.guestMode?h$1.toBoolean(m.guestMode):!1,this._guestUserId=m.guestUserId?h$1.toInteger(m.guestUserId):0,this._guestMode&&this._guestUserId>0?this._userId=this._guestUserId:(this._guestMode=!1,this._userId=m.userId?h$1.toInteger(m.userId):0),this._siteId=m.siteId?m.siteId:"none",this._enabled=c$1.isUndefined(m.serverEnabled)?!0:m.serverEnabled===!0,this._configGetMethod=c$1.isStringFilled(m.configGetMethod)?m.configGetMethod||"":"pull.config.get",this._getPublicListMethod=c$1.isStringFilled(m.getPublicListMethod)?m.getPublicListMethod||"":"pull.channel.public.list",this._skipStorageInit=m.skipStorageInit===!0,this._skipCheckRevision=m.skipCheckRevision===!0,c$1.isUndefined(m.configTimestamp)||(this._configTimestamp=h$1.toInteger(m.configTimestamp)),this._isSecure=document?.location.href.indexOf("https")===0,this._userId&&!this._skipStorageInit&&(this._storage=new StorageManager({userId:this._userId,siteId:this._siteId})),this._sharedConfig=new SharedConfig({onWebSocketBlockChanged:this.onWebSocketBlockChanged.bind(this),storage:this._storage}),this._channelManager=new ChannelManager({b24:this._restClient,getPublicListMethod:this._getPublicListMethod}),this._loggingEnabled=this._sharedConfig.isLoggingEnabled(),this._onPingTimeoutHandler=this.onPingTimeout.bind(this)}setLogger(m){this._logger=m,this._jsonRpcAdapter?.setLogger(this.getLogger()),this._storage?.setLogger(this.getLogger()),this._sharedConfig.setLogger(this.getLogger()),this._channelManager.setLogger(this.getLogger()),this._connectors.webSocket?.setLogger(this.getLogger()),this._connectors.longPolling?.setLogger(this.getLogger())}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}destroy(){this.stop(CloseReasons.NORMAL_CLOSURE,"manual stop"),this.onBeforeUnload()}init(){this._connectors.webSocket=new WebSocketConnector({parent:this,onOpen:this.onWebSocketOpen.bind(this),onMessage:this.onIncomingMessage.bind(this),onDisconnect:this.onWebSocketDisconnect.bind(this),onError:this.onWebSocketError.bind(this)}),this._connectors.longPolling=new LongPollingConnector({parent:this,onOpen:this.onLongPollingOpen.bind(this),onMessage:this.onIncomingMessage.bind(this),onDisconnect:this.onLongPollingDisconnect.bind(this),onError:this.onLongPollingError.bind(this)}),this._connectionType=this.isWebSocketAllowed()?ConnectionType.WebSocket:ConnectionType.LongPolling,window.addEventListener("beforeunload",this.onBeforeUnload.bind(this)),window.addEventListener("offline",this.onOffline.bind(this)),window.addEventListener("online",this.onOnline.bind(this)),this._jsonRpcAdapter=new JsonRpc({connector:this._connectors.webSocket,handlers:{"incoming.message":this.handleRpcIncomingMessage.bind(this)}})}get connector(){return this._connectors[this._connectionType]}get status(){return this._status}set status(m){this._status!==m&&(this._status=m,this._offlineTimeout&&(clearTimeout(this._offlineTimeout),this._offlineTimeout=null),m===PullStatus.Offline?this.sendPullStatusDelayed(m,H):this.sendPullStatus(m))}get session(){return this._session}subscribe(m){if(!c$1.isPlainObject(m))return this.attachCommandHandler(m);if(m=m,m.type=m.type||SubscriptionType.Server,m.command=m.command||null,m.type==SubscriptionType.Server||m.type==SubscriptionType.Client){if(typeof m.moduleId>"u")throw new Error(`${h$1.getDateForLog()}: Pull.subscribe: parameter moduleId is not specified`);return typeof this._subscribers[m.type]>"u"&&(this._subscribers[m.type]={}),typeof this._subscribers[m.type][m.moduleId]>"u"&&(this._subscribers[m.type][m.moduleId]={callbacks:[],commands:{}}),m.command?(typeof this._subscribers[m.type][m.moduleId].commands[m.command]>"u"&&(this._subscribers[m.type][m.moduleId].commands[m.command]=[]),this._subscribers[m.type][m.moduleId].commands[m.command].push(m.callback),()=>{typeof m.type>"u"||typeof m.moduleId>"u"||typeof m.command>"u"||m.command===null||(this._subscribers[m.type][m.moduleId].commands[m.command]=this._subscribers[m.type][m.moduleId].commands[m.command].filter(S=>S!==m.callback))}):(this._subscribers[m.type][m.moduleId].callbacks.push(m.callback),()=>{typeof m.type>"u"||typeof m.moduleId>"u"||(this._subscribers[m.type][m.moduleId].callbacks=this._subscribers[m.type][m.moduleId].callbacks.filter(S=>S!==m.callback))})}else return typeof this._subscribers[m.type]>"u"&&(this._subscribers[m.type]=[]),this._subscribers[m.type].push(m.callback),()=>{typeof m.type>"u"||(this._subscribers[m.type]=this._subscribers[m.type].filter(S=>S!==m.callback))}}attachCommandHandler(m){if(typeof m.getModuleId!="function"||typeof m.getModuleId()!="string")return this.getLogger().error(`${h$1.getDateForLog()}: Pull.attachCommandHandler: result of handler.getModuleId() is not a string.`),()=>{};let S=SubscriptionType.Server;return typeof m.getSubscriptionType=="function"&&(S=m.getSubscriptionType()),this.subscribe({type:S,moduleId:m.getModuleId(),callback:T=>{let v=null;if(typeof m.getMap=="function"){const O=m.getMap();if(O&&typeof O=="object"){const A=O[T.command];typeof A=="function"?v=A.bind(m):typeof A=="string"&&typeof m[A]=="function"&&(v=m[A].bind(m))}}if(!v){const O=`handle${h$1.capitalize(T.command)}`;typeof m[O]=="function"&&(v=m[O].bind(m))}v&&(this._debug&&this._context!=="master"&&this.getLogger().warn(`${h$1.getDateForLog()}: Pull.attachCommandHandler: result of handler.getModuleId() is not a string`,T),v(T.params,T.extra,T.command))}})}async start(m=null){let S=!0;if(this.isConnected())return Promise.resolve(!0);if(this._starting&&this._startingPromise)return this._startingPromise;if(!this._userId)throw new Error("Not set userId");if(this._siteId==="none")throw new Error("Not set siteId");let T=!1;if(m&&c$1.isPlainObject(m)&&(typeof m?.skipReconnectToLastSession<"u"&&(T=m.skipReconnectToLastSession,delete m.skipReconnectToLastSession),this._config=m,S=!1),!this._enabled)return Promise.reject({ex:{error:"PULL_DISABLED",error_description:"Push & Pull server is disabled"}});const v=new Date().getTime();let O;return!T&&this._storage&&(O=this._storage.get(w,null)),c$1.isPlainObject(O)&&O.hasOwnProperty("ttl")&&O.ttl>=v&&(this._session.mid=O.mid),this._starting=!0,this._startingPromise=new Promise((A,C)=>{this.loadConfig("client_start").then(k=>{this.setConfig(k,S),this.init(),this.updateWatch(!0),this.startCheckConfig(),this.connect().then(()=>A(!0),$=>C($))}).catch(k=>{this._starting=!1,this.status=PullStatus.Offline,this.stopCheckConfig(),this.getLogger().error(`${h$1.getDateForLog()}: Pull: could not read push-server config `,k),C(k)})})}restart(m=CloseReasons.NORMAL_CLOSURE,S="manual restart"){this._restartTimeout&&(clearTimeout(this._restartTimeout),this._restartTimeout=null),this.getLogger().log(`${h$1.getDateForLog()}: Pull: restarting with code ${m}`),this.disconnect(m,S),this._storage&&this._storage.remove(LsKeys.PullConfig),this._config=null;const T=`${m}_${S.replaceAll(" ","_")}`;this.loadConfig(T).then(v=>{this.setConfig(v,!0),this.updateWatch(),this.startCheckConfig(),this.connect().catch(O=>{this.getLogger().error(O)})},v=>{this.getLogger().error(`${h$1.getDateForLog()}: Pull: could not read push-server config `,v),this.status=PullStatus.Offline,this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null),(v?.status==401||v?.status==403)&&(this.stopCheckConfig(),this.onCustomEvent("onPullError",["AUTHORIZE_ERROR"]))})}stop(m=CloseReasons.NORMAL_CLOSURE,S="manual stop"){this.disconnect(m,S),this.stopCheckConfig()}reconnect(m,S,T=1){this.disconnect(m,S),this.scheduleReconnect(T)}setLastMessageId(m){this._session.mid=m}async sendMessage(m,S,T,v,O){const A={userList:m,body:{module_id:S,command:T,params:v},expiry:O};return this.isJsonRpc()?this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.Publish,A):this.sendMessageBatch([A])}async sendMessageToChannels(m,S,T,v,O){const A={channelList:m,body:{module_id:S,command:T,params:v},expiry:O};return this.isJsonRpc()?this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.Publish,A):this.sendMessageBatch([A])}capturePullEvent(m=!0){this._debug=m}enableLogging(m=!0){this._sharedConfig.setLoggingEnabled(m),this._loggingEnabled=m}async listChannels(){return this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.ListChannels,{})||Promise.reject(new Error("jsonRpcAdapter not init"))}async getUsersLastSeen(m){if(!c$1.isArray(m)||!m.every(T=>typeof T=="number"))throw new Error("userList must be an array of numbers");let S={};return new Promise((T,v)=>{this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.GetUsersLastSeen,{userList:m}).then(O=>{let A=[];for(let k=0;k<m.length;k++)O.hasOwnProperty(m[k])||A.push(m[k]);if(A.length===0)return T(S);const C={userIds:A,sendToQueueSever:!0};this._restClient.callMethod("pull.api.user.getLastSeen",C).then(k=>{let $=k.getData().result;for(let M in $)S[Number(M)]=Number($[M]);return T(S)}).catch(k=>{this.getLogger().error(k),v(k)})}).catch(O=>{this.getLogger().error(O),v(O)})})}async ping(m=5){return this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.Ping,{},m)}async subscribeUserStatusChange(m,S){return new Promise((T,v)=>{this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.SubscribeStatusChange,{userId:m}).then(()=>(this._userStatusCallbacks[m]||(this._userStatusCallbacks[m]=[]),c$1.isFunction(S)&&this._userStatusCallbacks[m].push(S),T())).catch(O=>v(O))})}async unsubscribeUserStatusChange(m,S){return this._userStatusCallbacks[m]&&(this._userStatusCallbacks[m]=this._userStatusCallbacks[m].filter(T=>T!==S),this._userStatusCallbacks[m].length===0)?this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.UnsubscribeStatusChange,{userId:m}):Promise.resolve()}getRevision(){return this._config&&this._config.api?this._config.api.revision_web:null}getServerVersion(){return this._config&&this._config.server?this._config.server.version:0}getServerMode(){return this._config&&this._config.server?this._config.server.mode:null}getConfig(){return this._config}getDebugInfo(){if(!JSON||!JSON.stringify)return{};let m;this._config&&this._config.channels?m={ChannelID:this._config.channels.private?.id||"n/a",ChannelDie:this._config.channels.private?.end||"n/a",ChannelDieShared:this._config.channels.shared?.end||"n/a"}:m={ConfigError:"config is not loaded"};let S="-";return this._connectors.webSocket&&this._connectors.webSocket?.socket&&(this.isJsonRpc()?S="json-rpc":S=this._connectors.webSocket?.socket?.url.search("binaryMode=true")!=-1?"protobuf":"text"),{UserId:this._userId+(this._userId>0?"":"(guest)"),"Guest userId":this._guestMode&&this._guestUserId!==0?this._guestUserId:"-","Browser online":navigator.onLine?"Y":"N",Connect:this.isConnected()?"Y":"N","Server type":this.isSharedMode()?"cloud":"local","WebSocket supported":this.isWebSocketSupported()?"Y":"N","WebSocket connected":this._connectors.webSocket&&this._connectors.webSocket.connected?"Y":"N","WebSocket mode":S,"Try connect":this._reconnectTimeout?"Y":"N","Try number":this._connectionAttempt,Path:this.connector?.connectionPath||"-",...m,"Last message":this._session.mid?this._session.mid:"-","Session history":this._session.history,"Watch tags":this._watchTagsQueue.entries()}}getConnectionPath(m){let S,T={};switch(m){case ConnectionType.WebSocket:S=this._isSecure?this._config?.server.websocket_secure:this._config?.server.websocket;break;case ConnectionType.LongPolling:S=this._isSecure?this._config?.server.long_pooling_secure:this._config?.server.long_polling;break;default:throw new Error(`Unknown connection type ${m}`)}if(!c$1.isStringFilled(S))throw new Error("Empty path");if(typeof this._config?.jwt=="string"&&this._config?.jwt!=="")T.token=this._config?.jwt;else{let v=[];if(this._config?.channels?.private&&v.push(this._config.channels.private?.id||""),this._config?.channels.private?.id&&v.push(this._config.channels.private.id),this._config?.channels.shared?.id&&v.push(this._config.channels.shared.id),v.length===0)throw new Error("Empty channels");T.CHANNEL_ID=v.join("/")}if(this.isJsonRpc()?T.jsonRpc="true":this.isProtobufSupported()&&(T.binaryMode="true"),this.isSharedMode()){if(!this._config?.clientId)throw new Error("Push-server is in shared mode, but clientId is not set");T.clientId=this._config.clientId}return this._session.mid&&(T.mid=this._session.mid),this._session.tag&&(T.tag=this._session.tag),this._session.time&&(T.time=this._session.time),T.revision=y,`${S}?${h$1.buildQueryString(T)}`}getPublicationPath(){const m=this._isSecure?this._config?.server.publish_secure:this._config?.server.publish;if(!m)return"";let S=[];this._config?.channels.private?.id&&S.push(this._config.channels.private.id),this._config?.channels.shared?.id&&S.push(this._config.channels.shared.id);const T={CHANNEL_ID:S.join("/")};return m+"?"+h$1.buildQueryString(T)}isConnected(){return this.connector?this.connector.connected:!1}isWebSocketSupported(){return typeof window.WebSocket<"u"}isWebSocketAllowed(){return this._sharedConfig.isWebSocketBlocked()?!1:this.isWebSocketEnabled()}isWebSocketEnabled(){return!this.isWebSocketSupported()||!this._config||!this._config.server?!1:this._config.server.websocket_enabled}isPublishingSupported(){return this.getServerVersion()>3}isPublishingEnabled(){return this.isPublishingSupported()?this._config?.server.publish_enabled===!0:!1}isProtobufSupported(){return this.getServerVersion()==4&&!s.isIE()}isJsonRpc(){return this.getServerVersion()>=5}isSharedMode(){return this.getServerMode()===ServerMode.Shared}emit(m){if(m.type==SubscriptionType.Server||m.type==SubscriptionType.Client){if(typeof this._subscribers[m.type]>"u"&&(this._subscribers[m.type]={}),typeof m.moduleId>"u")throw new Error(`${h$1.getDateForLog()}: Pull.emit: parameter moduleId is not specified`);return typeof this._subscribers[m.type][m.moduleId]>"u"&&(this._subscribers[m.type][m.moduleId]={callbacks:[],commands:{}}),this._subscribers[m.type][m.moduleId].callbacks.length>0&&this._subscribers[m.type][m.moduleId].callbacks.forEach(S=>{S(m.data,{type:m.type,moduleId:m.moduleId})}),!(typeof m.data>"u")&&!(typeof m.data.command>"u")&&this._subscribers[m.type][m.moduleId].commands[m.data.command]&&this._subscribers[m.type][m.moduleId].commands[m.data.command].length>0&&this._subscribers[m.type][m.moduleId].commands[m.data.command].forEach(S=>{typeof m.data>"u"||S(m.data.params,m.data.extra,m.data.command,{type:m.type,moduleId:m.moduleId})}),!0}else return typeof this._subscribers[m.type]>"u"&&(this._subscribers[m.type]=[]),this._subscribers[m.type].length<=0||this._subscribers[m.type].forEach(S=>{S(m.data,{type:m.type})}),!0}broadcastMessage(m){const S=m.module_id=m.module_id.toLowerCase(),T=m.command;m.extra||(m.extra={}),m.extra.server_time_unix&&(m.extra.server_time_ago=(new Date().getTime()-m.extra.server_time_unix*1e3)/1e3-(this._config?.server.timeShift?this._config?.server.timeShift:0),m.extra.server_time_ago=m.extra.server_time_ago>0?m.extra.server_time_ago:0),this.logMessage(m);try{m.extra.sender&&m.extra.sender.type===SenderType.Client?(this.onCustomEvent("onPullClientEvent-"+S,[T,m.params,m.extra],!0),this.onCustomEvent("onPullClientEvent",[S,T,m.params,m.extra],!0),this.emit({type:SubscriptionType.Client,moduleId:S,data:{command:T,params:c$1.clone(m.params),extra:c$1.clone(m.extra)}})):S==="pull"?this.handleInternalPullEvent(T,m):S=="online"?((m?.extra?.server_time_ago||0)<240&&(this.onCustomEvent("onPullOnlineEvent",[T,m.params,m.extra],!0),this.emit({type:SubscriptionType.Online,data:{command:T,params:c$1.clone(m.params),extra:c$1.clone(m.extra)}})),T==="userStatusChange"&&this.emitUserStatusChange(m.params.user_id,m.params.online)):(this.onCustomEvent("onPullEvent-"+S,[T,m.params,m.extra],!0),this.onCustomEvent("onPullEvent",[S,T,m.params,m.extra],!0),this.emit({type:SubscriptionType.Server,moduleId:S,data:{command:T,params:c$1.clone(m.params),extra:c$1.clone(m.extra)}}))}catch(v){this.getLogger().warn(`
========= PULL ERROR ===========
Error type: broadcastMessages execute error
Error event: `,v,`
Message: `,m,`
================================
`)}m.extra&&m.extra.revision_web&&this.checkRevision(h$1.toInteger(m.extra.revision_web))}broadcastMessages(m){m.forEach(S=>this.broadcastMessage(S))}async sendMessageBatch(m){if(!this.isPublishingEnabled())return this.getLogger().error("Client publishing is not supported or is disabled"),Promise.reject(new Error("Client publishing is not supported or is disabled"));if(this.isJsonRpc()){let S=this._jsonRpcAdapter?.createPublishRequest(m);return this.connector?.send(JSON.stringify(S)),Promise.resolve(!0)}else{let S={};for(let T=0;T<m.length;T++){const v=m[T];if(typeof v.userList<"u"){const O=v.userList.length;for(let A=0;A<O;A++){const C=Number(v.userList[A]);S[C]=C}}}this._channelManager?.getPublicIds(Object.values(S)).then(T=>{const v=this.connector?.send(this.encodeMessageBatch(m,T));return Promise.resolve(v)})}}encodeMessageBatch(m,S){let T=[];m.forEach(O=>{const A=O.body;let C=[];if(O.userList&&(C=this.createMessageReceivers(O.userList,S)),O.channelList){if(!c$1.isArray(O.channelList))throw new Error("messageFields.publicChannels must be an array");O.channelList.forEach($=>{let M,P;if(typeof $=="string"&&$.includes(".")){const U=$.toString().split(".");M=U[0],P=U[1]}else if(typeof $=="object"&&"publicId"in $&&"signature"in $)M=$?.publicId,P=$?.signature;else throw new Error(`Public channel MUST be either a string, formatted like "{publicId}.{signature}" or an object with fields 'publicId' and 'signature'`);C.push(Receiver.create({id:this.encodeId(M),signature:this.encodeId(P)}))})}const k=IncomingMessage.create({receivers:C,body:JSON.stringify(A),expiry:O.expiry||0});T.push(k)});const v=RequestBatch.create({requests:[{incomingMessages:{messages:T}}]});return RequestBatch.encode(v).finish()}createMessageReceivers(m,S){let T=[];for(let v=0;v<m.length;v++){let O=m[v];if(!S[O]||!S[O].publicId)throw new Error(`Could not determine public id for user ${O}`);T.push(Receiver.create({id:this.encodeId(S[O].publicId),signature:this.encodeId(S[O].signature)}))}return T}emitUserStatusChange(m,S){this._userStatusCallbacks[m]&&this._userStatusCallbacks[m].forEach(T=>T({userId:m,isOnline:S}))}restoreUserStatusSubscription(){for(const m in this._userStatusCallbacks)this._userStatusCallbacks.hasOwnProperty(m)&&this._userStatusCallbacks[m].length>0&&this._jsonRpcAdapter?.executeOutgoingRpcCommand(RpcMethod.SubscribeStatusChange,{userId:m})}async loadConfig(m){if(this._config){if(this.isConfigActual(this._config)&&this.checkRevision(this._config.api.revision_web))return Promise.resolve(this._config);this._config=Object.assign({},L)}else{this._config=Object.assign({},L);let S;if(this._storage&&(S=this._storage.get(LsKeys.PullConfig,null)),this.isConfigActual(S)&&this.checkRevision(S.api.revision_web))return Promise.resolve(S);this._storage&&this._storage.remove(LsKeys.PullConfig)}return new Promise((S,T)=>{this._restClient.getHttpClient().setLogTag(m),this._restClient.callMethod(this._configGetMethod,{CACHE:"N"}).then(v=>{const O=v.getData().result;let A;A=Math.floor((new Date().getTime()-new Date(O.serverTime).getTime())/1e3),delete O.serverTime;let C=Object.assign({},O);C.server.timeShift=A,S(C)}).catch(v=>{(v?.answerError?.error==="AUTHORIZE_ERROR"||v?.answerError?.error==="WRONG_AUTH_TYPE")&&(v.status=403),T(v)}).finally(()=>{this._restClient.getHttpClient().clearLogTag()})})}isConfigActual(m){if(!c$1.isPlainObject(m)||Number(m.server.config_timestamp)!==this._configTimestamp)return!1;const S=new Date;if(c$1.isNumber(m.exp)&&m.exp>0&&m.exp<S.getTime()/1e3||Object.keys(m.channels).length===0)return!1;for(let T in m.channels){if(!m.channels.hasOwnProperty(T))continue;const v=m.channels[T];if(new Date(v.end)<S)return!1}return!0}startCheckConfig(){this._checkInterval&&(clearInterval(this._checkInterval),this._checkInterval=null),this._checkInterval=setInterval(this.checkConfig.bind(this),F)}stopCheckConfig(){this._checkInterval&&clearInterval(this._checkInterval),this._checkInterval=null}checkConfig(){if(this.isConfigActual(this._config)){if(!this.checkRevision(h$1.toInteger(this._config?.api.revision_web)))return!1}else this.logToConsole("Stale config detected. Restarting"),this.restart(CloseReasons.CONFIG_EXPIRED,"config expired");return!0}setConfig(m,S){for(let T in m)m.hasOwnProperty(T)&&this._config?.hasOwnProperty(T)&&(this._config[T]=m[T]);if(m.publicChannels&&this.setPublicIds(Array.from(Object.values(m.publicChannels))),this._configTimestamp=Number(m.server.config_timestamp),this._storage&&S)try{this._storage.set(LsKeys.PullConfig,m)}catch(T){localStorage&&localStorage.removeItem&&localStorage.removeItem("history"),this.getLogger().error(`${h$1.getDateForLog()}: Pull: Could not cache config in local storage. Error: `,T)}}setPublicIds(m){this._channelManager.setPublicIds(m)}checkRevision(m){return this._skipCheckRevision?!0:m>0&&m!==y?(this._enabled=!1,this.showNotification("PULL_OLD_REVISION"),this.disconnect(CloseReasons.NORMAL_CLOSURE,"check_revision"),this.onCustomEvent("onPullRevisionUp",[m,y]),this.emit({type:SubscriptionType.Revision,data:{server:m,client:y}}),this.logToConsole(`Pull revision changed from ${y} to ${m}. Reload required`),!1):!0}disconnect(m,S){this.connector&&(this._isManualDisconnect=!0,this.connector.disconnect(m,S))}restoreWebSocketConnection(){this._connectionType!==ConnectionType.WebSocket&&this._connectors.webSocket?.connect()}scheduleReconnect(m=0){this._enabled&&(m||(m=this.getConnectionAttemptDelay(this._connectionAttempt)),this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null),this.logToConsole(`Pull: scheduling reconnection in ${m} seconds; attempt # ${this._connectionAttempt}`),this._reconnectTimeout=setTimeout(()=>{this.connect().catch(S=>{this.getLogger().error(S)})},m*1e3))}scheduleRestoreWebSocketConnection(){this.logToConsole(`Pull: scheduling restoration of websocket connection in ${I} seconds`),!this._restoreWebSocketTimeout&&(this._restoreWebSocketTimeout=setTimeout(()=>{this._restoreWebSocketTimeout=0,this.restoreWebSocketConnection()},I*1e3))}async connect(){return this._enabled?this.connector?.connected?Promise.resolve():(this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null),this.status=PullStatus.Connecting,this._connectionAttempt++,new Promise((m,S)=>{this._connectPromise={resolve:m,reject:S},this.connector?.connect()})):Promise.reject()}scheduleRestart(m,S,T=0){this._restartTimeout&&(clearTimeout(this._restartTimeout),this._restartTimeout=null),T<1&&(T=Math.ceil(Math.random()*30)+5),this._restartTimeout=setTimeout(()=>this.restart(m,S),T*1e3)}handleRpcIncomingMessage(m){this._session.mid=m.mid;let S=m.body;return m.body.extra||(S.extra={}),S.extra.sender=m.sender,"user_params"in m&&c$1.isPlainObject(m.user_params)&&Object.assign(S.params,m.user_params),"dictionary"in m&&c$1.isPlainObject(m.dictionary)&&Object.assign(S.params,m.dictionary),this.checkDuplicate(m.mid)&&(this.addMessageToStat(S),this.trimDuplicates(),this.broadcastMessage(S)),this.connector?.send(`mack:${m.mid}`),{}}handleIncomingEvents(m){let S=[];if(m.length===0){this._session.mid=null;return}for(let T=0;T<m.length;T++){let v=m[T];this.updateSessionFromEvent(v),!(v.mid&&!this.checkDuplicate(v.mid))&&(this.addMessageToStat(v.text),S.push(v.text))}this.trimDuplicates(),this.broadcastMessages(S)}updateSessionFromEvent(m){this._session.mid=m.mid||null,this._session.tag=m.tag||null,this._session.time=m.time||null}handleInternalPullEvent(m,S){switch(m.toUpperCase()){case SystemCommands.CHANNEL_EXPIRE:{if(S.params.action==="reconnect"){const T=S.params?.channel.type;T==="private"&&this._config?.channels?.private&&(this._config.channels.private=S.params.new_channel,this.logToConsole(`Pull: new config for ${S.params.channel.type} channel set: ${this._config.channels.private}`)),T==="shared"&&this._config?.channels?.shared&&(this._config.channels.shared=S.params.new_channel,this.logToConsole(`Pull: new config for ${S.params.channel.type} channel set: ${this._config.channels.shared}`)),this.reconnect(CloseReasons.CONFIG_REPLACED,"config was replaced")}else this.restart(CloseReasons.CHANNEL_EXPIRED,"channel expired received");break}case SystemCommands.CONFIG_EXPIRE:{this.restart(CloseReasons.CONFIG_EXPIRED,"config expired received");break}case SystemCommands.SERVER_RESTART:{this.reconnect(CloseReasons.SERVER_RESTARTED,"server was restarted",15);break}}}onIncomingMessage(m){if(this.isJsonRpc())m===G?this.onJsonRpcPing():this._jsonRpcAdapter?.parseJsonRpcMessage(m);else{const S=this.extractMessages(m);this.handleIncomingEvents(S)}}onLongPollingOpen(){this._unloading=!1,this._starting=!1,this._connectionAttempt=0,this._isManualDisconnect=!1,this.status=PullStatus.Online,this.logToConsole("Pull: Long polling connection with push-server opened"),this.isWebSocketEnabled()&&this.scheduleRestoreWebSocketConnection(),this._connectPromise&&this._connectPromise.resolve({})}onLongPollingDisconnect(m){this._connectionType===ConnectionType.LongPolling&&(this.status=PullStatus.Offline),this.logToConsole(`Pull: Long polling connection with push-server closed. Code: ${m.code}, reason: ${m.reason}`),this._isManualDisconnect||this.scheduleReconnect(),this._isManualDisconnect=!1,this.clearPingWaitTimeout()}onLongPollingError(m){this._starting=!1,this._connectionType===ConnectionType.LongPolling&&(this.status=PullStatus.Offline),this.getLogger().error(`${h$1.getDateForLog()}: Pull: Long polling connection error `,m),this.scheduleReconnect(),this._connectPromise&&this._connectPromise.reject(m),this.clearPingWaitTimeout()}onWebSocketBlockChanged(m){const S=m.isWebSocketBlocked;S&&this._connectionType===ConnectionType.WebSocket&&!this.isConnected()?(this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null),this._connectionAttempt=0,this._connectionType=ConnectionType.LongPolling,this.scheduleReconnect(1)):!S&&this._connectionType===ConnectionType.LongPolling&&(this._reconnectTimeout&&(clearTimeout(this._reconnectTimeout),this._reconnectTimeout=null),this._restoreWebSocketTimeout&&(clearTimeout(this._restoreWebSocketTimeout),this._restoreWebSocketTimeout=null),this._connectionAttempt=0,this._connectionType=ConnectionType.WebSocket,this.scheduleReconnect(1))}onWebSocketOpen(){this._unloading=!1,this._starting=!1,this._connectionAttempt=0,this._isManualDisconnect=!1,this.status=PullStatus.Online,this._sharedConfig.setWebSocketBlocked(!1),this._sharedConfig.setLongPollingBlocked(!0),this._connectionType==ConnectionType.LongPolling&&(this._connectionType=ConnectionType.WebSocket,this._connectors.longPolling?.disconnect(CloseReasons.CONFIG_REPLACED,"Fire at onWebSocketOpen")),this._restoreWebSocketTimeout&&(clearTimeout(this._restoreWebSocketTimeout),this._restoreWebSocketTimeout=null),this.logToConsole("Pull: Websocket connection with push-server opened"),this._connectPromise&&this._connectPromise.resolve({}),this.restoreUserStatusSubscription()}onWebSocketDisconnect(m){this._connectionType===ConnectionType.WebSocket&&(this.status=PullStatus.Offline),this.logToConsole(`Pull: Websocket connection with push-server closed. Code: ${m.code}, reason: ${m.reason}`,!0),this._isManualDisconnect||(m.code==CloseReasons.WRONG_CHANNEL_ID?this.scheduleRestart(CloseReasons.WRONG_CHANNEL_ID,"wrong channel signature"):this.scheduleReconnect()),this._sharedConfig.setLongPollingBlocked(!0),this._isManualDisconnect=!1,this.clearPingWaitTimeout()}onWebSocketError(m){this._starting=!1,this._connectionType===ConnectionType.WebSocket&&(this.status=PullStatus.Offline),this.getLogger().error(`${h$1.getDateForLog()}: Pull: WebSocket connection error `,m),this.scheduleReconnect(),this._connectPromise&&this._connectPromise.reject(m),this.clearPingWaitTimeout()}extractMessages(m){if(m instanceof ArrayBuffer)return this.extractProtobufMessages(m);if(c$1.isStringFilled(m))return this.extractPlainTextMessages(m);throw new Error("Error pullEvent type")}extractProtobufMessages(m){let S=[];try{let T=ResponseBatch.decode(new Uint8Array(m));for(let v=0;v<T.responses.length;v++){let O=T.responses[v];if(O.command!=="outgoingMessages")continue;let A=O.outgoingMessages.messages;for(let C=0;C<A.length;C++){const k=A[C];let $;try{$=JSON.parse(k.body)}catch(P){this.getLogger().error(`${h$1.getDateForLog()}: Pull: Could not parse message body `,P);continue}$.extra||($.extra={}),$.extra.sender={type:k.sender.type},k.sender.id instanceof Uint8Array&&($.extra.sender.id=this.decodeId(k.sender.id));const M={mid:this.decodeId(k.id),text:$};S.push(M)}}}catch(T){this.getLogger().error(`${h$1.getDateForLog()}: Pull: Could not parse message `,T)}return S}extractPlainTextMessages(m){let S=[];const T=m.match(/#!NGINXNMS!#(.*?)#!NGINXNME!#/gm);if(T===null){const v=`
========= PULL ERROR ===========
Error type: parseResponse error parsing message

Data string: ${m}
================================

`;return this.getLogger().warn(v),[]}for(let v=0;v<T.length;v++){if(T[v]=T[v].substring(12,T[v].length-12),T[v].length<=0)continue;let O;try{O=JSON.parse(T[v])}catch{continue}S.push(O)}return S}decodeId(m){let S="";for(let T=0;T<m.length;T++){const v=m[T].toString(16);v.length===1&&(S+="0"),S+=v}return S}encodeId(m){if(!m)return new Uint8Array;let S=[];for(let T=0;T<m.length;T+=2)S.push(parseInt(m.substring(T,2),16));return new Uint8Array(S)}onOffline(){this.disconnect(CloseReasons.NORMAL_CLOSURE,"offline")}onOnline(){this.connect().catch(m=>{this.getLogger().error(m)})}onBeforeUnload(){this._unloading=!0;const m=c$1.clone(this.session);if(m.ttl=new Date().getTime()+V*1e3,this._storage)try{this._storage.set(w,JSON.stringify(m))}catch(S){this.getLogger().error(`${h$1.getDateForLog()}: Pull: Could not save session info in local storage. Error: `,S)}this.scheduleReconnect(15)}sendPullStatusDelayed(m,S){this._offlineTimeout&&(clearTimeout(this._offlineTimeout),this._offlineTimeout=null),this._offlineTimeout=setTimeout(()=>{this._offlineTimeout=null,this.sendPullStatus(m)},S)}sendPullStatus(m){this._unloading||(this.onCustomEvent("onPullStatus",[m]),this.emit({type:SubscriptionType.Status,data:{status:m}}))}extendWatch(m,S=!1){this._watchTagsQueue.get(m)||(this._watchTagsQueue.set(m,!0),S&&this.updateWatch(S))}updateWatch(m=!1){this._watchUpdateTimeout&&(clearTimeout(this._watchUpdateTimeout),this._watchUpdateTimeout=null),this._watchUpdateTimeout=setTimeout(()=>{const S=Array.from(this._watchTagsQueue.keys());S.length>0?this._restClient.callMethod("pull.watch.extend",{tags:S}).then(T=>{T.getData().result.forEach(v=>this.clearWatch(v)),this.updateWatch()}).catch(()=>{this.updateWatch()}):this.updateWatch()},m?this._watchForceUpdateInterval:this._watchUpdateInterval)}clearWatch(m){this._watchTagsQueue.delete(m)}onJsonRpcPing(){this.updatePingWaitTimeout(),this.connector?.send(J)}updatePingWaitTimeout(){this._pingWaitTimeout&&(clearTimeout(this._pingWaitTimeout),this._pingWaitTimeout=null),this._pingWaitTimeout=setTimeout(this._onPingTimeoutHandler,R*2*1e3)}clearPingWaitTimeout(){this._pingWaitTimeout&&clearTimeout(this._pingWaitTimeout),this._pingWaitTimeout=null}onPingTimeout(){this._pingWaitTimeout=null,!(!this._enabled||!this.isConnected())&&(this.getLogger().warn(`No pings are received in ${R*2} seconds. Reconnecting`),this.disconnect(CloseReasons.STUCK,"connection stuck"),this.scheduleReconnect())}getConnectionAttemptDelay(m){let S;return m<1?S=.5:m<3?S=15:m<5?S=45:m<10?S=600:S=3600,S+S*Math.random()*.2}checkDuplicate(m){return this._session.lastMessageIds.includes(m)?(this.getLogger().warn(`Duplicate message ${m} skipped`),!1):(this._session.lastMessageIds.push(m),!0)}trimDuplicates(){this._session.lastMessageIds.length>E&&(this._session.lastMessageIds=this._session.lastMessageIds.slice(-E))}logMessage(m){this._debug&&(m.extra?.sender&&m.extra.sender.type===SenderType.Client?this.getLogger().info(`onPullClientEvent-${m.module_id}`,m.command,m.params,m.extra):m.module_id=="online"?this.getLogger().info("onPullOnlineEvent",m.command,m.params,m.extra):this.getLogger().info("onPullEvent",m.module_id,m.command,m.params,m.extra))}logToConsole(m,S=!1){(this._loggingEnabled||S)&&this.getLogger().log(`${h$1.getDateForLog()}: ${m}`)}addMessageToStat(m){this._session.history[m.module_id]||(this._session.history[m.module_id]={}),this._session.history[m.module_id][m.command]||(this.session.history[m.module_id][m.command]=0),this._session.history[m.module_id][m.command]++,this._session.messageCount++}showNotification(m){this.getLogger().warn(m)}onCustomEvent(m,S,T=!1){}}class B24HelperManager{_b24;_logger=null;_isInit=!1;_profile=null;_app=null;_payment=null;_license=null;_currency=null;_appOptions=null;_userOptions=null;_b24PullClient=null;_pullClientUnSubscribe=[];_pullClientModuleId="";constructor(m){this._b24=m,this.setLogger(this._b24.getLogger())}setLogger(m){this._logger=m,this._profile!==null&&this._profile.setLogger(this.getLogger()),this._app!==null&&this._app.setLogger(this.getLogger()),this._payment!==null&&this._payment.setLogger(this.getLogger()),this._license!==null&&this._license.setLogger(this.getLogger()),this._currency!==null&&this._currency.setLogger(this.getLogger()),this._appOptions!==null&&this._appOptions.setLogger(this.getLogger()),this._userOptions!==null&&this._userOptions.setLogger(this.getLogger())}getLogger(){return this._logger===null&&(this._logger=LoggerBrowser.build("NullLogger"),this._logger.setConfig({[LoggerType.desktop]:!1,[LoggerType.log]:!1,[LoggerType.info]:!1,[LoggerType.warn]:!1,[LoggerType.error]:!0,[LoggerType.trace]:!1})),this._logger}destroy(){this._destroyPullClient()}async loadData(m=[LoadDataType.App,LoadDataType.Profile]){const S={[LoadDataType.App]:{method:"app.info"},[LoadDataType.Profile]:{method:"profile"},[LoadDataType.Currency]:[{method:"crm.currency.base.get"},{method:"crm.currency.list"}],[LoadDataType.AppOptions]:{method:"app.option.get"},[LoadDataType.UserOptions]:{method:"user.option.get"}},T=m.reduce((v,O)=>(S[O]&&(Array.isArray(S[O])?S[O].forEach((A,C)=>{v[`get_${O}_${C}`]=A}):v[`get_${O}`]=S[O]),v),{});try{const v=(await this._b24.callBatch(T)).getData();v[`get_${LoadDataType.App}`]&&(this._app=await this.parseAppData(v[`get_${LoadDataType.App}`]),this._payment=await this.parsePaymentData(v[`get_${LoadDataType.App}`]),this._license=await this.parseLicenseData(v[`get_${LoadDataType.App}`])),v[`get_${LoadDataType.Profile}`]&&(this._profile=await this.parseUserData(v[`get_${LoadDataType.Profile}`])),v[`get_${LoadDataType.Currency}_0`]&&v[`get_${LoadDataType.Currency}_1`]&&(this._currency=await this.parseCurrencyData({currencyBase:v[`get_${LoadDataType.Currency}_0`],currencyList:v[`get_${LoadDataType.Currency}_1`]})),v[`get_${LoadDataType.AppOptions}`]&&(this._appOptions=await this.parseOptionsData("app",v[`get_${LoadDataType.AppOptions}`])),v[`get_${LoadDataType.UserOptions}`]&&(this._userOptions=await this.parseOptionsData("user",v[`get_${LoadDataType.UserOptions}`])),this._isInit=!0}catch(v){throw console.error("Error loading data:",v),new Error("Failed to load data")}}async parseUserData(m){const S=new ProfileManager(this._b24);return S.setLogger(this.getLogger()),S.initData({id:Number(m.ID),isAdmin:m.ADMIN===!0,lastName:m?.LAST_NAME||"",name:m?.NAME||"",gender:m?.PERSONAL_GENDER||"",photo:m?.PERSONAL_PHOTO||"",TimeZone:m?.TIME_ZONE||"",TimeZoneOffset:m?.TIME_ZONE_OFFSET}).then(()=>S)}async parseAppData(m){const S=new AppManager(this._b24);return S.setLogger(this.getLogger()),S.initData({id:parseInt(m.ID),code:m.CODE,version:parseInt(m.VERSION),status:m.STATUS,isInstalled:m.INSTALLED}).then(()=>S)}async parsePaymentData(m){const S=new PaymentManager(this._b24);return S.setLogger(this.getLogger()),S.initData({isExpired:m.PAYMENT_EXPIRED==="Y",days:parseInt(m.DAYS||"0")}).then(()=>S)}async parseLicenseData(m){const S=new LicenseManager(this._b24);return S.setLogger(this.getLogger()),S.initData({languageId:m.LANGUAGE_ID,license:m.LICENSE,licensePrevious:m.LICENSE_PREVIOUS,licenseType:m.LICENSE_TYPE,licenseFamily:m.LICENSE_FAMILY,isSelfHosted:m.LICENSE.includes("selfhosted")}).then(()=>S)}async parseCurrencyData(m){const S=new CurrencyManager(this._b24);return S.setLogger(this.getLogger()),S.initData(m).then(()=>S)}async parseOptionsData(m,S){const T=new OptionsManager(this._b24,m);return T.setLogger(this.getLogger()),T.initData(S).then(()=>T)}get isInit(){return this._isInit}get forB24Form(){if(this.ensureInitialized(),this._profile===null)throw new Error("B24HelperManager.profileInfo not initialized");if(this._app===null)throw new Error("B24HelperManager.appInfo not initialized");return{app_code:this.appInfo.data.code,app_status:this.appInfo.data.status,payment_expired:this.paymentInfo.data.isExpired?"Y":"N",days:this.paymentInfo.data.days,b24_plan:this.licenseInfo.data.license,c_name:this.profileInfo.data.name,c_last_name:this.profileInfo.data.lastName,hostname:this.hostName}}get hostName(){return this._b24.getTargetOrigin()}get profileInfo(){if(this.ensureInitialized(),this._profile===null)throw new Error("B24HelperManager.profileInfo not initialized");return this._profile}get appInfo(){if(this.ensureInitialized(),this._app===null)throw new Error("B24HelperManager.appInfo not initialized");return this._app}get paymentInfo(){if(this.ensureInitialized(),this._payment===null)throw new Error("B24HelperManager.paymentInfo not initialized");return this._payment}get licenseInfo(){if(this.ensureInitialized(),this._license===null)throw new Error("B24HelperManager.licenseInfo not initialized");return this._license}get currency(){if(this.ensureInitialized(),this._currency===null)throw new Error("B24HelperManager.currency not initialized");return this._currency}get appOptions(){if(this.ensureInitialized(),this._appOptions===null)throw new Error("B24HelperManager.appOptions not initialized");return this._appOptions}get userOptions(){if(this.ensureInitialized(),this._userOptions===null)throw new Error("B24HelperManager.userOptions not initialized");return this._userOptions}get isSelfHosted(){return this.licenseInfo.data.isSelfHosted}get primaryKeyIncrementValue(){return this.isSelfHosted?1:2}get b24SpecificUrl(){return this.isSelfHosted?{[TypeSpecificUrl.MainSettings]:"/configs/",[TypeSpecificUrl.UfList]:"/configs/userfield_list.php",[TypeSpecificUrl.UfPage]:"/configs/userfield.php"}:{[TypeSpecificUrl.MainSettings]:"/settings/configs/",[TypeSpecificUrl.UfList]:"/settings/configs/userfield_list.php",[TypeSpecificUrl.UfPage]:"/settings/configs/userfield.php"}}usePullClient(m="prefix",S){return this._b24PullClient?this:(this.initializePullClient(typeof S>"u"?this.profileInfo.data.id||0:S,m),this)}initializePullClient(m,S="prefix"){this._b24PullClient=new PullClient({b24:this._b24,restApplication:this._b24.auth.getUniq(S),userId:m})}subscribePullClient(m,S="application"){if(!this._b24PullClient)throw new Error("PullClient not init");return this._pullClientModuleId=S,this._pullClientUnSubscribe.push(this._b24PullClient.subscribe({moduleId:this._pullClientModuleId,callback:m})),this}startPullClient(){if(!this._b24PullClient)throw new Error("PullClient not init");this._b24PullClient.start().catch(m=>{this.getLogger().error(`${h$1.getDateForLog()}: Pull not running`,m)})}getModuleIdPullClient(){if(!this._b24PullClient)throw new Error("PullClient not init");return this._pullClientModuleId}_destroyPullClient(){this._pullClientUnSubscribe.forEach(m=>m()),this._b24PullClient?.destroy(),this._b24PullClient=null}ensureInitialized(){if(!this._isInit)throw new Error("B24HelperManager not initialized")}}const useB24Helper=()=>{let _=!1,m=!1,S=null;return{initB24Helper:async(T,v=[LoadDataType.App,LoadDataType.Profile])=>(S===null&&(S=new B24HelperManager(T)),_?S:S.loadData(v).then(()=>(_=!0,S))),isInitB24Helper:()=>_,destroyB24Helper:()=>{S?.destroy(),S=null,_=!1,m=!1},getB24Helper:()=>{if(S===null)throw new Error("B24HelperManager is not initialized. You need to call initB24Helper first.");return S},usePullClient:()=>{if(S===null)throw new Error("B24HelperManager is not initialized. You need to call initB24Helper first.");S.usePullClient(),m=!0},useSubscribePullClient:(T,v="application")=>{if(!m)throw new Error("PullClient is not initialized. You need to call usePullClient first.");S?.subscribePullClient(T,v)},startPullClient:()=>{if(!m)throw new Error("PullClient is not initialized. You need to call usePullClient first.");S?.startPullClient()}}};exports.AbstractB24=AbstractB24,exports.AjaxError=AjaxError,exports.AjaxResult=AjaxResult,exports.AppFrame=AppFrame,exports.AuthHookManager=AuthHookManager,exports.AuthManager=AuthManager,exports.B24Frame=B24Frame,exports.B24Hook=B24Hook,exports.B24LangList=B24LangList,exports.B24PullClientManager=PullClient,exports.Browser=s,exports.CloseReasons=CloseReasons,exports.ConnectionType=ConnectionType,exports.DataType=DataType,exports.DialogManager=DialogManager,exports.EnumAppStatus=EnumAppStatus,exports.EnumCrmEntityType=EnumCrmEntityType,exports.EnumCrmEntityTypeId=EnumCrmEntityTypeId,exports.ListRpcError=ListRpcError,exports.LoadDataType=LoadDataType,exports.LoggerBrowser=LoggerBrowser,exports.LoggerType=LoggerType,exports.LsKeys=LsKeys,exports.MessageCommands=MessageCommands,exports.MessageManager=MessageManager,exports.OptionsManager=OptionsManager$1,exports.ParentManager=ParentManager,exports.PlacementManager=PlacementManager,exports.PullStatus=PullStatus,exports.RestrictionManagerParamsBase=RestrictionManagerParamsBase,exports.RestrictionManagerParamsForEnterprise=RestrictionManagerParamsForEnterprise,exports.Result=Result,exports.RpcMethod=RpcMethod,exports.SenderType=SenderType,exports.ServerMode=ServerMode,exports.SliderManager=SliderManager,exports.StatusDescriptions=StatusDescriptions,exports.SubscriptionType=SubscriptionType,exports.SystemCommands=SystemCommands,exports.Text=h$1,exports.Type=c$1,exports.TypeOption=TypeOption,exports.TypeSpecificUrl=TypeSpecificUrl,exports.useB24Helper=useB24Helper,exports.useFormatter=useFormatter})(window.B24Js=window.B24Js||{});
